const Ys=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const f of s.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};Ys();function V(){}const ai=t=>t;function Hs(t,e){for(const n in e)t[n]=e[n];return t}function Wr(t){return t()}function Ai(){return Object.create(null)}function ot(t){t.forEach(Wr)}function _n(t){return typeof t=="function"}function Fe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let gn;function Si(t,e){return gn||(gn=document.createElement("a")),gn.href=e,t===gn.href}function Ws(t){return Object.keys(t).length===0}function bt(t,...e){if(t==null)return V;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Js(t){let e;return bt(t,n=>e=n)(),e}function lt(t,e,n){t.$$.on_destroy.push(bt(e,n))}function Jr(t,e,n,i){if(t){const r=Zr(t,e,n,i);return t[0](r)}}function Zr(t,e,n,i){return t[1]&&i?Hs(n.ctx.slice(),t[1](i(e))):n.ctx}function Gr(t,e,n,i){if(t[2]&&i){const r=t[2](i(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],f=Math.max(e.dirty.length,r.length);for(let o=0;o<f;o+=1)s[o]=e.dirty[o]|r[o];return s}return e.dirty|r}return e.dirty}function Vr(t,e,n,i,r,s){if(r){const f=Zr(e,n,i,s);t.p(f,r)}}function Qr(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let i=0;i<n;i++)e[i]=-1;return e}return-1}const Xr=typeof window<"u";let es=Xr?()=>window.performance.now():()=>Date.now(),ui=Xr?t=>requestAnimationFrame(t):V;const Xt=new Set;function ts(t){Xt.forEach(e=>{e.c(t)||(Xt.delete(e),e.f())}),Xt.size!==0&&ui(ts)}function ns(t){let e;return Xt.size===0&&ui(ts),{promise:new Promise(n=>{Xt.add(e={c:t,f:n})}),abort(){Xt.delete(e)}}}function w(t,e){t.appendChild(e)}function is(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Zs(t){const e=N("style");return Gs(is(t),e),e.sheet}function Gs(t,e){w(t.head||t,e)}function E(t,e,n){t.insertBefore(e,n||null)}function S(t){t.parentNode.removeChild(t)}function Yt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function N(t){return document.createElement(t)}function M(t){return document.createTextNode(t)}function U(){return M(" ")}function ft(){return M("")}function ce(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function rs(t){return function(e){return e.preventDefault(),t.call(this,e)}}function Ei(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function x(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Vs(t){return Array.from(t.childNodes)}function he(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Ti(t,e){t.value=e==null?"":e}function wn(t,e,n,i){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,i?"important":"")}function J(t,e,n){t.classList[n?"add":"remove"](e)}function Qs(t,e,{bubbles:n=!1,cancelable:i=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,i,e),r}const En=new Map;let Tn=0;function Xs(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function ef(t,e){const n={stylesheet:Zs(e),rules:{}};return En.set(t,n),n}function ss(t,e,n,i,r,s,f,o=0){const c=16.666/i;let a=`{
`;for(let T=0;T<=1;T+=c){const A=e+(n-e)*s(T);a+=T*100+`%{${f(A,1-A)}}
`}const u=a+`100% {${f(n,1-n)}}
}`,_=`__svelte_${Xs(u)}_${o}`,b=is(t),{stylesheet:p,rules:k}=En.get(b)||ef(b,t);k[_]||(k[_]=!0,p.insertRule(`@keyframes ${_} ${u}`,p.cssRules.length));const y=t.style.animation||"";return t.style.animation=`${y?`${y}, `:""}${_} ${i}ms linear ${r}ms 1 both`,Tn+=1,_}function ti(t,e){const n=(t.style.animation||"").split(", "),i=n.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),r=n.length-i.length;r&&(t.style.animation=i.join(", "),Tn-=r,Tn||tf())}function tf(){ui(()=>{Tn||(En.forEach(t=>{const{stylesheet:e}=t;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.rules={}}),En.clear())})}let un;function an(t){un=t}function nf(){if(!un)throw new Error("Function called outside component initialization");return un}function rf(t){nf().$$.on_mount.push(t)}const on=[],Ci=[],An=[],Di=[],sf=Promise.resolve();let ni=!1;function ff(){ni||(ni=!0,sf.then(fs))}function pt(t){An.push(t)}const Wn=new Set;let kn=0;function fs(){const t=un;do{for(;kn<on.length;){const e=on[kn];kn++,an(e),lf(e.$$)}for(an(null),on.length=0,kn=0;Ci.length;)Ci.pop()();for(let e=0;e<An.length;e+=1){const n=An[e];Wn.has(n)||(Wn.add(n),n())}An.length=0}while(on.length);for(;Di.length;)Di.pop()();ni=!1,Wn.clear(),an(t)}function lf(t){if(t.fragment!==null){t.update(),ot(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(pt)}}let ln;function ls(){return ln||(ln=Promise.resolve(),ln.then(()=>{ln=null})),ln}function Cn(t,e,n){t.dispatchEvent(Qs(`${e?"intro":"outro"}${n}`))}const Sn=new Set;let Ut;function _t(){Ut={r:0,c:[],p:Ut}}function ht(){Ut.r||ot(Ut.c),Ut=Ut.p}function Y(t,e){t&&t.i&&(Sn.delete(t),t.i(e))}function Z(t,e,n,i){if(t&&t.o){if(Sn.has(t))return;Sn.add(t),Ut.c.push(()=>{Sn.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}else i&&i()}const os={duration:0};function Pt(t,e,n){let i=e(t,n),r=!1,s,f,o=0;function c(){s&&ti(t,s)}function a(){const{delay:_=0,duration:b=300,easing:p=ai,tick:k=V,css:y}=i||os;y&&(s=ss(t,0,1,b,_,p,y,o++)),k(0,1);const T=es()+_,A=T+b;f&&f.abort(),r=!0,pt(()=>Cn(t,!0,"start")),f=ns(j=>{if(r){if(j>=A)return k(1,0),Cn(t,!0,"end"),c(),r=!1;if(j>=T){const L=p((j-T)/b);k(L,1-L)}}return r})}let u=!1;return{start(){u||(u=!0,ti(t),_n(i)?(i=i(),ls().then(a)):a())},invalidate(){u=!1},end(){r&&(c(),r=!1)}}}function of(t,e,n){let i=e(t,n),r=!0,s;const f=Ut;f.r+=1;function o(){const{delay:c=0,duration:a=300,easing:u=ai,tick:_=V,css:b}=i||os;b&&(s=ss(t,1,0,a,c,u,b));const p=es()+c,k=p+a;pt(()=>Cn(t,!1,"start")),ns(y=>{if(r){if(y>=k)return _(0,1),Cn(t,!1,"end"),--f.r||ot(f.c),!1;if(y>=p){const T=u((y-p)/a);_(1-T,T)}}return r})}return _n(i)?ls().then(()=>{i=i(),o()}):o(),{end(c){c&&i.tick&&i.tick(1,0),r&&(s&&ti(t,s),r=!1)}}}function Ee(t){t&&t.c()}function ke(t,e,n,i){const{fragment:r,on_mount:s,on_destroy:f,after_update:o}=t.$$;r&&r.m(e,n),i||pt(()=>{const c=s.map(Wr).filter(_n);f?f.push(...c):ot(c),t.$$.on_mount=[]}),o.forEach(pt)}function Ae(t,e){const n=t.$$;n.fragment!==null&&(ot(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function cf(t,e){t.$$.dirty[0]===-1&&(on.push(t),ff(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function He(t,e,n,i,r,s,f,o=[-1]){const c=un;an(t);const a=t.$$={fragment:null,ctx:null,props:s,update:V,not_equal:r,bound:Ai(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Ai(),dirty:o,skip_bound:!1,root:e.target||c.$$.root};f&&f(a.root);let u=!1;if(a.ctx=n?n(t,e.props||{},(_,b,...p)=>{const k=p.length?p[0]:b;return a.ctx&&r(a.ctx[_],a.ctx[_]=k)&&(!a.skip_bound&&a.bound[_]&&a.bound[_](k),u&&cf(t,_)),b}):[],a.update(),u=!0,ot(a.before_update),a.fragment=i?i(a.ctx):!1,e.target){if(e.hydrate){const _=Vs(e.target);a.fragment&&a.fragment.l(_),_.forEach(S)}else a.fragment&&a.fragment.c();e.intro&&Y(t.$$.fragment),ke(t,e.target,e.anchor,e.customElement),fs()}an(c)}class We{$destroy(){Ae(this,1),this.$destroy=V}$on(e,n){const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(e){this.$$set&&!Ws(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Zt=[];function af(t,e){return{subscribe:Et(t,e).subscribe}}function Et(t,e=V){let n;const i=new Set;function r(o){if(Fe(t,o)&&(t=o,n)){const c=!Zt.length;for(const a of i)a[1](),Zt.push(a,t);if(c){for(let a=0;a<Zt.length;a+=2)Zt[a][0](Zt[a+1]);Zt.length=0}}}function s(o){r(o(t))}function f(o,c=V){const a=[o,c];return i.add(a),i.size===1&&(n=e(r)||V),o(t),()=>{i.delete(a),i.size===0&&(n(),n=null)}}return{set:r,update:s,subscribe:f}}function uf(t,e,n){const i=!Array.isArray(t),r=i?[t]:t,s=e.length<2;return af(n,f=>{let o=!1;const c=[];let a=0,u=V;const _=()=>{if(a)return;u();const p=e(i?c[0]:c,f);s?f(p):u=_n(p)?p:V},b=r.map((p,k)=>bt(p,y=>{c[k]=y,a&=~(1<<k),o&&_()},()=>{a|=1<<k}));return o=!0,_(),function(){ot(b),u()}})}function df(t){const e=t-1;return e*e*e+1}function cs(t,{delay:e=0,duration:n=400,easing:i=ai}={}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:i,css:s=>`opacity: ${s*r}`}}function jt(t,{delay:e=0,duration:n=400,easing:i=df,x:r=0,y:s=0,opacity:f=0}={}){const o=getComputedStyle(t),c=+o.opacity,a=o.transform==="none"?"":o.transform,u=c*(1-f);return{delay:e,duration:n,easing:i,css:(_,b)=>`
			transform: ${a} translate(${(1-_)*r}px, ${(1-_)*s}px);
			opacity: ${c-u*b}`}}function _f(t){function e(i,...r){const s=i.subscribe(...r);return s.unsubscribe?()=>s.unsubscribe():s}function n(i){let r;return e(i,s=>r=s)(),r}return(i,r,s,f,o)=>{const{errors:c}=n(t),a=new Date,u=`${a.getHours()}:${`0${a.getMinutes()}`.slice(-2)}`;o&&o.stack?c.push({msg:i,stacktrace:o.stack,time:u}):c.push({msg:`"${i}" (No more info because of CORS, fix: 1) check for the same error on device where gui runs on :80... 2) if more possible errors from this source, then rethrow - see example in dmt-connect/browser/connect around JSON.parse(msg))`,corsProblem:!0,time:u}),t.set({errors:c})}}function hf(t,e="asc"){return function(i,r){if(!i.hasOwnProperty(t)||!r.hasOwnProperty(t))return 0;const s=typeof i[t]=="string"?i[t].toUpperCase():i[t],f=typeof r[t]=="string"?r[t].toUpperCase():r[t];let o=0;return s>f?o=1:s<f&&(o=-1),e==="desc"?o*-1:o}}function bf(t,e){localStorage.getItem(e)=="true"&&t.set(!0),localStorage.getItem(e)=="false"&&t.set(!1),t.subscribe(n=>{localStorage.setItem(e,n.toString())})}function Oi(t){console.log(`${new Date().toLocaleString()} \u2192 ${t}`)}Oi.write=Oi;const as=Et(!0);bf(as,"show_all_nearby_devices");const us=Et({errors:[]}),ds=Et(!1);function Dn(t,{defaultSymbol:e="",showTimeLimitIndicator:n=!1}={}){return!t||!t.currentMedia||t.paused?e:n&&t.timeLimit>0?"\u23F1\uFE0F":t.currentMedia.mediaType=="video"?"\u25B6":"\u266B"}function mf(t){let e;return{c(){e=M("disconnected")},m(n,i){E(n,e,i)},p:V,d(n){n&&S(e)}}}function pf(t){let e,n=Dn(t[2])+"",i,r,s,f,o,c=t[4]==!1&&Ni();return{c(){e=N("span"),i=M(n),r=U(),s=N("h2"),f=M(t[1]),o=U(),c&&c.c(),x(e,"class","play_symbol svelte-5h63c7"),x(s,"class","svelte-5h63c7"),J(s,"disconnected",t[4]==!1)},m(a,u){E(a,e,u),w(e,i),E(a,r,u),E(a,s,u),w(s,f),w(s,o),c&&c.m(s,null)},p(a,u){u&4&&n!==(n=Dn(a[2])+"")&&he(i,n),u&2&&he(f,a[1]),a[4]==!1?c||(c=Ni(),c.c(),c.m(s,null)):c&&(c.d(1),c=null),u&16&&J(s,"disconnected",a[4]==!1)},d(a){a&&S(e),a&&S(r),a&&S(s),c&&c.d()}}}function Ni(t){let e;return{c(){e=N("span"),x(e,"class","disconnected svelte-5h63c7")},m(n,i){E(n,e,i)},d(n){n&&S(e)}}}function xi(t){let e,n,i,r=t[3].ip+"",s;return{c(){e=N("div"),n=N("span"),n.textContent="IP Address",i=U(),s=M(r),x(n,"class","svelte-5h63c7"),x(e,"class","device_stat svelte-5h63c7")},m(f,o){E(f,e,o),w(e,n),w(e,i),w(e,s)},p(f,o){o&8&&r!==(r=f[3].ip+"")&&he(s,r)},d(f){f&&S(e)}}}function Ri(t){let e,n,i,r=t[3].cpuUsage+"",s,f;return{c(){var o,c,a;e=N("div"),n=N("span"),n.textContent="CPU Usage",i=U(),s=M(r),f=M("%"),x(n,"class","svelte-5h63c7"),x(e,"class","device_stat cpu_usage svelte-5h63c7"),J(e,"warn1",((o=t[3])==null?void 0:o.cpuUsage)>=50),J(e,"warn2",((c=t[3])==null?void 0:c.cpuUsage)>=70),J(e,"warn3",((a=t[3])==null?void 0:a.cpuUsage)>=80)},m(o,c){E(o,e,c),w(e,n),w(e,i),w(e,s),w(e,f)},p(o,c){var a,u,_;c&8&&r!==(r=o[3].cpuUsage+"")&&he(s,r),c&8&&J(e,"warn1",((a=o[3])==null?void 0:a.cpuUsage)>=50),c&8&&J(e,"warn2",((u=o[3])==null?void 0:u.cpuUsage)>=70),c&8&&J(e,"warn3",((_=o[3])==null?void 0:_.cpuUsage)>=80)},d(o){o&&S(e)}}}function Ii(t){let e,n,i,r=t[3].cpuTemp+"",s,f;return{c(){e=N("div"),n=N("span"),n.textContent="CPU Temperature",i=U(),s=M(r),f=M("\xB0C"),x(n,"class","svelte-5h63c7"),x(e,"class","device_stat svelte-5h63c7")},m(o,c){E(o,e,c),w(e,n),w(e,i),w(e,s),w(e,f)},p(o,c){c&8&&r!==(r=o[3].cpuTemp+"")&&he(s,r)},d(o){o&&S(e)}}}function Pi(t){var f,o;let e,n,i,r=(((f=t[3])==null?void 0:f.wifiAP)||((o=t[3])==null?void 0:o.apssid))+"",s;return{c(){e=N("div"),n=N("span"),n.textContent="Wifi",i=U(),s=M(r),x(n,"class","svelte-5h63c7"),x(e,"class","wifi_ap svelte-5h63c7")},m(c,a){E(c,e,a),w(e,n),w(e,i),w(e,s)},p(c,a){var u,_;a&8&&r!==(r=(((u=c[3])==null?void 0:u.wifiAP)||((_=c[3])==null?void 0:_.apssid))+"")&&he(s,r)},d(c){c&&S(e)}}}function vf(t){var y,T,A,j,L;let e,n,i,r,s,f,o;function c(D,P){if(D[1])return pf;if(D[4]!=null)return mf}let a=c(t),u=a&&a(t),_=((y=t[3])==null?void 0:y.ip)&&xi(t),b=((T=t[3])==null?void 0:T.cpuUsage)&&Ri(t),p=((A=t[3])==null?void 0:A.cpuTemp)&&Ii(t),k=(((j=t[3])==null?void 0:j.wifiAP)||((L=t[3])==null?void 0:L.apssid))&&Pi(t);return{c(){e=N("div"),u&&u.c(),i=U(),_&&_.c(),r=U(),b&&b.c(),s=U(),p&&p.c(),f=U(),k&&k.c(),o=ft(),x(e,"class","device_title svelte-5h63c7")},m(D,P){E(D,e,P),u&&u.m(e,null),E(D,i,P),_&&_.m(D,P),E(D,r,P),b&&b.m(D,P),E(D,s,P),p&&p.m(D,P),E(D,f,P),k&&k.m(D,P),E(D,o,P)},p(D,[P]){var $,ne,Q,G,me;a===(a=c(D))&&u?u.p(D,P):(u&&u.d(1),u=a&&a(D),u&&(u.c(),u.m(e,null))),($=D[3])!=null&&$.ip?_?_.p(D,P):(_=xi(D),_.c(),_.m(r.parentNode,r)):_&&(_.d(1),_=null),(ne=D[3])!=null&&ne.cpuUsage?b?b.p(D,P):(b=Ri(D),b.c(),b.m(s.parentNode,s)):b&&(b.d(1),b=null),(Q=D[3])!=null&&Q.cpuTemp?p?p.p(D,P):(p=Ii(D),p.c(),p.m(f.parentNode,f)):p&&(p.d(1),p=null),((G=D[3])==null?void 0:G.wifiAP)||((me=D[3])==null?void 0:me.apssid)?k?k.p(D,P):(k=Pi(D),k.c(),k.m(o.parentNode,o)):k&&(k.d(1),k=null)},i(D){n||pt(()=>{n=Pt(e,jt,{}),n.start()})},o:V,d(D){D&&S(e),u&&u.d(),D&&S(i),_&&_.d(D),D&&S(r),b&&b.d(D),D&&S(s),p&&p.d(D),D&&S(f),k&&k.d(D),D&&S(o)}}}function yf(t,e,n){let i,r,s=V,f=()=>(s(),s=bt(o,p=>n(4,r=p)),o);t.$$.on_destroy.push(()=>s());let{connected:o}=e;f();let{nearbyDevices:c}=e,{deviceName:a}=e,{device:u}=e,{activeDeviceKey:_}=e,{player:b}=e;return t.$$set=p=>{"connected"in p&&f(n(0,o=p.connected)),"nearbyDevices"in p&&n(5,c=p.nearbyDevices),"deviceName"in p&&n(1,a=p.deviceName),"device"in p&&n(6,u=p.device),"activeDeviceKey"in p&&n(7,_=p.activeDeviceKey),"player"in p&&n(2,b=p.player)},t.$$.update=()=>{t.$$.dirty&160&&n(3,i=c.find(p=>p.deviceKey==_))},[o,a,b,i,r,c,u,_]}class gf extends We{constructor(e){super(),He(this,e,yf,vf,Fe,{connected:0,nearbyDevices:5,deviceName:1,device:6,activeDeviceKey:7,player:2})}}function Jn(t,e=2){return Array(Math.max(e-String(t).length+1,0)).join(0)+t}function Gt(t){t=Math.round(t);const e=Math.floor(t/3600),n=t%3600,i=Math.floor(n/60);return t=n%60,e?`${e}h ${Jn(i)}min ${Jn(t)}s`:`${i}:${Jn(t)}`}function wf(t){let e=Gt(t[0].currentMedia.duration)+"",n;return{c(){n=M(e)},m(i,r){E(i,n,r)},p(i,r){r&1&&e!==(e=Gt(i[0].currentMedia.duration)+"")&&he(n,e)},d(i){i&&S(n)}}}function kf(t){let e=Gt(Math.floor(t[0].timeposition))+"",n,i,r=Gt(t[0].currentMedia.duration)+"",s,f,o,c=Math.round(t[0].percentposition)+"",a,u;return{c(){n=M(e),i=M(" / "),s=M(r),f=M(" \u2014 "),o=N("span"),a=M(c),u=M("%"),x(o,"class","svelte-b6jwnj")},m(_,b){E(_,n,b),E(_,i,b),E(_,s,b),E(_,f,b),E(_,o,b),w(o,a),w(o,u)},p(_,b){b&1&&e!==(e=Gt(Math.floor(_[0].timeposition))+"")&&he(n,e),b&1&&r!==(r=Gt(_[0].currentMedia.duration)+"")&&he(s,r),b&1&&c!==(c=Math.round(_[0].percentposition)+"")&&he(a,c)},d(_){_&&S(n),_&&S(i),_&&S(s),_&&S(f),_&&S(o)}}}function Af(t){let e;return{c(){e=M("(radio)")},m(n,i){E(n,e,i)},p:V,d(n){n&&S(e)}}}function Sf(t){let e;function n(s,f){if(s[0].isStream)return Af;if(s[0].timeposition)return kf;if(s[0].duration)return wf}let i=n(t),r=i&&i(t);return{c(){e=N("section"),r&&r.c(),x(e,"class","progress svelte-b6jwnj"),J(e,"faded",t[0].paused)},m(s,f){E(s,e,f),r&&r.m(e,null)},p(s,[f]){i===(i=n(s))&&r?r.p(s,f):(r&&r.d(1),r=i&&i(s),r&&(r.c(),r.m(e,null))),f&1&&J(e,"faded",s[0].paused)},i:V,o:V,d(s){s&&S(e),r&&r.d()}}}function Ef(t,e,n){let{player:i}=e;return t.$$set=r=>{"player"in r&&n(0,i=r.player)},[i]}class Tf extends We{constructor(e){super(),He(this,e,Ef,Sf,Fe,{player:0})}}function Mi(t){let e,n,i,r;function s(c,a){if(c[2]&&c[6])return Df;if(c[6])return Cf}let f=s(t),o=f&&f(t);return i=new Tf({props:{player:t[0]}}),{c(){e=N("div"),o&&o.c(),n=U(),Ee(i.$$.fragment),x(e,"class","wrapper svelte-18z3wq5")},m(c,a){E(c,e,a),o&&o.m(e,null),w(e,n),ke(i,e,null),r=!0},p(c,a){f===(f=s(c))&&o?o.p(c,a):(o&&o.d(1),o=f&&f(c),o&&(o.c(),Y(o,1),o.m(e,n)));const u={};a&1&&(u.player=c[0]),i.$set(u)},i(c){r||(Y(o),Y(i.$$.fragment,c),r=!0)},o(c){Z(i.$$.fragment,c),r=!1},d(c){c&&S(e),o&&o.d(),Ae(i)}}}function Cf(t){let e,n;return{c(){e=N("section"),e.textContent="[ No media loaded ]",x(e,"class","no_media svelte-18z3wq5")},m(i,r){E(i,e,r)},p:V,i(i){n||pt(()=>{n=Pt(e,jt,{}),n.start()})},o:V,d(i){i&&S(e)}}}function Df(t){let e,n,i=Dn(t[0],{showTimeLimitIndicator:!0})+"",r,s,f,o,c,a,u=t[3]&&Li(t);return{c(){var _;e=N("section"),n=N("span"),r=M(i),s=U(),f=M(t[2]),o=U(),c=N("div"),u&&u.c(),x(n,"class","play_symbol svelte-18z3wq5"),x(c,"class","file_path svelte-18z3wq5"),x(e,"class","current_media svelte-18z3wq5"),J(e,"playing",!t[0].paused),J(e,"within_limit",!t[0].isStream&&t[0].limit),J(e,"error",t[5]==t[3]&&((_=t[4])==null?void 0:_.error))},m(_,b){E(_,e,b),w(e,n),w(n,r),w(e,s),w(e,f),w(e,o),w(e,c),u&&u.m(c,null)},p(_,b){var p;b&1&&i!==(i=Dn(_[0],{showTimeLimitIndicator:!0})+"")&&he(r,i),b&4&&he(f,_[2]),_[3]?u?u.p(_,b):(u=Li(_),u.c(),u.m(c,null)):u&&(u.d(1),u=null),b&1&&J(e,"playing",!_[0].paused),b&1&&J(e,"within_limit",!_[0].isStream&&_[0].limit),b&56&&J(e,"error",_[5]==_[3]&&((p=_[4])==null?void 0:p.error))},i(_){a||pt(()=>{a=Pt(e,jt,{}),a.start()})},o:V,d(_){_&&S(e),u&&u.d()}}}function Li(t){let e=Ui(t[3])+"",n;return{c(){n=M(e)},m(i,r){E(i,n,r)},p(i,r){r&8&&e!==(e=Ui(i[3])+"")&&he(n,e)},d(i){i&&S(n)}}}function Of(t){let e,n,i=t[0]&&Mi(t);return{c(){i&&i.c(),e=ft()},m(r,s){i&&i.m(r,s),E(r,e,s),n=!0},p(r,[s]){r[0]?i?(i.p(r,s),s&1&&Y(i,1)):(i=Mi(r),i.c(),Y(i,1),i.m(e.parentNode,e)):i&&(_t(),Z(i,1,1,()=>{i=null}),ht())},i(r){n||(Y(i),n=!0)},o(r){Z(i),n=!1},d(r){i&&i.d(r),r&&S(e)}}}function Ui(t){return t.replace("/root/DMTMountedMedia","")}function Nf(t,e,n){let i,r=V,s=()=>(r(),r=bt(o,p=>n(6,i=p)),o);t.$$.on_destroy.push(()=>r());let{player:f}=e,{connected:o}=e;s();let{store:c}=e,{songTitle:a}=e,{songPath:u}=e,{playlistCurrentMedia:_}=e,{playlistSongPath:b}=e;return t.$$set=p=>{"player"in p&&n(0,f=p.player),"connected"in p&&s(n(1,o=p.connected)),"store"in p&&n(7,c=p.store),"songTitle"in p&&n(2,a=p.songTitle),"songPath"in p&&n(3,u=p.songPath),"playlistCurrentMedia"in p&&n(4,_=p.playlistCurrentMedia),"playlistSongPath"in p&&n(5,b=p.playlistSongPath)},[f,o,a,u,_,b,i,c]}class xf extends We{constructor(e){super(),He(this,e,Nf,Of,Fe,{player:0,connected:1,store:7,songTitle:2,songPath:3,playlistCurrentMedia:4,playlistSongPath:5})}}function ji(t){let e;function n(s,f){return s[1].paused?If:Rf}let i=n(t),r=i(t);return{c(){r.c(),e=ft()},m(s,f){r.m(s,f),E(s,e,f)},p(s,f){i===(i=n(s))&&r?r.p(s,f):(r.d(1),r=i(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&S(e)}}}function Rf(t){let e,n,i,r=(t[2]||"")+"",s,f,o,c;return{c(){e=N("button"),n=M("\u25CF Pause "),i=N("span"),s=M(r),x(i,"class","svelte-hr0u6m"),x(e,"class","pause svelte-hr0u6m"),e.disabled=f=!t[5]},m(a,u){E(a,e,u),w(e,n),w(e,i),w(i,s),o||(c=ce(e,"click",t[8]),o=!0)},p(a,u){u&4&&r!==(r=(a[2]||"")+"")&&he(s,r),u&32&&f!==(f=!a[5])&&(e.disabled=f)},d(a){a&&S(e),o=!1,c()}}}function If(t){let e,n,i,r=(t[2]||"")+"",s,f,o,c;return{c(){e=N("button"),n=M("\u25B6 Play "),i=N("span"),s=M(r),x(i,"class","svelte-hr0u6m"),x(e,"class","play svelte-hr0u6m"),e.disabled=f=!t[5]},m(a,u){E(a,e,u),w(e,n),w(e,i),w(i,s),o||(c=ce(e,"click",t[7]),o=!0)},p(a,u){u&4&&r!==(r=(a[2]||"")+"")&&he(s,r),u&32&&f!==(f=!a[5])&&(e.disabled=f)},d(a){a&&S(e),o=!1,c()}}}function $i(t){let e,n=t[1].volume+"",i;return{c(){e=N("div"),i=M(n),x(e,"class","volume_level svelte-hr0u6m"),J(e,"faded",t[1].paused)},m(r,s){E(r,e,s),w(e,i)},p(r,s){s&2&&n!==(n=r[1].volume+"")&&he(i,n),s&2&&J(e,"faded",r[1].paused)},d(r){r&&S(e)}}}function Ki(t){let e,n,i=t[1].isStream?"Close radio":"Stop",r,s,f,o;return{c(){e=N("button"),n=M("\u25A0 "),r=M(i),x(e,"class","stop svelte-hr0u6m"),e.disabled=s=!t[5],J(e,"radio",t[1].isStream)},m(c,a){E(c,e,a),w(e,n),w(e,r),f||(o=ce(e,"click",t[11]),f=!0)},p(c,a){a&2&&i!==(i=c[1].isStream?"Close radio":"Stop")&&he(r,i),a&32&&s!==(s=!c[5])&&(e.disabled=s),a&2&&J(e,"radio",c[1].isStream)},d(c){c&&S(e),f=!1,o()}}}function Bi(t){let e,n,i,r,s,f,o,c,a,u,_=(t[1].repeatCount||"")+"",b,p,k,y;return{c(){e=N("button"),n=M("Shuffle"),r=U(),s=N("button"),f=M("Similar"),c=U(),a=N("button"),u=M("Repeat "),b=M(_),x(e,"class","shuffle svelte-hr0u6m"),e.disabled=i=!t[5],x(s,"class","similar svelte-hr0u6m"),s.disabled=o=!t[5],x(a,"class","repeat svelte-hr0u6m"),a.disabled=p=!t[5],J(a,"repeat_set",t[1].repeatCount>0)},m(T,A){E(T,e,A),w(e,n),E(T,r,A),E(T,s,A),w(s,f),E(T,c,A),E(T,a,A),w(a,u),w(a,b),k||(y=[ce(e,"click",t[12]),ce(s,"click",t[13]),ce(a,"click",t[14])],k=!0)},p(T,A){A&32&&i!==(i=!T[5])&&(e.disabled=i),A&32&&o!==(o=!T[5])&&(s.disabled=o),A&2&&_!==(_=(T[1].repeatCount||"")+"")&&he(b,_),A&32&&p!==(p=!T[5])&&(a.disabled=p),A&2&&J(a,"repeat_set",T[1].repeatCount>0)},d(T){T&&S(e),T&&S(r),T&&S(s),T&&S(c),T&&S(a),k=!1,ot(y)}}}function zi(t){let e,n,i,r,s,f,o,c,a;return{c(){e=N("button"),n=M("\xAB 20s"),r=U(),s=N("button"),f=M("20s \xBB"),x(e,"class","backward svelte-hr0u6m"),e.disabled=i=!t[5],x(s,"class","forward svelte-hr0u6m"),s.disabled=o=!t[5]},m(u,_){E(u,e,_),w(e,n),E(u,r,_),E(u,s,_),w(s,f),c||(a=[ce(e,"click",t[15]),ce(s,"click",t[16])],c=!0)},p(u,_){_&32&&i!==(i=!u[5])&&(e.disabled=i),_&32&&o!==(o=!u[5])&&(s.disabled=o)},d(u){u&&S(e),u&&S(r),u&&S(s),c=!1,ot(a)}}}function qi(t){let e;function n(s,f){return s[1].isStream?Mf:Pf}let i=n(t),r=i(t);return{c(){r.c(),e=ft()},m(s,f){r.m(s,f),E(s,e,f)},p(s,f){i===(i=n(s))&&r?r.p(s,f):(r.d(1),r=i(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&S(e)}}}function Pf(t){let e,n,i,r,s,f,o=(t[1].limit>0||t[1].timeLimit>0)&&Fi(t),c=t[1].limit>0&&Yi(t);function a(b,p){return b[1].timeLimit>0?Uf:Lf}let u=a(t),_=u(t);return{c(){o&&o.c(),e=U(),c&&c.c(),n=U(),i=N("button"),_.c(),x(i,"class","limit svelte-hr0u6m"),i.disabled=r=!t[5],J(i,"limit_set",t[1].limit>0),J(i,"time_limit_set",t[1].timeLimit>0)},m(b,p){o&&o.m(b,p),E(b,e,p),c&&c.m(b,p),E(b,n,p),E(b,i,p),_.m(i,null),s||(f=ce(i,"click",t[6]),s=!0)},p(b,p){b[1].limit>0||b[1].timeLimit>0?o?o.p(b,p):(o=Fi(b),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),b[1].limit>0?c?c.p(b,p):(c=Yi(b),c.c(),c.m(n.parentNode,n)):c&&(c.d(1),c=null),u===(u=a(b))&&_?_.p(b,p):(_.d(1),_=u(b),_&&(_.c(),_.m(i,null))),p&32&&r!==(r=!b[5])&&(i.disabled=r),p&2&&J(i,"limit_set",b[1].limit>0),p&2&&J(i,"time_limit_set",b[1].timeLimit>0)},d(b){o&&o.d(b),b&&S(e),c&&c.d(b),b&&S(n),b&&S(i),_.d(),s=!1,f()}}}function Mf(t){let e,n,i,r,s,f=t[1].timeLimit>0&&Hi(t);function o(u,_){return u[1].timeLimit>0?$f:jf}let c=o(t),a=c(t);return{c(){f&&f.c(),e=U(),n=N("button"),a.c(),x(n,"class","limit svelte-hr0u6m"),n.disabled=i=!t[5],J(n,"time_limit_set",t[1].timeLimit>0)},m(u,_){f&&f.m(u,_),E(u,e,_),E(u,n,_),a.m(n,null),r||(s=ce(n,"click",t[6]),r=!0)},p(u,_){u[1].timeLimit>0?f?f.p(u,_):(f=Hi(u),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null),c===(c=o(u))&&a?a.p(u,_):(a.d(1),a=c(u),a&&(a.c(),a.m(n,null))),_&32&&i!==(i=!u[5])&&(n.disabled=i),_&2&&J(n,"time_limit_set",u[1].timeLimit>0)},d(u){f&&f.d(u),u&&S(e),u&&S(n),a.d(),r=!1,s()}}}function Fi(t){let e,n,i,r,s;return{c(){e=N("button"),n=M("\u{1F5D1}\uFE0F Cancel"),x(e,"class","remove_limit svelte-hr0u6m"),e.disabled=i=!t[5],J(e,"remove_time_limit",t[1].timeLimit>0)},m(f,o){E(f,e,o),w(e,n),r||(s=ce(e,"click",t[18]),r=!0)},p(f,o){o&32&&i!==(i=!f[5])&&(e.disabled=i),o&2&&J(e,"remove_time_limit",f[1].timeLimit>0)},d(f){f&&S(e),r=!1,s()}}}function Yi(t){let e,n,i,r,s;return{c(){e=N("button"),n=M("\u23F1\uFE0F Limit"),x(e,"class","set_time_limit svelte-hr0u6m"),e.disabled=i=!t[5]},m(f,o){E(f,e,o),w(e,n),r||(s=ce(e,"click",t[19]),r=!0)},p(f,o){o&32&&i!==(i=!f[5])&&(e.disabled=i)},d(f){f&&S(e),r=!1,s()}}}function Lf(t){let e,n=(t[1].limit||"")+"",i;return{c(){e=M("Limit "),i=M(n)},m(r,s){E(r,e,s),E(r,i,s)},p(r,s){s&2&&n!==(n=(r[1].limit||"")+"")&&he(i,n)},d(r){r&&S(e),r&&S(i)}}}function Uf(t){let e,n,i=On(t[1])+"",r;return{c(){e=N("span"),n=M("\u23F1\uFE0F "),r=M(i)},m(s,f){E(s,e,f),w(e,n),w(e,r)},p(s,f){f&2&&i!==(i=On(s[1])+"")&&he(r,i)},d(s){s&&S(e)}}}function Hi(t){let e,n,i,r,s;return{c(){e=N("button"),n=M("\u{1F5D1}\uFE0F Cancel"),x(e,"class","remove_limit svelte-hr0u6m"),e.disabled=i=!t[5],J(e,"remove_time_limit",t[1].timeLimit>0)},m(f,o){E(f,e,o),w(e,n),r||(s=ce(e,"click",t[17]),r=!0)},p(f,o){o&32&&i!==(i=!f[5])&&(e.disabled=i),o&2&&J(e,"remove_time_limit",f[1].timeLimit>0)},d(f){f&&S(e),r=!1,s()}}}function jf(t){let e;return{c(){e=N("span"),e.textContent="\u23F1\uFE0F Limit"},m(n,i){E(n,e,i)},p:V,d(n){n&&S(e)}}}function $f(t){let e,n,i=On(t[1])+"",r;return{c(){e=N("span"),n=M("\u23F1\uFE0F "),r=M(i)},m(s,f){E(s,e,f),w(e,n),w(e,r)},p(s,f){f&2&&i!==(i=On(s[1])+"")&&he(r,i)},d(s){s&&S(e)}}}function Kf(t){let e,n,i,r,s,f,o,c,a,u,_,b,p,k,y,T,A,j,L=t[3]&&ji(t),D=t[5]&&t[1].volume!=null&&$i(t),P=t[3]&&Ki(t),$=!t[1].isStream&&t[3]&&Bi(t),ne=!t[1].isStream&&t[3]&&zi(t),Q=t[3]&&qi(t);return{c(){e=N("section"),L&&L.c(),n=U(),i=N("button"),r=M("Vol \u2193"),f=U(),o=N("button"),c=M("Vol \u2191"),u=U(),D&&D.c(),_=U(),b=N("section"),P&&P.c(),p=U(),$&&$.c(),k=U(),y=N("section"),ne&&ne.c(),T=U(),Q&&Q.c(),x(i,"class","volume svelte-hr0u6m"),i.disabled=s=!t[5],x(o,"class","volume svelte-hr0u6m"),o.disabled=a=!t[5],x(e,"class","main svelte-hr0u6m"),x(b,"class","svelte-hr0u6m"),x(y,"class","svelte-hr0u6m")},m(G,me){E(G,e,me),L&&L.m(e,null),w(e,n),w(e,i),w(i,r),w(e,f),w(e,o),w(o,c),w(e,u),D&&D.m(e,null),E(G,_,me),E(G,b,me),P&&P.m(b,null),w(b,p),$&&$.m(b,null),E(G,k,me),E(G,y,me),ne&&ne.m(y,null),w(y,T),Q&&Q.m(y,null),A||(j=[ce(i,"click",t[9]),ce(o,"click",t[10])],A=!0)},p(G,[me]){G[3]?L?L.p(G,me):(L=ji(G),L.c(),L.m(e,n)):L&&(L.d(1),L=null),me&32&&s!==(s=!G[5])&&(i.disabled=s),me&32&&a!==(a=!G[5])&&(o.disabled=a),G[5]&&G[1].volume!=null?D?D.p(G,me):(D=$i(G),D.c(),D.m(e,null)):D&&(D.d(1),D=null),G[3]?P?P.p(G,me):(P=Ki(G),P.c(),P.m(b,p)):P&&(P.d(1),P=null),!G[1].isStream&&G[3]?$?$.p(G,me):($=Bi(G),$.c(),$.m(b,null)):$&&($.d(1),$=null),!G[1].isStream&&G[3]?ne?ne.p(G,me):(ne=zi(G),ne.c(),ne.m(y,T)):ne&&(ne.d(1),ne=null),G[3]?Q?Q.p(G,me):(Q=qi(G),Q.c(),Q.m(y,null)):Q&&(Q.d(1),Q=null)},i:V,o:V,d(G){G&&S(e),L&&L.d(),D&&D.d(),G&&S(_),G&&S(b),P&&P.d(),$&&$.d(),G&&S(k),G&&S(y),ne&&ne.d(),Q&&Q.d(),A=!1,ot(j)}}}function On(t){return t.timeLimit>2?`${Math.round(t.timeLimit)} min`:`${Math.round(t.timeLimit*60)} s`}function Bf(t,e,n){let i,r=V,s=()=>(r(),r=bt(f,G=>n(5,i=G)),f);t.$$.on_destroy.push(()=>r());let{connected:f}=e;s();let{player:o}=e,{deviceName:c}=e,{songTitle:a}=e,{fnAction:u}=e;function _(){o.isStream||o.timeLimit>0?u("time_limit"):u("limit")}const b=()=>u("play"),p=()=>u("pause"),k=()=>u("volume_down"),y=()=>u("volume_up"),T=()=>u("stop"),A=()=>u("shuffle"),j=()=>u("similar"),L=()=>u("repeat"),D=()=>u("backward"),P=()=>u("forward"),$=()=>u("remove_time_limit"),ne=()=>u("remove_limit"),Q=()=>u("time_limit");return t.$$set=G=>{"connected"in G&&s(n(0,f=G.connected)),"player"in G&&n(1,o=G.player),"deviceName"in G&&n(2,c=G.deviceName),"songTitle"in G&&n(3,a=G.songTitle),"fnAction"in G&&n(4,u=G.fnAction)},[f,o,c,a,u,i,_,b,p,k,y,T,A,j,L,D,P,$,ne,Q]}class zf extends We{constructor(e){super(),He(this,e,Bf,Kf,Fe,{connected:0,player:1,deviceName:2,songTitle:3,fnAction:4})}}const Nn=Et(),It=Et();function _s(){Nn.set(""),It.set(null)}const cn=Et();function hs(){cn.set(null)}const qf=""+new URL("close.28a6104f.png",import.meta.url).href,Ff=""+new URL("magnifying_glass.a4a7aab7.svg",import.meta.url).href;function Wi(t){let e,n,i,r,s,f;return{c(){e=N("button"),n=M("\u25BC SET NEXT"),e.disabled=i=!t[2],x(e,"class","svelte-11smw5j")},m(o,c){E(o,e,c),w(e,n),s||(f=ce(e,"click",rs(t[5])),s=!0)},p(o,c){c&4&&i!==(i=!o[2])&&(e.disabled=i)},i(o){r||pt(()=>{r=Pt(e,jt,{}),r.start()})},o:V,d(o){o&&S(e),s=!1,f()}}}function Yf(t){var T,A;let e,n,i,r,s,f,o,c,a,u,_,b=((T=t[1])==null?void 0:T.trim())&&((A=t[3])==null?void 0:A.length),p,k,y=b&&Wi(t);return{c(){var j;e=N("form"),n=N("div"),i=N("input"),s=U(),f=N("img"),c=U(),a=N("img"),_=U(),y&&y.c(),x(i,"id","search"),x(i,"placeholder","Playlist Search"),x(i,"type","text"),i.disabled=r=!t[2],x(i,"class","svelte-11smw5j"),x(f,"class","magnifying_glass svelte-11smw5j"),Si(f.src,o=Ff)||x(f,"src",o),x(a,"class","clear_search svelte-11smw5j"),Si(a.src,u=qf)||x(a,"src",u),J(a,"invisible",!((j=t[1])!=null&&j.trim())),x(n,"class","input_wrapper svelte-11smw5j"),x(e,"class","svelte-11smw5j")},m(j,L){E(j,e,L),w(e,n),w(n,i),Ti(i,t[1]),w(n,s),w(n,f),w(n,c),w(n,a),w(e,_),y&&y.m(e,null),p||(k=[ce(i,"input",t[8]),ce(i,"keyup",t[4]),ce(a,"click",_s)],p=!0)},p(j,[L]){var D,P,$;L&4&&r!==(r=!j[2])&&(i.disabled=r),L&2&&i.value!==j[1]&&Ti(i,j[1]),L&2&&J(a,"invisible",!((D=j[1])!=null&&D.trim())),L&10&&(b=((P=j[1])==null?void 0:P.trim())&&(($=j[3])==null?void 0:$.length)),b?y?(y.p(j,L),L&10&&Y(y,1)):(y=Wi(j),y.c(),Y(y,1),y.m(e,null)):y&&(y.d(1),y=null)},i(j){Y(y)},o:V,d(j){j&&S(e),y&&y.d(),p=!1,ot(k)}}}function Hf(t,e,n){let i,r,s=V,f=()=>(s(),s=bt(c,A=>n(2,r=A)),c),o;lt(t,Nn,A=>n(1,i=A)),lt(t,It,A=>n(3,o=A)),t.$$.on_destroy.push(()=>s());let{connected:c}=e;f();let{store:a}=e,{fnAction:u}=e,_;function b(A){a.remoteObject("player").call("playlistSearch",{query:i}).then(j=>{j?A==_&&It.set(j):It.set(null)}).catch(console.log)}let p;function k(){hs(),clearTimeout(p),i!=null&&i.trim()?(_=Math.random(),p=setTimeout(()=>{b(_)},300)):(_=null,It.set(null))}function y(){a.remoteObject("player").call("bump",{query:i}).then(()=>{It.set(null)}).catch(console.log)}function T(){i=this.value,Nn.set(i)}return t.$$set=A=>{"connected"in A&&f(n(0,c=A.connected)),"store"in A&&n(6,a=A.store),"fnAction"in A&&n(7,u=A.fnAction)},[c,i,r,o,k,y,a,u,T]}class Wf extends We{constructor(e){super(),He(this,e,Hf,Yf,Fe,{connected:0,store:6,fnAction:7})}}function Jf(t){let e,n,i,r,s,f;return{c(){e=N("div"),n=N("button"),n.textContent="Play",i=U(),r=N("button"),r.textContent="Bump",x(n,"class","svelte-27xey9"),x(r,"class","svelte-27xey9"),x(e,"class","controls svelte-27xey9")},m(o,c){E(o,e,c),w(e,n),w(e,i),w(e,r),s||(f=[ce(n,"click",Ei(t[4])),ce(r,"click",Ei(t[5]))],s=!0)},p:V,i:V,o:V,d(o){o&&S(e),s=!1,ot(f)}}}function Zf(t,e,n){let{fnAction:i}=e,{entry:r}=e;function s(a){window.scrollTo({top:0,behavior:"smooth"}),_s(),i("next",{songId:a})}function f(a){i("bump",{args:a})}const o=()=>{s(r.id)},c=()=>{f(r.id)};return t.$$set=a=>{"fnAction"in a&&n(3,i=a.fnAction),"entry"in a&&n(0,r=a.entry)},[r,s,f,i,o,c]}class Gf extends We{constructor(e){super(),He(this,e,Zf,Jf,Fe,{fnAction:3,entry:0})}}function Ji(t){let e,n,i=t[0].metadata.duration+"",r,s;return{c(){e=N("span"),n=M("["),r=M(i),s=M("]"),x(e,"class","duration svelte-1q3qkhq")},m(f,o){E(f,e,o),w(e,n),w(e,r),w(e,s)},p(f,o){o&1&&i!==(i=f[0].metadata.duration+"")&&he(r,i)},d(f){f&&S(e)}}}function Vf(t){var j,L;let e,n,i,r=t[0].title+"",s,f,o,c=Zi(t[0].path)+"",a,u,_,b,p,k,y,T,A=((L=(j=t[0])==null?void 0:j.metadata)==null?void 0:L.duration)&&Ji(t);return b=new Gf({props:{entry:t[0],fnAction:t[1]}}),{c(){e=N("div"),n=N("div"),A&&A.c(),i=U(),s=M(r),f=U(),o=N("div"),a=M(c),u=U(),_=N("div"),Ee(b.$$.fragment),x(o,"class","file_path svelte-1q3qkhq"),x(_,"class","controls svelte-1q3qkhq"),x(n,"class","entry svelte-1q3qkhq"),J(n,"selected",t[0].id==t[3]),J(n,"just_bumped",!t[2]&&t[0].justBumped),J(n,"within_limit",!t[2]&&t[0].withinLimit),J(n,"is_search_result",t[2]),J(n,"error",t[0].error),x(e,"class","entry_wrapper svelte-1q3qkhq")},m(D,P){E(D,e,P),w(e,n),A&&A.m(n,null),w(n,i),w(n,s),w(n,f),w(n,o),w(o,a),w(n,u),w(n,_),ke(b,_,null),k=!0,y||(T=ce(n,"click",t[5]),y=!0)},p(D,[P]){var ne,Q;(Q=(ne=D[0])==null?void 0:ne.metadata)!=null&&Q.duration?A?A.p(D,P):(A=Ji(D),A.c(),A.m(n,i)):A&&(A.d(1),A=null),(!k||P&1)&&r!==(r=D[0].title+"")&&he(s,r),(!k||P&1)&&c!==(c=Zi(D[0].path)+"")&&he(a,c);const $={};P&1&&($.entry=D[0]),P&2&&($.fnAction=D[1]),b.$set($),P&9&&J(n,"selected",D[0].id==D[3]),P&5&&J(n,"just_bumped",!D[2]&&D[0].justBumped),P&5&&J(n,"within_limit",!D[2]&&D[0].withinLimit),P&4&&J(n,"is_search_result",D[2]),P&1&&J(n,"error",D[0].error)},i(D){k||(Y(b.$$.fragment,D),p||pt(()=>{p=Pt(n,jt,{}),p.start()}),k=!0)},o(D){Z(b.$$.fragment,D),k=!1},d(D){D&&S(e),A&&A.d(),Ae(b),y=!1,T()}}}function Zi(t){return t.replace("/root/DMTMountedMedia","")}function Qf(t,e,n){let i;lt(t,cn,a=>n(3,i=a));let{entry:r}=e,{fnAction:s}=e,{isSearchResult:f}=e;function o(a){a==Js(cn)?cn.set(null):cn.set(a)}const c=()=>{o(r.id)};return t.$$set=a=>{"entry"in a&&n(0,r=a.entry),"fnAction"in a&&n(1,s=a.fnAction),"isSearchResult"in a&&n(2,f=a.isSearchResult)},[r,s,f,i,o,c]}class bs extends We{constructor(e){super(),He(this,e,Qf,Vf,Fe,{entry:0,fnAction:1,isSearchResult:2})}}function Gi(t,e,n){const i=t.slice();return i[7]=e[n],i}function Vi(t){let e,n,i,r;const s=[el,Xf],f=[];function o(c,a){return c[2].length?0:1}return e=o(t),n=f[e]=s[e](t),{c(){n.c(),i=ft()},m(c,a){f[e].m(c,a),E(c,i,a),r=!0},p(c,a){let u=e;e=o(c),e===u?f[e].p(c,a):(_t(),Z(f[u],1,1,()=>{f[u]=null}),ht(),n=f[e],n?n.p(c,a):(n=f[e]=s[e](c),n.c()),Y(n,1),n.m(i.parentNode,i))},i(c){r||(Y(n),r=!0)},o(c){Z(n),r=!1},d(c){f[e].d(c),c&&S(i)}}}function Xf(t){let e,n;return{c(){e=N("h3"),e.textContent="[ No matches ]",x(e,"class","no_matches svelte-11vb31n")},m(i,r){E(i,e,r)},p:V,i(i){n||pt(()=>{n=Pt(e,jt,{}),n.start()})},o:V,d(i){i&&S(e)}}}function el(t){let e,n,i,r,s,f,o;function c(y,T){return y[2].length>Lt?nl:tl}let a=c(t),u=a(t),_=t[2].slice(0,Lt),b=[];for(let y=0;y<_.length;y+=1)b[y]=Qi(Gi(t,_,y));const p=y=>Z(b[y],1,1,()=>{b[y]=null});let k=t[2].length>Lt&&Xi(t);return{c(){e=N("h3"),u.c(),n=U();for(let y=0;y<b.length;y+=1)b[y].c();i=U(),r=N("div"),k&&k.c(),s=U(),f=N("span"),f.textContent="\u{1F4A1} Use comma (,) to separate multiple additive search terms.",x(e,"class","svelte-11vb31n"),x(f,"class","deemph svelte-11vb31n"),x(r,"class","result_count svelte-11vb31n")},m(y,T){E(y,e,T),u.m(e,null),E(y,n,T);for(let A=0;A<b.length;A+=1)b[A].m(y,T);E(y,i,T),E(y,r,T),k&&k.m(r,null),w(r,s),w(r,f),o=!0},p(y,T){if(a===(a=c(y))&&u?u.p(y,T):(u.d(1),u=a(y),u&&(u.c(),u.m(e,null))),T&6){_=y[2].slice(0,Lt);let A;for(A=0;A<_.length;A+=1){const j=Gi(y,_,A);b[A]?(b[A].p(j,T),Y(b[A],1)):(b[A]=Qi(j),b[A].c(),Y(b[A],1),b[A].m(i.parentNode,i))}for(_t(),A=_.length;A<b.length;A+=1)p(A);ht()}y[2].length>Lt?k?k.p(y,T):(k=Xi(y),k.c(),k.m(r,s)):k&&(k.d(1),k=null)},i(y){if(!o){for(let T=0;T<_.length;T+=1)Y(b[T]);o=!0}},o(y){b=b.filter(Boolean);for(let T=0;T<b.length;T+=1)Z(b[T]);o=!1},d(y){y&&S(e),u.d(),y&&S(n),Yt(b,y),y&&S(i),y&&S(r),k&&k.d()}}}function tl(t){let e=t[2].length+"",n,i,r=t[2].length==1?"match":"matches",s;return{c(){n=M(e),i=U(),s=M(r)},m(f,o){E(f,n,o),E(f,i,o),E(f,s,o)},p(f,o){o&4&&e!==(e=f[2].length+"")&&he(n,e),o&4&&r!==(r=f[2].length==1?"match":"matches")&&he(s,r)},d(f){f&&S(n),f&&S(i),f&&S(s)}}}function nl(t){let e,n,i;return{c(){e=M("First "),n=M(Lt),i=M(" matches")},m(r,s){E(r,e,s),E(r,n,s),E(r,i,s)},p:V,d(r){r&&S(e),r&&S(n),r&&S(i)}}}function Qi(t){let e,n;return e=new bs({props:{entry:t[7],fnAction:t[1],isSearchResult:"true"}}),{c(){Ee(e.$$.fragment)},m(i,r){ke(e,i,r),n=!0},p(i,r){const s={};r&4&&(s.entry=i[7]),r&2&&(s.fnAction=i[1]),e.$set(s)},i(i){n||(Y(e.$$.fragment,i),n=!0)},o(i){Z(e.$$.fragment,i),n=!1},d(i){Ae(e,i)}}}function Xi(t){let e,n,i=t[2].length-Lt+"",r,s;return{c(){e=N("div"),n=M("\u2026 there are "),r=M(i),s=M(" more matches")},m(f,o){E(f,e,o),w(e,n),w(e,r),w(e,s)},p(f,o){o&4&&i!==(i=f[2].length-Lt+"")&&he(r,i)},d(f){f&&S(e)}}}function il(t){let e,n,i=t[2]&&Vi(t);return{c(){i&&i.c(),e=ft()},m(r,s){i&&i.m(r,s),E(r,e,s),n=!0},p(r,[s]){r[2]?i?(i.p(r,s),s&4&&Y(i,1)):(i=Vi(r),i.c(),Y(i,1),i.m(e.parentNode,e)):i&&(_t(),Z(i,1,1,()=>{i=null}),ht())},i(r){n||(Y(i),n=!0)},o(r){Z(i),n=!1},d(r){i&&i.d(r),r&&S(e)}}}const Lt=20;function rl(t,e,n){let i,r=V,s=()=>(r(),r=bt(o,u=>n(4,i=u)),o),f;lt(t,It,u=>n(2,f=u)),t.$$.on_destroy.push(()=>r());let{store:o}=e;s();let{connected:c}=e,{fnAction:a}=e;return t.$$set=u=>{"store"in u&&s(n(0,o=u.store)),"connected"in u&&n(3,c=u.connected),"fnAction"in u&&n(1,a=u.fnAction)},t.$$.update=()=>{t.$$.dirty&16&&i.playlist,t.$$.dirty&16&&i.playlistMetadata},[o,a,f,c,i]}class sl extends We{constructor(e){super(),He(this,e,rl,il,Fe,{store:0,connected:3,fnAction:1})}}function er(t){let e,n=t[1]=="tv"&&tr(t);return{c(){n&&n.c(),e=ft()},m(i,r){n&&n.m(i,r),E(i,e,r)},p(i,r){i[1]=="tv"?n?n.p(i,r):(n=tr(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(i){n&&n.d(i),i&&S(e)}}}function tr(t){let e,n,i,r,s,f,o,c,a,u;return{c(){e=N("div"),n=N("button"),n.textContent="Celove\u010Derne risanke",i=U(),r=N("button"),r.textContent="BabyZoo",s=U(),f=N("button"),f.textContent="Simsala Grim",o=U(),c=N("button"),c.textContent="Bobi in Pika",x(n,"class","svelte-84hcn8"),x(r,"class","svelte-84hcn8"),x(f,"class","svelte-84hcn8"),x(c,"class","svelte-84hcn8"),x(e,"class","sublist svelte-84hcn8")},m(_,b){E(_,e,b),w(e,n),w(e,i),w(e,r),w(e,s),w(e,f),w(e,o),w(e,c),a||(u=[ce(n,"click",t[6]),ce(r,"click",t[7]),ce(f,"click",t[8]),ce(c,"click",t[9])],a=!0)},p:V,d(_){_&&S(e),a=!1,ot(u)}}}function fl(t){let e,n=t[2]&&t[3]&&er(t);return{c(){n&&n.c(),e=ft()},m(i,r){n&&n.m(i,r),E(i,e,r)},p(i,[r]){i[2]&&i[3]?n?n.p(i,r):(n=er(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:V,o:V,d(i){n&&n.d(i),i&&S(e)}}}function ll(t,e,n){let i,r,s=V,f=()=>(s(),s=bt(c,y=>n(3,r=y)),c);lt(t,ds,y=>n(2,i=y)),t.$$.on_destroy.push(()=>s());function o(y){a("sublist",{tag:y})}let{connected:c}=e;f();let{fnAction:a}=e,{deviceName:u}=e;const _=()=>{o("slosinh risanke")},b=()=>{o("Baby Zoo")},p=()=>{o("Simsala Grim")},k=()=>{o("Bobi pika")};return t.$$set=y=>{"connected"in y&&f(n(0,c=y.connected)),"fnAction"in y&&n(5,a=y.fnAction),"deviceName"in y&&n(1,u=y.deviceName)},[c,u,i,r,o,a,_,b,p,k]}class ol extends We{constructor(e){super(),He(this,e,ll,fl,Fe,{connected:0,fnAction:5,deviceName:1})}}function nr(t,e,n){const i=t.slice();return i[10]=e[n],i}function ir(t){let e,n,i,r,s,f,o=t[4].playlistLength+"",c,a,u,_,b,p,k,y,T,A=t[7]&&rr(t);b=new ol({props:{connected:t[1],deviceName:t[3],fnAction:t[2]}});let j=t[5].filter(lr).slice(0,1.5*fr),L=[];for(let P=0;P<j.length;P+=1)L[P]=sr(nr(t,j,P));const D=P=>Z(L[P],1,1,()=>{L[P]=null});return{c(){e=N("h3"),n=M("Playlist @ "),i=M(t[3]),r=U(),s=N("span"),f=M("("),c=M(o),a=M(")"),u=U(),A&&A.c(),_=U(),Ee(b.$$.fragment),p=U();for(let P=0;P<L.length;P+=1)L[P].c();k=U(),y=N("div"),y.textContent="...",x(s,"class","svelte-146wfrf"),x(e,"class","svelte-146wfrf")},m(P,$){E(P,e,$),w(e,n),w(e,i),w(e,r),w(e,s),w(s,f),w(s,c),w(s,a),w(e,u),A&&A.m(e,null),E(P,_,$),ke(b,P,$),E(P,p,$);for(let ne=0;ne<L.length;ne+=1)L[ne].m(P,$);E(P,k,$),E(P,y,$),T=!0},p(P,$){(!T||$&8)&&he(i,P[3]),(!T||$&16)&&o!==(o=P[4].playlistLength+"")&&he(c,o),P[7]?A?A.p(P,$):(A=rr(P),A.c(),A.m(e,null)):A&&(A.d(1),A=null);const ne={};if($&2&&(ne.connected=P[1]),$&8&&(ne.deviceName=P[3]),$&4&&(ne.fnAction=P[2]),b.$set(ne),$&36){j=P[5].filter(lr).slice(0,1.5*fr);let Q;for(Q=0;Q<j.length;Q+=1){const G=nr(P,j,Q);L[Q]?(L[Q].p(G,$),Y(L[Q],1)):(L[Q]=sr(G),L[Q].c(),Y(L[Q],1),L[Q].m(k.parentNode,k))}for(_t(),Q=j.length;Q<L.length;Q+=1)D(Q);ht()}},i(P){if(!T){Y(b.$$.fragment,P);for(let $=0;$<j.length;$+=1)Y(L[$]);T=!0}},o(P){Z(b.$$.fragment,P),L=L.filter(Boolean);for(let $=0;$<L.length;$+=1)Z(L[$]);T=!1},d(P){P&&S(e),A&&A.d(),P&&S(_),Ae(b,P),P&&S(p),Yt(L,P),P&&S(k),P&&S(y)}}}function rr(t){let e,n,i,r,s,f;return{c(){e=M("| "),n=N("a"),i=M("\u25B6 Next"),x(n,"href","#"),x(n,"class","next svelte-146wfrf"),x(n,"disabled",r=!t[7])},m(o,c){E(o,e,c),E(o,n,c),w(n,i),s||(f=ce(n,"click",rs(t[8])),s=!0)},p(o,c){c&128&&r!==(r=!o[7])&&x(n,"disabled",r)},d(o){o&&S(e),o&&S(n),s=!1,f()}}}function sr(t){let e,n;return e=new bs({props:{entry:t[10],fnAction:t[2]}}),{c(){Ee(e.$$.fragment)},m(i,r){ke(e,i,r),n=!0},p(i,r){const s={};r&32&&(s.entry=i[10]),r&4&&(s.fnAction=i[2]),e.$set(s)},i(i){n||(Y(e.$$.fragment,i),n=!0)},o(i){Z(e.$$.fragment,i),n=!1},d(i){Ae(e,i)}}}function cl(t){var r;let e,n,i=!t[6]&&((r=t[5])==null?void 0:r.length)&&ir(t);return{c(){i&&i.c(),e=ft()},m(s,f){i&&i.m(s,f),E(s,e,f),n=!0},p(s,[f]){var o;!s[6]&&((o=s[5])==null?void 0:o.length)?i?(i.p(s,f),f&96&&Y(i,1)):(i=ir(s),i.c(),Y(i,1),i.m(e.parentNode,e)):i&&(_t(),Z(i,1,1,()=>{i=null}),ht())},i(s){n||(Y(i),n=!0)},o(s){Z(i),n=!1},d(s){i&&i.d(s),s&&S(e)}}}const fr=20,lr=({current:t,past:e})=>!t&&!e;function al(t,e,n){let i,r,s,f=V,o=()=>(f(),f=bt(b,A=>n(9,s=A)),b),c,a,u=V,_=()=>(u(),u=bt(p,A=>n(7,a=A)),p);lt(t,It,A=>n(6,c=A)),t.$$.on_destroy.push(()=>f()),t.$$.on_destroy.push(()=>u());let{store:b}=e;o();let{connected:p}=e;_();let{fnAction:k}=e,{deviceName:y}=e;function T(){window.scrollTo({top:0,behavior:"smooth"}),k("next")}return t.$$set=A=>{"store"in A&&o(n(0,b=A.store)),"connected"in A&&_(n(1,p=A.connected)),"fnAction"in A&&n(2,k=A.fnAction),"deviceName"in A&&n(3,y=A.deviceName)},t.$$.update=()=>{t.$$.dirty&512&&n(5,i=s.playlist),t.$$.dirty&512&&n(4,r=s.playlistMetadata)},[b,p,k,y,r,i,c,a,T,s]}class ul extends We{constructor(e){super(),He(this,e,al,cl,Fe,{store:0,connected:1,fnAction:2,deviceName:3})}}function dl(t){let e,n,i,r,s,f,o;return n=new Wf({props:{connected:t[1],store:t[0],fnAction:t[2]}}),r=new sl({props:{connected:t[1],store:t[0],fnAction:t[2]}}),f=new ul({props:{connected:t[1],store:t[0],fnAction:t[2],deviceName:t[3]}}),{c(){e=N("div"),Ee(n.$$.fragment),i=U(),Ee(r.$$.fragment),s=U(),Ee(f.$$.fragment),x(e,"class","searchable_playlist svelte-1op3n77")},m(c,a){E(c,e,a),ke(n,e,null),w(e,i),ke(r,e,null),w(e,s),ke(f,e,null),o=!0},p(c,[a]){const u={};a&2&&(u.connected=c[1]),a&1&&(u.store=c[0]),a&4&&(u.fnAction=c[2]),n.$set(u);const _={};a&2&&(_.connected=c[1]),a&1&&(_.store=c[0]),a&4&&(_.fnAction=c[2]),r.$set(_);const b={};a&2&&(b.connected=c[1]),a&1&&(b.store=c[0]),a&4&&(b.fnAction=c[2]),a&8&&(b.deviceName=c[3]),f.$set(b)},i(c){o||(Y(n.$$.fragment,c),Y(r.$$.fragment,c),Y(f.$$.fragment,c),o=!0)},o(c){Z(n.$$.fragment,c),Z(r.$$.fragment,c),Z(f.$$.fragment,c),o=!1},d(c){c&&S(e),Ae(n),Ae(r),Ae(f)}}}function _l(t,e,n){let{store:i}=e,{connected:r}=e,{fnAction:s}=e,{deviceName:f}=e;return t.$$set=o=>{"store"in o&&n(0,i=o.store),"connected"in o&&n(1,r=o.connected),"fnAction"in o&&n(2,s=o.fnAction),"deviceName"in o&&n(3,f=o.deviceName)},[i,r,s,f]}class hl extends We{constructor(e){super(),He(this,e,_l,dl,Fe,{store:0,connected:1,fnAction:2,deviceName:3})}}function or(t){let e,n,i,r,s,f,o,c,a,u,_,b,p,k;return{c(){e=N("h3"),n=M("Play internet radio @ "),i=M(t[2]),r=U(),s=N("div"),f=N("button"),f.textContent="Rock",o=U(),c=N("button"),c.textContent="Jazz",a=U(),u=N("button"),u.textContent="Psytrance",_=U(),b=N("button"),b.textContent="Goatrance",x(f,"class","svelte-tpf42f"),x(c,"class","svelte-tpf42f"),x(u,"class","svelte-tpf42f"),x(b,"class","svelte-tpf42f"),x(s,"class","radios svelte-tpf42f")},m(y,T){E(y,e,T),w(e,n),w(e,i),E(y,r,T),E(y,s,T),w(s,f),w(s,o),w(s,c),w(s,a),w(s,u),w(s,_),w(s,b),p||(k=[ce(f,"click",t[4]),ce(c,"click",t[5]),ce(u,"click",t[6]),ce(b,"click",t[7])],p=!0)},p(y,T){T&4&&he(i,y[2])},d(y){y&&S(e),y&&S(r),y&&S(s),p=!1,ot(k)}}}function bl(t){let e,n=t[3]&&or(t);return{c(){n&&n.c(),e=ft()},m(i,r){n&&n.m(i,r),E(i,e,r)},p(i,[r]){i[3]?n?n.p(i,r):(n=or(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:V,o:V,d(i){n&&n.d(i),i&&S(e)}}}function ml(t,e,n){let i,r=V,s=()=>(r(),r=bt(f,p=>n(3,i=p)),f);t.$$.on_destroy.push(()=>r());let{connected:f}=e;s();let{fnAction:o}=e,{deviceName:c}=e;const a=()=>{o("play_radio",{radioId:"rock"})},u=()=>{o("play_radio",{radioId:"jazz"})},_=()=>{o("play_radio",{radioId:"progressive-trance"})},b=()=>{o("play_radio",{radioId:"goa-trance"})};return t.$$set=p=>{"connected"in p&&s(n(0,f=p.connected)),"fnAction"in p&&n(1,o=p.fnAction),"deviceName"in p&&n(2,c=p.deviceName)},[f,o,c,i,a,u,_,b]}class pl extends We{constructor(e){super(),He(this,e,ml,bl,Fe,{connected:0,fnAction:1,deviceName:2})}}function cr(t){let e,n;return e=new pl({props:{connected:t[0],fnAction:t[4],deviceName:t[1]}}),{c(){Ee(e.$$.fragment)},m(i,r){ke(e,i,r),n=!0},p(i,r){const s={};r&1&&(s.connected=i[0]),r&16&&(s.fnAction=i[4]),r&2&&(s.deviceName=i[1]),e.$set(s)},i(i){n||(Y(e.$$.fragment,i),n=!0)},o(i){Z(e.$$.fragment,i),n=!1},d(i){Ae(e,i)}}}function ar(t){let e,n;return e=new hl({props:{connected:t[0],store:t[3],fnAction:t[4],deviceName:t[1]}}),{c(){Ee(e.$$.fragment)},m(i,r){ke(e,i,r),n=!0},p(i,r){const s={};r&1&&(s.connected=i[0]),r&8&&(s.store=i[3]),r&16&&(s.fnAction=i[4]),r&2&&(s.deviceName=i[1]),e.$set(s)},i(i){n||(Y(e.$$.fragment,i),n=!0)},o(i){Z(e.$$.fragment,i),n=!1},d(i){Ae(e,i)}}}function vl(t){var u;let e,n,i,r,s,f,o;e=new xf({props:{connected:t[0],store:t[3],player:t[2],songTitle:t[9],songPath:t[8],playlistCurrentMedia:t[6],playlistSongPath:t[5],fnAction:t[4]}}),i=new zf({props:{connected:t[0],player:t[2],fnAction:t[4],songTitle:t[9],deviceName:t[1]}});let c=t[1]!="tv-ap2"&&cr(t),a=!t[2].isStream&&((u=t[7])==null?void 0:u.length)&&ar(t);return{c(){Ee(e.$$.fragment),n=U(),Ee(i.$$.fragment),r=U(),c&&c.c(),s=U(),a&&a.c(),f=ft()},m(_,b){ke(e,_,b),E(_,n,b),ke(i,_,b),E(_,r,b),c&&c.m(_,b),E(_,s,b),a&&a.m(_,b),E(_,f,b),o=!0},p(_,[b]){var y;const p={};b&1&&(p.connected=_[0]),b&8&&(p.store=_[3]),b&4&&(p.player=_[2]),b&512&&(p.songTitle=_[9]),b&256&&(p.songPath=_[8]),b&64&&(p.playlistCurrentMedia=_[6]),b&32&&(p.playlistSongPath=_[5]),b&16&&(p.fnAction=_[4]),e.$set(p);const k={};b&1&&(k.connected=_[0]),b&4&&(k.player=_[2]),b&16&&(k.fnAction=_[4]),b&512&&(k.songTitle=_[9]),b&2&&(k.deviceName=_[1]),i.$set(k),_[1]!="tv-ap2"?c?(c.p(_,b),b&2&&Y(c,1)):(c=cr(_),c.c(),Y(c,1),c.m(s.parentNode,s)):c&&(_t(),Z(c,1,1,()=>{c=null}),ht()),!_[2].isStream&&((y=_[7])==null?void 0:y.length)?a?(a.p(_,b),b&132&&Y(a,1)):(a=ar(_),a.c(),Y(a,1),a.m(f.parentNode,f)):a&&(_t(),Z(a,1,1,()=>{a=null}),ht())},i(_){o||(Y(e.$$.fragment,_),Y(i.$$.fragment,_),Y(c),Y(a),o=!0)},o(_){Z(e.$$.fragment,_),Z(i.$$.fragment,_),Z(c),Z(a),o=!1},d(_){Ae(e,_),_&&S(n),Ae(i,_),_&&S(r),c&&c.d(_),_&&S(s),a&&a.d(_),_&&S(f)}}}function yl(t,e,n){let i,r,s,f,o,c,a,u,_,b,p=V,k=()=>(p(),p=bt(j,D=>n(14,b=D)),j);t.$$.on_destroy.push(()=>p());let{connected:y}=e,{deviceName:T}=e,{player:A}=e,{store:j}=e;k();let{fnAction:L}=e;return t.$$set=D=>{"connected"in D&&n(0,y=D.connected),"deviceName"in D&&n(1,T=D.deviceName),"player"in D&&n(2,A=D.player),"store"in D&&k(n(3,j=D.store)),"fnAction"in D&&n(4,L=D.fnAction)},t.$$.update=()=>{t.$$.dirty&4&&n(13,i=A.currentMedia||{}),t.$$.dirty&8192&&n(12,r=i.artist&&i.song?`${i.artist} - ${i.song}`:i.song),t.$$.dirty&8192&&n(10,s=i.songPath),t.$$.dirty&16384&&n(7,f=b.playlist),t.$$.dirty&128&&n(6,o=(f||[]).find(({current:D})=>D)),t.$$.dirty&64&&n(11,c=o==null?void 0:o.title),t.$$.dirty&64&&n(5,a=o==null?void 0:o.path),t.$$.dirty&6144&&n(9,u=r||c),t.$$.dirty&1056&&n(8,_=s||a)},[y,T,A,j,L,a,o,f,_,u,s,c,r,i,b]}class gl extends We{constructor(e){super(),He(this,e,yl,vl,Fe,{connected:0,deviceName:1,player:2,store:3,fnAction:4})}}function ur(t,e,n){const i=t.slice();return i[15]=e[n],i}function dr(t){let e,n=t[3],i=[];for(let r=0;r<n.length;r+=1)i[r]=br(ur(t,n,r));return{c(){e=N("div");for(let r=0;r<i.length;r+=1)i[r].c();x(e,"class","nearby_devices svelte-f8wsgm")},m(r,s){E(r,e,s);for(let f=0;f<i.length;f+=1)i[f].m(e,null)},p(r,s){if(s&251){n=r[3];let f;for(f=0;f<n.length;f+=1){const o=ur(r,n,f);i[f]?i[f].p(o,s):(i[f]=br(o),i[f].c(),i[f].m(e,null))}for(;f<i.length;f+=1)i[f].d(1);i.length=n.length}},d(r){r&&S(e),Yt(i,r)}}}function _r(t){let e;return{c(){e=N("span"),e.textContent="!",x(e,"class","error svelte-f8wsgm")},m(n,i){E(n,e,i)},d(n){n&&S(e)}}}function hr(t){let e,n=t[15].mediaType=="music"?"\u266B":"\u25B6",i;return{c(){e=N("span"),i=M(n),x(e,"class","play_symbol svelte-f8wsgm")},m(r,s){E(r,e,s),w(e,i)},p(r,s){s&8&&n!==(n=r[15].mediaType=="music"?"\u266B":"\u25B6")&&he(i,n)},d(r){r&&S(e)}}}function br(t){let e,n,i,r=t[15].deviceName+"",s,f,o,c,a=t[15].hasErrors&&_r(),u=t[15].playing&&hr(t);return{c(){e=N("button"),a&&a.c(),n=U(),u&&u.c(),i=U(),s=M(r),f=U(),x(e,"class","svelte-f8wsgm"),J(e,"active",t[15].deviceKey==t[0]),J(e,"local_device",t[15].thisDevice),J(e,"playing",t[15].playing),J(e,"late_pong1",t[4]-t[5][t[15].deviceKey]>2e3),J(e,"late_pong2",t[4]-t[5][t[15].deviceKey]>2500),J(e,"late_pong3",t[4]-t[5][t[15].deviceKey]>3500),J(e,"connected",t[6][t[15].deviceKey]),J(e,"disconnected",t[6][t[15].deviceKey]==!1),J(e,"cpu_usage_warn1",t[15].cpuUsage>50),J(e,"cpu_usage_warn2",t[15].cpuUsage>70),J(e,"cpu_usage_warn3",t[15].cpuUsage>80)},m(_,b){E(_,e,b),a&&a.m(e,null),w(e,n),u&&u.m(e,null),w(e,i),w(e,s),w(e,f),o||(c=ce(e,"click",function(){_n(t[7]({store:t[1],device:t[15]}))&&t[7]({store:t[1],device:t[15]}).apply(this,arguments)}),o=!0)},p(_,b){t=_,t[15].hasErrors?a||(a=_r(),a.c(),a.m(e,n)):a&&(a.d(1),a=null),t[15].playing?u?u.p(t,b):(u=hr(t),u.c(),u.m(e,i)):u&&(u.d(1),u=null),b&8&&r!==(r=t[15].deviceName+"")&&he(s,r),b&9&&J(e,"active",t[15].deviceKey==t[0]),b&8&&J(e,"local_device",t[15].thisDevice),b&8&&J(e,"playing",t[15].playing),b&56&&J(e,"late_pong1",t[4]-t[5][t[15].deviceKey]>2e3),b&56&&J(e,"late_pong2",t[4]-t[5][t[15].deviceKey]>2500),b&56&&J(e,"late_pong3",t[4]-t[5][t[15].deviceKey]>3500),b&72&&J(e,"connected",t[6][t[15].deviceKey]),b&72&&J(e,"disconnected",t[6][t[15].deviceKey]==!1),b&8&&J(e,"cpu_usage_warn1",t[15].cpuUsage>50),b&8&&J(e,"cpu_usage_warn2",t[15].cpuUsage>70),b&8&&J(e,"cpu_usage_warn3",t[15].cpuUsage>80)},d(_){_&&S(e),a&&a.d(),u&&u.d(),o=!1,c()}}}function wl(t){let e,n=t[3].length&&dr(t);return{c(){n&&n.c(),e=ft()},m(i,r){n&&n.m(i,r),E(i,e,r)},p(i,[r]){i[3].length?n?n.p(i,r):(n=dr(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:V,o:V,d(i){n&&n.d(i),i&&S(e)}}}function kl(t,e,n){let i,r,s,f,o;lt(t,as,A=>n(12,r=A));let{nearbyDevices:c}=e,{activeDeviceKey:a}=e,{store:u}=e,{log:_}=e;function b({store:A,device:j}){Nn.set(null),It.set(null),localStorage.setItem("current_device_key",j.deviceKey),A.switch(j)}const p=Et({});lt(t,p,A=>n(5,f=A)),u.on("pong",({deviceKey:A})=>{p.update(j=>(j[A]=Date.now(),j))});const k=Et({});lt(t,k,A=>n(6,o=A)),k.alreadyDone={};const y=Et(Date.now());lt(t,y,A=>n(4,s=A));function T(){y.set(Date.now()),setTimeout(T,300)}return T(),t.$$set=A=>{"nearbyDevices"in A&&n(10,c=A.nearbyDevices),"activeDeviceKey"in A&&n(0,a=A.activeDeviceKey),"store"in A&&n(1,u=A.store),"log"in A&&n(11,_=A.log)},t.$$.update=()=>{t.$$.dirty&7175&&n(3,i=c.filter(({deviceName:A,playing:j,deviceKey:L,thisDevice:D,ip:P,isRPi:$})=>(L==a||j||r)&&($||D)).map(A=>{const{ip:j,deviceKey:L,deviceName:D,thisDevice:P,playing:$}=A;return k.alreadyDone[L]||(n(2,k.alreadyDone[L]=!0,k),setTimeout(()=>{_(`${j} Preconnecting ${D}`);const Q=u.preconnect({host:j,deviceKey:L,thisDevice:P});Q.__prevSubUnsubscribe?Q.__prevSubUnsubscribe():Q.on("decommission",()=>{_(`dmt-mobile: Decommissioned connector ${D} @ ${j}`),n(2,k.alreadyDone[L]=!1,k),Q.__prevSubUnsubscribe&&Q.__prevSubUnsubscribe()}),Q.__prevSubUnsubscribe=Q.connected.subscribe(G=>{k.update(me=>(me[L]=G,me))})},0)),A}))},[a,u,k,i,s,f,o,b,p,y,c,_,r]}class Al extends We{constructor(e){super(),He(this,e,kl,wl,Fe,{nearbyDevices:10,activeDeviceKey:0,store:1,log:11})}}function mr(t,e,n){const i=t.slice();return i[46]=e[n],i}function Sl(t){let e,n=(t[1].network||"")+"",i;return{c(){e=N("h3"),i=M(n),x(e,"class","svelte-29mnrb")},m(r,s){E(r,e,s),w(e,i)},p(r,s){s[0]&2&&n!==(n=(r[1].network||"")+"")&&he(i,n)},i:V,o:V,d(r){r&&S(e)}}}function El(t){let e,n,i,r,s;function f(a,u){return a[9]==0?Cl:Tl}let o=f(t),c=o(t);return{c(){e=N("h3"),n=M(`Vhod
      `),i=N("span"),r=M(`\u2014 odpiranje
        `),c.c(),x(i,"class","svelte-29mnrb"),x(e,"class","entry_door_countdown svelte-29mnrb")},m(a,u){E(a,e,u),w(e,n),w(e,i),w(i,r),c.m(i,null)},p(a,u){o===(o=f(a))&&c?c.p(a,u):(c.d(1),c=o(a),c&&(c.c(),c.m(i,null)))},i(a){s||pt(()=>{s=Pt(i,cs,{}),s.start()})},o:V,d(a){a&&S(e),c.d()}}}function Tl(t){let e,n,i;return{c(){e=M("\u010Dez "),n=M(t[9]),i=M("s")},m(r,s){E(r,e,s),E(r,n,s),E(r,i,s)},p(r,s){s[0]&512&&he(n,r[9])},d(r){r&&S(e),r&&S(n),r&&S(i)}}}function Cl(t){let e;return{c(){e=M("ZDAJ")},m(n,i){E(n,e,i)},p:V,d(n){n&&S(e)}}}function pr(t){let e,n,i,r,s,f,o,c,a,u,_,b,p,k;return{c(){e=N("div"),n=N("button"),i=M("ODPRI ZDAJ"),s=U(),f=N("button"),o=M("Zakasnitev +10s"),a=U(),u=N("button"),_=M("Prekli\u010Di"),x(n,"class","open svelte-29mnrb"),n.disabled=r=!t[10]||t[9]==0,x(f,"class","delayed_open svelte-29mnrb"),f.disabled=c=!t[10]||t[9]==0,x(u,"class","cancel svelte-29mnrb"),u.disabled=b=!t[10]||t[9]==0,x(e,"class","entry_door_options svelte-29mnrb")},m(y,T){E(y,e,T),w(e,n),w(n,i),w(e,s),w(e,f),w(f,o),w(e,a),w(e,u),w(u,_),p||(k=[ce(n,"click",t[23]),ce(f,"click",t[24]),ce(u,"click",t[25])],p=!0)},p(y,T){T[0]&1536&&r!==(r=!y[10]||y[9]==0)&&(n.disabled=r),T[0]&1536&&c!==(c=!y[10]||y[9]==0)&&(f.disabled=c),T[0]&1536&&b!==(b=!y[10]||y[9]==0)&&(u.disabled=b)},d(y){y&&S(e),p=!1,ot(k)}}}function Dl(t){var Ot;let e,n,i,r,s,f,o,c,a,u,_,b=(Ot=t[2])==null?void 0:Ot.find(t[20]),p,k,y,T,A,j,L,D,P,$,ne,Q,G,me,ze,qe,Ye,oe,Ie,ae,Re,mt,tt,Tt,gt,wt,it;function rt(q,de){return q[4]?Nl:xl}let ge=rt(t),Be=ge(t);function Ct(q,de){return q[5]?Rl:Il}let Dt=Ct(t),ct=Dt(t),Qe=b&&yr(t),Je=t[10]&&t[6]!=null&&kr(t);return{c(){e=N("h3"),e.textContent="Parkiri\u0161\u010De",n=U(),i=N("div"),r=N("button"),s=M("ODPRI"),o=U(),Be.c(),c=U(),a=N("h3"),a.textContent="Dnevna TV",u=U(),ct.c(),_=U(),Qe&&Qe.c(),p=U(),k=N("h3"),k.textContent="Kabinet",y=U(),T=N("button"),A=M("PRI\u017DGI LU\u010C"),L=U(),D=N("button"),P=M("UGASNI LU\u010C"),ne=U(),Q=N("button"),G=M("UGASNI KMALU"),ze=U(),Je&&Je.c(),qe=U(),Ye=N("h3"),Ye.textContent="Alarm",oe=U(),Ie=N("button"),ae=M("VKLOPI"),mt=U(),tt=N("button"),Tt=M("IZKLOPI"),x(e,"class","svelte-29mnrb"),r.disabled=f=!t[10]||t[8]||t[7],x(r,"class","svelte-29mnrb"),x(i,"class","parking_door_options svelte-29mnrb"),x(a,"class","svelte-29mnrb"),x(k,"class","svelte-29mnrb"),T.disabled=j=!t[10],x(T,"class","svelte-29mnrb"),D.disabled=$=!t[10],x(D,"class","svelte-29mnrb"),Q.disabled=me=!t[10],x(Q,"class","svelte-29mnrb"),x(Ye,"class","svelte-29mnrb"),Ie.disabled=Re=!t[10],x(Ie,"class","svelte-29mnrb"),tt.disabled=gt=!t[10],x(tt,"class","svelte-29mnrb")},m(q,de){E(q,e,de),E(q,n,de),E(q,i,de),w(i,r),w(r,s),w(i,o),Be.m(i,null),E(q,c,de),E(q,a,de),E(q,u,de),ct.m(q,de),E(q,_,de),Qe&&Qe.m(q,de),E(q,p,de),E(q,k,de),E(q,y,de),E(q,T,de),w(T,A),E(q,L,de),E(q,D,de),w(D,P),E(q,ne,de),E(q,Q,de),w(Q,G),E(q,ze,de),Je&&Je.m(q,de),E(q,qe,de),E(q,Ye,de),E(q,oe,de),E(q,Ie,de),w(Ie,ae),E(q,mt,de),E(q,tt,de),w(tt,Tt),wt||(it=[ce(r,"click",t[27]),ce(T,"click",t[41]),ce(D,"click",t[42]),ce(Q,"click",t[43]),ce(Ie,"click",t[44]),ce(tt,"click",t[45])],wt=!0)},p(q,de){var $t;de[0]&1408&&f!==(f=!q[10]||q[8]||q[7])&&(r.disabled=f),ge===(ge=rt(q))&&Be?Be.p(q,de):(Be.d(1),Be=ge(q),Be&&(Be.c(),Be.m(i,null))),Dt===(Dt=Ct(q))&&ct?ct.p(q,de):(ct.d(1),ct=Dt(q),ct&&(ct.c(),ct.m(_.parentNode,_))),de[0]&4&&(b=($t=q[2])==null?void 0:$t.find(q[20])),b?Qe?Qe.p(q,de):(Qe=yr(q),Qe.c(),Qe.m(p.parentNode,p)):Qe&&(Qe.d(1),Qe=null),de[0]&1024&&j!==(j=!q[10])&&(T.disabled=j),de[0]&1024&&$!==($=!q[10])&&(D.disabled=$),de[0]&1024&&me!==(me=!q[10])&&(Q.disabled=me),q[10]&&q[6]!=null?Je?(Je.p(q,de),de[0]&1088&&Y(Je,1)):(Je=kr(q),Je.c(),Y(Je,1),Je.m(qe.parentNode,qe)):Je&&(Je.d(1),Je=null),de[0]&1024&&Re!==(Re=!q[10])&&(Ie.disabled=Re),de[0]&1024&&gt!==(gt=!q[10])&&(tt.disabled=gt)},i(q){Y(Je)},o:V,d(q){q&&S(e),q&&S(n),q&&S(i),Be.d(),q&&S(c),q&&S(a),q&&S(u),ct.d(q),q&&S(_),Qe&&Qe.d(q),q&&S(p),q&&S(k),q&&S(y),q&&S(T),q&&S(L),q&&S(D),q&&S(ne),q&&S(Q),q&&S(ze),Je&&Je.d(q),q&&S(qe),q&&S(Ye),q&&S(oe),q&&S(Ie),q&&S(mt),q&&S(tt),wt=!1,ot(it)}}}function Ol(t){let e,n,i,r,s=t[11]&&Ar(t);return{c(){s&&s.c(),e=U(),n=N("button"),n.textContent="Ve\u010D mo\u017Enosti",x(n,"class","show_more_options svelte-29mnrb")},m(f,o){s&&s.m(f,o),E(f,e,o),E(f,n,o),i||(r=ce(n,"click",t[26]),i=!0)},p(f,o){f[11]?s?s.p(f,o):(s=Ar(f),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null)},i:V,o:V,d(f){s&&s.d(f),f&&S(e),f&&S(n),i=!1,r()}}}function Nl(t){let e,n,i,r,s,f,o,c,a,u,_,b,p,k,y,T,A,j=t[8]&&vr();return{c(){e=N("button"),n=M("OSEBNI PREHOD"),r=U(),s=N("h4"),s.textContent="[ odpri in ohrani ]",f=U(),o=N("button"),c=M("ODPRI IN OHRANI"),u=U(),_=N("button"),b=M("ZAPRI"),k=U(),j&&j.c(),y=ft(),e.disabled=i=!t[10]||t[8],x(e,"class","svelte-29mnrb"),J(e,"personal_entry_in_progress",t[7]),x(s,"class","suboption svelte-29mnrb"),o.disabled=a=!t[10]||t[7],x(o,"class","svelte-29mnrb"),J(o,"keep_open_in_progress",t[8]),_.disabled=p=!t[10]||t[8]||t[7],x(_,"class","svelte-29mnrb")},m(L,D){E(L,e,D),w(e,n),E(L,r,D),E(L,s,D),E(L,f,D),E(L,o,D),w(o,c),E(L,u,D),E(L,_,D),w(_,b),E(L,k,D),j&&j.m(L,D),E(L,y,D),T||(A=[ce(e,"click",t[29]),ce(o,"click",t[30]),ce(_,"click",t[31])],T=!0)},p(L,D){D[0]&1280&&i!==(i=!L[10]||L[8])&&(e.disabled=i),D[0]&128&&J(e,"personal_entry_in_progress",L[7]),D[0]&1152&&a!==(a=!L[10]||L[7])&&(o.disabled=a),D[0]&256&&J(o,"keep_open_in_progress",L[8]),D[0]&1408&&p!==(p=!L[10]||L[8]||L[7])&&(_.disabled=p),L[8]?j||(j=vr(),j.c(),j.m(y.parentNode,y)):j&&(j.d(1),j=null)},d(L){L&&S(e),L&&S(r),L&&S(s),L&&S(f),L&&S(o),L&&S(u),L&&S(_),L&&S(k),j&&j.d(L),L&&S(y),T=!1,ot(A)}}}function xl(t){let e,n,i;return{c(){e=N("button"),e.textContent="Ve\u010D mo\u017Enosti",x(e,"class","show_more_options svelte-29mnrb")},m(r,s){E(r,e,s),n||(i=ce(e,"click",t[28]),n=!0)},p:V,d(r){r&&S(e),n=!1,i()}}}function vr(t){let e;return{c(){e=N("h4"),e.textContent="[ \u26A0\uFE0F v zadnji sekundi odpiranja ne sme biti prehoda, sicer vrata ne bodo ostala odprta ]",x(e,"class","suboption warn svelte-29mnrb")},m(n,i){E(n,e,i)},d(n){n&&S(e)}}}function Rl(t){let e,n,i,r,s,f,o,c,a,u,_,b,p,k,y,T,A,j,L,D,P,$,ne,Q,G,me,ze,qe,Ye,oe,Ie;return{c(){e=N("button"),n=M("T2"),r=U(),s=N("button"),f=M("DMT"),c=U(),a=N("button"),u=M("UGASNI"),b=U(),p=N("h4"),p.textContent="[ TV glasnost ]",k=U(),y=N("button"),T=M("MUTE"),j=U(),L=N("button"),D=M("VOL UP"),$=U(),ne=N("button"),Q=M("VOL DOWN"),me=U(),ze=N("button"),qe=M("DEFAULT"),e.disabled=i=!t[10],x(e,"class","svelte-29mnrb"),s.disabled=o=!t[10],x(s,"class","svelte-29mnrb"),a.disabled=_=!t[10],x(a,"class","svelte-29mnrb"),x(p,"class","suboption svelte-29mnrb"),y.disabled=A=!t[10],x(y,"class","svelte-29mnrb"),L.disabled=P=!t[10],x(L,"class","svelte-29mnrb"),ne.disabled=G=!t[10],x(ne,"class","svelte-29mnrb"),ze.disabled=Ye=!t[10],x(ze,"class","svelte-29mnrb")},m(ae,Re){E(ae,e,Re),w(e,n),E(ae,r,Re),E(ae,s,Re),w(s,f),E(ae,c,Re),E(ae,a,Re),w(a,u),E(ae,b,Re),E(ae,p,Re),E(ae,k,Re),E(ae,y,Re),w(y,T),E(ae,j,Re),E(ae,L,Re),w(L,D),E(ae,$,Re),E(ae,ne,Re),w(ne,Q),E(ae,me,Re),E(ae,ze,Re),w(ze,qe),oe||(Ie=[ce(e,"click",t[33]),ce(s,"click",t[34]),ce(a,"click",t[35]),ce(y,"click",t[36]),ce(L,"click",t[37]),ce(ne,"click",t[38]),ce(ze,"click",t[39])],oe=!0)},p(ae,Re){Re[0]&1024&&i!==(i=!ae[10])&&(e.disabled=i),Re[0]&1024&&o!==(o=!ae[10])&&(s.disabled=o),Re[0]&1024&&_!==(_=!ae[10])&&(a.disabled=_),Re[0]&1024&&A!==(A=!ae[10])&&(y.disabled=A),Re[0]&1024&&P!==(P=!ae[10])&&(L.disabled=P),Re[0]&1024&&G!==(G=!ae[10])&&(ne.disabled=G),Re[0]&1024&&Ye!==(Ye=!ae[10])&&(ze.disabled=Ye)},d(ae){ae&&S(e),ae&&S(r),ae&&S(s),ae&&S(c),ae&&S(a),ae&&S(b),ae&&S(p),ae&&S(k),ae&&S(y),ae&&S(j),ae&&S(L),ae&&S($),ae&&S(ne),ae&&S(me),ae&&S(ze),oe=!1,ot(Ie)}}}function Il(t){let e,n,i;return{c(){e=N("button"),e.textContent="Mo\u017Enosti TV",x(e,"class","show_more_options svelte-29mnrb")},m(r,s){E(r,e,s),n||(i=ce(e,"click",t[32]),n=!0)},p:V,d(r){r&&S(e),n=!1,i()}}}function yr(t){let e,n,i,r=t[18],s=[];for(let f=0;f<r.length;f+=1)s[f]=wr(mr(t,r,f));return{c(){e=N("h3"),e.textContent="Izklop ra\u010Dunalnikov",n=U();for(let f=0;f<s.length;f+=1)s[f].c();i=ft(),x(e,"class","svelte-29mnrb")},m(f,o){E(f,e,o),E(f,n,o);for(let c=0;c<s.length;c+=1)s[c].m(f,o);E(f,i,o)},p(f,o){if(o[0]&263173){r=f[18];let c;for(c=0;c<r.length;c+=1){const a=mr(f,r,c);s[c]?s[c].p(a,o):(s[c]=wr(a),s[c].c(),s[c].m(i.parentNode,i))}for(;c<s.length;c+=1)s[c].d(1);s.length=r.length}},d(f){f&&S(e),f&&S(n),Yt(s,f),f&&S(i)}}}function gr(t){let e,n,i=t[46]+"",r,s,f,o,c;function a(){return t[40](t[46])}return{c(){e=N("button"),n=M("\u{1F6D1} "),r=M(i),f=U(),e.disabled=s=!t[10],x(e,"class","svelte-29mnrb")},m(u,_){E(u,e,_),w(e,n),w(e,r),E(u,f,_),o||(c=ce(e,"click",a),o=!0)},p(u,_){t=u,_[0]&1024&&s!==(s=!t[10])&&(e.disabled=s)},d(u){u&&S(e),u&&S(f),o=!1,c()}}}function wr(t){var s;let e=(s=t[2])==null?void 0:s.find(i),n;function i(...f){return t[21](t[46],...f)}let r=e&&gr(t);return{c(){r&&r.c(),n=ft()},m(f,o){r&&r.m(f,o),E(f,n,o)},p(f,o){var c;t=f,o[0]&4&&(e=(c=t[2])==null?void 0:c.find(i)),e?r?r.p(t,o):(r=gr(t),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(f){r&&r.d(f),f&&S(n)}}}function kr(t){let e,n,i,r;function s(c,a){return c[6]==0?Ml:Pl}let f=s(t),o=f(t);return{c(){e=N("h3"),n=M(`Uga\u0161anje
        `),i=N("span"),o.c(),x(i,"class","svelte-29mnrb"),x(e,"class","entry_door_countdown svelte-29mnrb")},m(c,a){E(c,e,a),w(e,n),w(e,i),o.m(i,null)},p(c,a){f===(f=s(c))&&o?o.p(c,a):(o.d(1),o=f(c),o&&(o.c(),o.m(i,null)))},i(c){r||pt(()=>{r=Pt(i,cs,{}),r.start()})},o:V,d(c){c&&S(e),o.d()}}}function Pl(t){let e,n,i;return{c(){e=M("\u010Dez "),n=M(t[6]),i=M("s")},m(r,s){E(r,e,s),E(r,n,s),E(r,i,s)},p(r,s){s[0]&64&&he(n,r[6])},d(r){r&&S(e),r&&S(n),r&&S(i)}}}function Ml(t){let e;return{c(){e=M("ZDAJ")},m(n,i){E(n,e,i)},p:V,d(n){n&&S(e)}}}function Ar(t){let e,n,i=(t[1].network||"")+"",r;return{c(){e=N("h3"),n=M("Ve\u010D mo\u017Enosti - "),r=M(i),x(e,"class","svelte-29mnrb")},m(s,f){E(s,e,f),w(e,n),w(e,r)},p(s,f){f[0]&2&&i!==(i=(s[1].network||"")+"")&&he(r,i)},d(s){s&&S(e)}}}function Ll(t){let e,n,i,r,s,f,o,c,a;function u(A,j){return A[10]&&A[11]?El:Sl}let _=u(t),b=_(t),p=t[11]&&pr(t);function k(A,j){return A[3]?Dl:Ol}let y=k(t),T=y(t);return{c(){e=N("div"),b.c(),n=U(),i=N("button"),r=M("ODPIRANJE VHODNIH VRAT"),f=U(),p&&p.c(),o=U(),T.c(),x(i,"class","open_door_show_options svelte-29mnrb"),i.disabled=s=!t[10],J(i,"invisible",t[11]),x(e,"class","options svelte-29mnrb")},m(A,j){E(A,e,j),b.m(e,null),w(e,n),w(e,i),w(i,r),w(e,f),p&&p.m(e,null),w(e,o),T.m(e,null),c||(a=ce(i,"click",t[22]),c=!0)},p(A,j){_===(_=u(A))&&b?b.p(A,j):(b.d(1),b=_(A),b&&(b.c(),Y(b,1),b.m(e,n))),j[0]&1024&&s!==(s=!A[10])&&(i.disabled=s),j[0]&2048&&J(i,"invisible",A[11]),A[11]?p?p.p(A,j):(p=pr(A),p.c(),p.m(e,o)):p&&(p.d(1),p=null),y===(y=k(A))&&T?T.p(A,j):(T.d(1),T=y(A),T&&(T.c(),Y(T,1),T.m(e,null)))},i(A){Y(b),Y(T)},o:V,d(A){A&&S(e),b.d(),p&&p.d(),T.d(),c=!1,a()}}}const Sr=10;function Ul(t,e,n){let i,r,s,f,o,c,a,{connector:u}=e,{localDevice:_}=e,{nearbyDevices:b}=e;const{connected:p,state:k}=u;lt(t,p,q=>n(10,c=q)),lt(t,k,q=>n(19,o=q));const y=uf(k,q=>{var de;return((de=q.entryDoor)==null?void 0:de.counter)!=null});lt(t,y,q=>n(11,a=q));function T(q,de){u.signal("action",{action:q,payload:de,namespace:"iot"})}function A(q,de){u.signal("action",{action:q,payload:de,namespace:"tv"})}function j(){T("entry-door-open")}let L=_.deviceName=="turbine",D,P;const $=["andreja","eclipse"],ne=({deviceName:q})=>$.includes(q),Q=(q,{deviceName:de})=>q==de,G=()=>{T("entry-door-open-delay",{delay:Sr})},me=()=>{j()},ze=()=>{T("entry-door-open-add-delay",{addDelay:Sr})},qe=()=>{T("entry-door-open-cancel")},Ye=()=>{n(3,L=!0)},oe=()=>{T("fence-door-move")},Ie=()=>{n(4,D=!0)},ae=()=>{T("fence-door-personal-entry")},Re=()=>{T("fence-door-keep-open")},mt=()=>{T("fence-door-close")},tt=()=>{n(5,P=!0)},Tt=()=>{A("hdmi1")},gt=()=>{A("hdmi2")},wt=()=>{A("off")},it=()=>{A("mute")},rt=()=>{A("vol-up")},ge=()=>{A("vol-down")},Be=()=>{A("vol-default")},Ct=q=>{u.signal("action",{action:"sleep",namespace:"iot",payload:q})},Dt=()=>{T("lab-light-on")},ct=()=>{T("lab-light-off")},Qe=()=>{T("lab-light-off-delay")},Je=()=>{T("alarm-enable")},Ot=()=>{T("alarm-disable")};return t.$$set=q=>{"connector"in q&&n(0,u=q.connector),"localDevice"in q&&n(1,_=q.localDevice),"nearbyDevices"in q&&n(2,b=q.nearbyDevices)},t.$$.update=()=>{var q,de,$t,hn;t.$$.dirty[0]&524288&&n(9,i=(q=o.entryDoor)==null?void 0:q.counter),t.$$.dirty[0]&524288&&n(8,r=(de=o.parkingDoor)==null?void 0:de.keepOpenInProgress),t.$$.dirty[0]&524288&&n(7,s=($t=o.parkingDoor)==null?void 0:$t.personalEntryInProgress),t.$$.dirty[0]&524288&&n(6,f=(hn=o.lights)==null?void 0:hn.labLightOffDelay)},[u,_,b,L,D,P,f,s,r,i,c,a,p,k,y,T,A,j,$,o,ne,Q,G,me,ze,qe,Ye,oe,Ie,ae,Re,mt,tt,Tt,gt,wt,it,rt,ge,Be,Ct,Dt,ct,Qe,Je,Ot]}class jl extends We{constructor(e){super(),He(this,e,Ul,Ll,Fe,{connector:0,localDevice:1,nearbyDevices:2},null,[-1,-1])}}function $l(t){let e,n=Er(t[2])+"",i,r,s=t[1].replace("blinds","")+"",f,o,c,a;return{c(){e=N("button"),i=M(n),r=U(),f=M(s),e.disabled=o=!t[4],x(e,"class","svelte-1u4dkh7"),J(e,"moving",t[3]&&t[3][Mt(t[0],t[1],t[2])]&&t[3][Mt(t[0],t[1],t[2])].blindsStatus=="moving"),J(e,"present",t[3]&&t[3][Mt(t[0],t[1],t[2])]&&t[3][Mt(t[0],t[1],t[2])].present),J(e,"disconnected",t[4]==!1)},m(u,_){E(u,e,_),w(e,i),w(e,r),w(e,f),c||(a=ce(e,"click",t[10]),c=!0)},p(u,[_]){_&4&&n!==(n=Er(u[2])+"")&&he(i,n),_&2&&s!==(s=u[1].replace("blinds","")+"")&&he(f,s),_&16&&o!==(o=!u[4])&&(e.disabled=o),_&15&&J(e,"moving",u[3]&&u[3][Mt(u[0],u[1],u[2])]&&u[3][Mt(u[0],u[1],u[2])].blindsStatus=="moving"),_&15&&J(e,"present",u[3]&&u[3][Mt(u[0],u[1],u[2])]&&u[3][Mt(u[0],u[1],u[2])].present),_&16&&J(e,"disconnected",u[4]==!1)},i:V,o:V,d(u){u&&S(e),c=!1,a()}}}function Er(t){return t=="up"?"\u25B2":"\u25BC"}function Mt(t,e,n){return`${t}-${e}-${n}`}function Kl(t,e,n){let i,r,s,{connector:f}=e,{placeId:o}=e,{blindsId:c}=e,{blindsDirection:a}=e;const{state:u,connected:_}=f;lt(t,u,y=>n(9,r=y)),lt(t,_,y=>n(4,s=y));function b(y,T){f.signal("action",{action:y,namespace:"iot",payload:T})}function p(y,T,A){b("blinds",{placeId:y,blindsId:T,blindsDirection:A,blindsAction:"move"})}const k=()=>p(o,c,a);return t.$$set=y=>{"connector"in y&&n(8,f=y.connector),"placeId"in y&&n(0,o=y.placeId),"blindsId"in y&&n(1,c=y.blindsId),"blindsDirection"in y&&n(2,a=y.blindsDirection)},t.$$.update=()=>{t.$$.dirty&512&&n(3,i=r.blinds)},[o,c,a,i,s,u,_,p,f,r,k]}class nt extends We{constructor(e){super(),He(this,e,Kl,$l,Fe,{connector:8,placeId:0,blindsId:1,blindsDirection:2})}}function Bl(t){let e,n,i,r,s,f,o,c,a,u,_,b,p,k,y,T,A,j,L,D,P;return s=new nt({props:{placeId:"ap1",blindsId:"blinds4",blindsDirection:"up",connector:t[0]}}),o=new nt({props:{placeId:"ap1",blindsId:"blinds3",blindsDirection:"up",connector:t[0]}}),a=new nt({props:{placeId:"ap1",blindsId:"blinds2",blindsDirection:"up",connector:t[0]}}),_=new nt({props:{placeId:"ap1",blindsId:"blinds1",blindsDirection:"up",connector:t[0]}}),k=new nt({props:{placeId:"ap1",blindsId:"blinds4",blindsDirection:"down",connector:t[0]}}),T=new nt({props:{placeId:"ap1",blindsId:"blinds3",blindsDirection:"down",connector:t[0]}}),j=new nt({props:{placeId:"ap1",blindsId:"blinds2",blindsDirection:"down",connector:t[0]}}),D=new nt({props:{placeId:"ap1",blindsId:"blinds1",blindsDirection:"down",connector:t[0]}}),{c(){e=N("div"),n=N("h2"),n.textContent="Rolete",i=U(),r=N("div"),Ee(s.$$.fragment),f=U(),Ee(o.$$.fragment),c=M(`
        \u2014
        `),Ee(a.$$.fragment),u=U(),Ee(_.$$.fragment),b=U(),p=N("div"),Ee(k.$$.fragment),y=U(),Ee(T.$$.fragment),A=M(`
        \u2014
        `),Ee(j.$$.fragment),L=U(),Ee(D.$$.fragment),x(r,"class","iot section svelte-1kxggon"),x(p,"class","iot section svelte-1kxggon"),x(e,"class","blinds_ap1")},m($,ne){E($,e,ne),w(e,n),w(e,i),w(e,r),ke(s,r,null),w(r,f),ke(o,r,null),w(r,c),ke(a,r,null),w(r,u),ke(_,r,null),w(e,b),w(e,p),ke(k,p,null),w(p,y),ke(T,p,null),w(p,A),ke(j,p,null),w(p,L),ke(D,p,null),P=!0},p($,ne){const Q={};ne&1&&(Q.connector=$[0]),s.$set(Q);const G={};ne&1&&(G.connector=$[0]),o.$set(G);const me={};ne&1&&(me.connector=$[0]),a.$set(me);const ze={};ne&1&&(ze.connector=$[0]),_.$set(ze);const qe={};ne&1&&(qe.connector=$[0]),k.$set(qe);const Ye={};ne&1&&(Ye.connector=$[0]),T.$set(Ye);const oe={};ne&1&&(oe.connector=$[0]),j.$set(oe);const Ie={};ne&1&&(Ie.connector=$[0]),D.$set(Ie)},i($){P||(Y(s.$$.fragment,$),Y(o.$$.fragment,$),Y(a.$$.fragment,$),Y(_.$$.fragment,$),Y(k.$$.fragment,$),Y(T.$$.fragment,$),Y(j.$$.fragment,$),Y(D.$$.fragment,$),P=!0)},o($){Z(s.$$.fragment,$),Z(o.$$.fragment,$),Z(a.$$.fragment,$),Z(_.$$.fragment,$),Z(k.$$.fragment,$),Z(T.$$.fragment,$),Z(j.$$.fragment,$),Z(D.$$.fragment,$),P=!1},d($){$&&S(e),Ae(s),Ae(o),Ae(a),Ae(_),Ae(k),Ae(T),Ae(j),Ae(D)}}}function zl(t){let e,n,i,r,s,f,o,c,a,u,_,b,p,k,y,T,A,j,L,D,P,$,ne,Q,G,me,ze,qe,Ye;return s=new nt({props:{placeId:"ap2",blindsId:"blinds6",blindsDirection:"up",connector:t[0]}}),o=new nt({props:{placeId:"ap2",blindsId:"blinds5",blindsDirection:"up",connector:t[0]}}),a=new nt({props:{placeId:"ap2",blindsId:"blinds4",blindsDirection:"up",connector:t[0]}}),_=new nt({props:{placeId:"ap2",blindsId:"blinds3",blindsDirection:"up",connector:t[0]}}),p=new nt({props:{placeId:"ap2",blindsId:"blinds2",blindsDirection:"up",connector:t[0]}}),y=new nt({props:{placeId:"ap2",blindsId:"blinds1",blindsDirection:"up",connector:t[0]}}),j=new nt({props:{placeId:"ap2",blindsId:"blinds6",blindsDirection:"down",connector:t[0]}}),D=new nt({props:{placeId:"ap2",blindsId:"blinds5",blindsDirection:"down",connector:t[0]}}),$=new nt({props:{placeId:"ap2",blindsId:"blinds4",blindsDirection:"down",connector:t[0]}}),Q=new nt({props:{placeId:"ap2",blindsId:"blinds3",blindsDirection:"down",connector:t[0]}}),me=new nt({props:{placeId:"ap2",blindsId:"blinds2",blindsDirection:"down",connector:t[0]}}),qe=new nt({props:{placeId:"ap2",blindsId:"blinds1",blindsDirection:"down",connector:t[0]}}),{c(){e=N("div"),n=N("h2"),n.textContent="Rolete",i=U(),r=N("div"),Ee(s.$$.fragment),f=U(),Ee(o.$$.fragment),c=M(`
        \u2014
        `),Ee(a.$$.fragment),u=U(),Ee(_.$$.fragment),b=M(`
        \u2014
        `),Ee(p.$$.fragment),k=U(),Ee(y.$$.fragment),T=U(),A=N("div"),Ee(j.$$.fragment),L=U(),Ee(D.$$.fragment),P=M(`
        \u2014
        `),Ee($.$$.fragment),ne=U(),Ee(Q.$$.fragment),G=M(`
        \u2014
        `),Ee(me.$$.fragment),ze=U(),Ee(qe.$$.fragment),x(r,"class","iot section svelte-1kxggon"),x(A,"class","iot section svelte-1kxggon"),x(e,"class","blinds_ap2 svelte-1kxggon"),J(e,"visible",Fl)},m(oe,Ie){E(oe,e,Ie),w(e,n),w(e,i),w(e,r),ke(s,r,null),w(r,f),ke(o,r,null),w(r,c),ke(a,r,null),w(r,u),ke(_,r,null),w(r,b),ke(p,r,null),w(r,k),ke(y,r,null),w(e,T),w(e,A),ke(j,A,null),w(A,L),ke(D,A,null),w(A,P),ke($,A,null),w(A,ne),ke(Q,A,null),w(A,G),ke(me,A,null),w(A,ze),ke(qe,A,null),Ye=!0},p(oe,Ie){const ae={};Ie&1&&(ae.connector=oe[0]),s.$set(ae);const Re={};Ie&1&&(Re.connector=oe[0]),o.$set(Re);const mt={};Ie&1&&(mt.connector=oe[0]),a.$set(mt);const tt={};Ie&1&&(tt.connector=oe[0]),_.$set(tt);const Tt={};Ie&1&&(Tt.connector=oe[0]),p.$set(Tt);const gt={};Ie&1&&(gt.connector=oe[0]),y.$set(gt);const wt={};Ie&1&&(wt.connector=oe[0]),j.$set(wt);const it={};Ie&1&&(it.connector=oe[0]),D.$set(it);const rt={};Ie&1&&(rt.connector=oe[0]),$.$set(rt);const ge={};Ie&1&&(ge.connector=oe[0]),Q.$set(ge);const Be={};Ie&1&&(Be.connector=oe[0]),me.$set(Be);const Ct={};Ie&1&&(Ct.connector=oe[0]),qe.$set(Ct)},i(oe){Ye||(Y(s.$$.fragment,oe),Y(o.$$.fragment,oe),Y(a.$$.fragment,oe),Y(_.$$.fragment,oe),Y(p.$$.fragment,oe),Y(y.$$.fragment,oe),Y(j.$$.fragment,oe),Y(D.$$.fragment,oe),Y($.$$.fragment,oe),Y(Q.$$.fragment,oe),Y(me.$$.fragment,oe),Y(qe.$$.fragment,oe),Ye=!0)},o(oe){Z(s.$$.fragment,oe),Z(o.$$.fragment,oe),Z(a.$$.fragment,oe),Z(_.$$.fragment,oe),Z(p.$$.fragment,oe),Z(y.$$.fragment,oe),Z(j.$$.fragment,oe),Z(D.$$.fragment,oe),Z($.$$.fragment,oe),Z(Q.$$.fragment,oe),Z(me.$$.fragment,oe),Z(qe.$$.fragment,oe),Ye=!1},d(oe){oe&&S(e),Ae(s),Ae(o),Ae(a),Ae(_),Ae(p),Ae(y),Ae(j),Ae(D),Ae($),Ae(Q),Ae(me),Ae(qe)}}}function ql(t){let e,n,i,r;const s=[zl,Bl],f=[];function o(c,a){return c[1].deviceName=="tv-ap2"?0:1}return n=o(t),i=f[n]=s[n](t),{c(){e=N("main"),i.c(),x(e,"class","svelte-1kxggon")},m(c,a){E(c,e,a),f[n].m(e,null),r=!0},p(c,[a]){let u=n;n=o(c),n===u?f[n].p(c,a):(_t(),Z(f[u],1,1,()=>{f[u]=null}),ht(),i=f[n],i?i.p(c,a):(i=f[n]=s[n](c),i.c()),Y(i,1),i.m(e,null))},i(c){r||(Y(i),r=!0)},o(c){Z(i),r=!1},d(c){c&&S(e),f[n].d()}}}let Fl=!1;function Yl(t,e,n){let i,r,{connector:s}=e;const{state:f,connected:o}=s;return lt(t,f,c=>n(3,r=c)),t.$$set=c=>{"connector"in c&&n(0,s=c.connector)},t.$$.update=()=>{t.$$.dirty&8&&n(1,i=r.device)},[s,i,f,r]}class Hl extends We{constructor(e){super(),He(this,e,Yl,ql,Fe,{connector:0})}}function Tr(t,e,n){const i=t.slice();return i[3]=e[n],i}function Cr(t){let e,n=t[1].slice(0,4),i=[];for(let r=0;r<n.length;r+=1)i[r]=Or(Tr(t,n,r));return{c(){e=N("div");for(let r=0;r<i.length;r+=1)i[r].c();x(e,"class","notifications svelte-9jalg6")},m(r,s){E(r,e,s);for(let f=0;f<i.length;f+=1)i[f].m(e,null)},p(r,s){if(s&2){n=r[1].slice(0,4);let f;for(f=0;f<n.length;f+=1){const o=Tr(r,n,f);i[f]?i[f].p(o,s):(i[f]=Or(o),i[f].c(),i[f].m(e,null))}for(;f<i.length;f+=1)i[f].d(1);i.length=n.length}},d(r){r&&S(e),Yt(i,r)}}}function Dr(t){let e,n=t[3].title+"",i;return{c(){e=N("div"),i=M(n),x(e,"class","title svelte-9jalg6")},m(r,s){E(r,e,s),w(e,i)},p(r,s){s&2&&n!==(n=r[3].title+"")&&he(i,n)},d(r){r&&S(e)}}}function Or(t){let e,n,i=t[3].msg+"",r,s,f,o=t[3].relativeTimeAdded+"",c,a,u=t[3].title&&Dr(t);return{c(){e=N("div"),u&&u.c(),n=U(),r=M(i),s=U(),f=N("div"),c=M(o),a=U(),x(f,"class","time svelte-9jalg6"),x(e,"class","notification svelte-9jalg6"),wn(e,"color",t[3].color),wn(e,"background-color",t[3].bgColor)},m(_,b){E(_,e,b),u&&u.m(e,null),w(e,n),w(e,r),w(e,s),w(e,f),w(f,c),w(e,a)},p(_,b){_[3].title?u?u.p(_,b):(u=Dr(_),u.c(),u.m(e,n)):u&&(u.d(1),u=null),b&2&&i!==(i=_[3].msg+"")&&he(r,i),b&2&&o!==(o=_[3].relativeTimeAdded+"")&&he(c,o),b&2&&wn(e,"color",_[3].color),b&2&&wn(e,"background-color",_[3].bgColor)},d(_){_&&S(e),u&&u.d()}}}function Wl(t){let e,n=t[1]&&t[1].length&&Cr(t);return{c(){n&&n.c(),e=ft()},m(i,r){n&&n.m(i,r),E(i,e,r)},p(i,[r]){i[1]&&i[1].length?n?n.p(i,r):(n=Cr(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:V,o:V,d(i){n&&n.d(i),i&&S(e)}}}function Jl(t,e,n){let i,r,s=V,f=()=>(s(),s=bt(o,c=>n(2,r=c)),o);t.$$.on_destroy.push(()=>s());let{store:o}=e;return f(),t.$$set=c=>{"store"in c&&f(n(0,o=c.store))},t.$$.update=()=>{t.$$.dirty&4&&n(1,i=r.notifications.slice().reverse())},[o,i,r]}class Zl extends We{constructor(e){super(),He(this,e,Jl,Wl,Fe,{store:0})}}const kt=Et([]);kt.LIMIT=300;kt.log=(t,{dedup:e=!1}={})=>{kt.update(n=>(e&&n.length>0&&n[n.length-1].entry==t&&n.pop(),n.push({entry:t,createdDate:new Date,createdAt:Date.now(),isRecent:!0,isVeryRecent:!0}),n.slice(-kt.LIMIT)))};function ms(){const t=Date.now();kt.update(e=>{for(const n of e)n.isRecent=t-n.createdAt<6e4,n.isVeryRecent=t-n.createdAt<5e3;return e}),setTimeout(ms,1e3)}ms();function Nr(t,e,n){const i=t.slice();return i[11]=e[n].time,i[12]=e[n].entry,i[13]=e[n].isRecent,i[14]=e[n].isVeryRecent,i[15]=e[n].createdAt,i[17]=n,i}function xr(t){let e,n;return{c(){e=N("h2"),n=M(t[0]),x(e,"class","title svelte-19k2gjn")},m(i,r){E(i,e,r),w(e,n)},p(i,r){r&1&&he(n,i[0])},d(i){i&&S(e)}}}function Gl(t){let e,n,i;return{c(){e=N("button"),e.textContent="Show Log",x(e,"class","svelte-19k2gjn")},m(r,s){E(r,e,s),n||(i=ce(e,"click",t[8]),n=!0)},p:V,i:V,o:V,d(r){r&&S(e),n=!1,i()}}}function Vl(t){let e,n,i;const r=t[7].default,s=Jr(r,t,t[6],null);let f=t[2].map(Ir),o=[];for(let c=0;c<f.length;c+=1)o[c]=Rr(Nr(t,f,c));return{c(){s&&s.c(),e=U();for(let c=0;c<o.length;c+=1)o[c].c();n=ft()},m(c,a){s&&s.m(c,a),E(c,e,a);for(let u=0;u<o.length;u+=1)o[u].m(c,a);E(c,n,a),i=!0},p(c,a){if(s&&s.p&&(!i||a&64)&&Vr(s,r,c,c[6],i?Gr(r,c[6],a,null):Qr(c[6]),null),a&4){f=c[2].map(Ir);let u;for(u=0;u<f.length;u+=1){const _=Nr(c,f,u);o[u]?o[u].p(_,a):(o[u]=Rr(_),o[u].c(),o[u].m(n.parentNode,n))}for(;u<o.length;u+=1)o[u].d(1);o.length=f.length}},i(c){i||(Y(s,c),i=!0)},o(c){Z(s,c),i=!1},d(c){s&&s.d(c),c&&S(e),Yt(o,c),c&&S(n)}}}function Ql(t){let e=t[11]+"",n;return{c(){n=M(e)},m(i,r){E(i,n,r)},p(i,r){r&4&&e!==(e=i[11]+"")&&he(n,e)},d(i){i&&S(n)}}}function Xl(t){let e;function n(s,f){return s[15]-s[2][s[17]+1].createdAt<1e4?to:eo}let i=n(t),r=i(t);return{c(){r.c(),e=ft()},m(s,f){r.m(s,f),E(s,e,f)},p(s,f){i===(i=n(s))&&r?r.p(s,f):(r.d(1),r=i(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&S(e)}}}function eo(t){let e=t[11]+"",n;return{c(){n=M(e)},m(i,r){E(i,n,r)},p(i,r){r&4&&e!==(e=i[11]+"")&&he(n,e)},d(i){i&&S(n)}}}function to(t){let e,n,i=t[15]-t[2][t[17]+1].createdAt+"",r,s;return{c(){e=N("span"),n=M("+"),r=M(i),s=M("ms"),x(e,"class","diff svelte-19k2gjn")},m(f,o){E(f,e,o),w(e,n),w(e,r),w(e,s)},p(f,o){o&4&&i!==(i=f[15]-f[2][f[17]+1].createdAt+"")&&he(r,i)},d(f){f&&S(e)}}}function Rr(t){let e,n,i,r=t[12]+"",s,f;function o(u,_){return u[17]<u[2].length-1?Xl:Ql}let c=o(t),a=c(t);return{c(){e=N("div"),n=N("span"),a.c(),i=U(),s=M(r),f=U(),x(n,"class","time svelte-19k2gjn"),x(e,"class","log_entry svelte-19k2gjn"),J(e,"recent",t[13]),J(e,"very_recent",t[14])},m(u,_){E(u,e,_),w(e,n),a.m(n,null),w(e,i),w(e,s),w(e,f)},p(u,_){c===(c=o(u))&&a?a.p(u,_):(a.d(1),a=c(u),a&&(a.c(),a.m(n,null))),_&4&&r!==(r=u[12]+"")&&he(s,r),_&4&&J(e,"recent",u[13]),_&4&&J(e,"very_recent",u[14])},d(u){u&&S(e),a.d()}}}function no(t){let e,n,i,r,s,f=t[0]&&xr(t);const o=[Vl,Gl],c=[];function a(u,_){return u[1]?0:1}return i=a(t),r=c[i]=o[i](t),{c(){e=N("div"),f&&f.c(),n=U(),r.c(),x(e,"class","logview svelte-19k2gjn")},m(u,_){E(u,e,_),f&&f.m(e,null),w(e,n),c[i].m(e,null),s=!0},p(u,[_]){u[0]?f?f.p(u,_):(f=xr(u),f.c(),f.m(e,n)):f&&(f.d(1),f=null);let b=i;i=a(u),i===b?c[i].p(u,_):(_t(),Z(c[b],1,1,()=>{c[b]=null}),ht(),r=c[i],r?r.p(u,_):(r=c[i]=o[i](u),r.c()),Y(r,1),r.m(e,null))},i(u){s||(Y(r),s=!0)},o(u){Z(r),s=!1},d(u){u&&S(e),f&&f.d(),c[i].d()}}}const Ir=t=>{const e=t.createdDate.toLocaleString().split(",")[1];return{...t,time:e}};function io(t,e,n){let i,r;lt(t,kt,k=>n(5,r=k));let{$$slots:s={},$$scope:f}=e,{showLogInitially:o=!0}=e,{title:c}=e,{limit:a=0}=e;a>kt.LIMIT&&(console.log(`Warning: provided LogView line limit (${a}) is larger than logStore limit  (${kt.LIMIT})`),console.log("Utilizing the lower value ..."),a=kt.LIMIT);let u=o,_;function b(){const k=Date.now();_&&k-_>500&&kt.log("\u2014\u2014\u2014 Context switch / App wake \u2014\u2014\u2014",{dedup:!0}),_=k,setTimeout(b,300)}b();const p=()=>{n(1,u=!0)};return t.$$set=k=>{"showLogInitially"in k&&n(4,o=k.showLogInitially),"title"in k&&n(0,c=k.title),"limit"in k&&n(3,a=k.limit),"$$scope"in k&&n(6,f=k.$$scope)},t.$$.update=()=>{t.$$.dirty&40&&n(2,i=r.slice(-a).reverse())},[c,u,i,a,o,r,f,s,p]}class ps extends We{constructor(e){super(),He(this,e,io,no,Fe,{showLogInitially:4,title:0,limit:3})}}function ro(t){let e,n,i,r,s;return{c(){e=N("div"),n=N("span"),n.textContent="DMT",i=U(),r=N("span"),s=M(t[0]),x(n,"class","dmt svelte-c00wah"),x(r,"class","app svelte-c00wah")},m(f,o){E(f,e,o),w(e,n),w(e,i),w(e,r),w(r,s)},p(f,[o]){o&1&&he(s,f[0])},i:V,o:V,d(f){f&&S(e)}}}function so(t,e,n){let{dmtApp:i}=e;return t.$$set=r=>{"dmtApp"in r&&n(0,i=r.dmtApp)},[i]}class fo extends We{constructor(e){super(),He(this,e,so,ro,Fe,{dmtApp:0})}}function lo(t){let e,n,i,r,s,f,o=".".repeat(t[1])+"",c,a,u,_,b;n=new fo({props:{dmtApp:t[0]}});const p=t[3].default,k=Jr(p,t,t[2],null);return{c(){e=N("div"),Ee(n.$$.fragment),i=U(),r=N("p"),s=M("Connecting "),f=N("span"),c=M(o),a=U(),k&&k.c(),x(f,"class","svelte-1afk0eu"),x(r,"class","svelte-1afk0eu"),x(e,"class","wrapper svelte-1afk0eu")},m(y,T){E(y,e,T),ke(n,e,null),w(e,i),w(e,r),w(r,s),w(r,f),w(f,c),w(e,a),k&&k.m(e,null),b=!0},p(y,[T]){const A={};T&1&&(A.dmtApp=y[0]),n.$set(A),(!b||T&2)&&o!==(o=".".repeat(y[1])+"")&&he(c,o),k&&k.p&&(!b||T&4)&&Vr(k,p,y,y[2],b?Gr(p,y[2],T,null):Qr(y[2]),null)},i(y){b||(Y(n.$$.fragment,y),Y(k,y),pt(()=>{_&&_.end(1),u=Pt(e,jt,{}),u.start()}),b=!0)},o(y){Z(n.$$.fragment,y),Z(k,y),u&&u.invalidate(),_=of(e,jt,{}),b=!1},d(y){y&&S(e),Ae(n),k&&k.d(y),y&&_&&_.end()}}}const oo=5;function co(t,e,n){let{$$slots:i={},$$scope:r}=e,{dmtApp:s}=e,f=1,o=!0;return rf(()=>{const c=setInterval(()=>{n(1,f=f+(o?1:-1)),f==oo&&(o=!1),f==1&&(o=!0)},500);return()=>clearInterval(c)}),t.$$set=c=>{"dmtApp"in c&&n(0,s=c.dmtApp),"$$scope"in c&&n(2,r=c.$$scope)},[s,f,r,i]}class ao extends We{constructor(e){super(),He(this,e,co,lo,Fe,{dmtApp:0})}}function Pr(t,e,n){const i=t.slice();return i[2]=e[n],i}function Mr(t){let e,n=t[1].errors.slice(0,3),i=[];for(let r=0;r<n.length;r+=1)i[r]=Ur(Pr(t,n,r));return{c(){e=N("div");for(let r=0;r<i.length;r+=1)i[r].c();x(e,"class","errors svelte-173xjbh")},m(r,s){E(r,e,s);for(let f=0;f<i.length;f+=1)i[f].m(e,null)},p(r,s){if(s&2){n=r[1].errors.slice(0,3);let f;for(f=0;f<n.length;f+=1){const o=Pr(r,n,f);i[f]?i[f].p(o,s):(i[f]=Ur(o),i[f].c(),i[f].m(e,null))}for(;f<i.length;f+=1)i[f].d(1);i.length=n.length}},d(r){r&&S(e),Yt(i,r)}}}function Lr(t){let e=t[2].stacktrace+"",n;return{c(){n=M(e)},m(i,r){E(i,n,r)},p(i,r){r&2&&e!==(e=i[2].stacktrace+"")&&he(n,e)},d(i){i&&S(n)}}}function Ur(t){let e,n,i,r,s,f=t[2].time+"",o,c,a,u=t[2].msg+"",_,b,p,k=t[2].stacktrace&&Lr(t);return{c(){e=N("div"),n=N("div"),i=N("span"),r=M("\u26A0\uFE0F Error at "),s=N("span"),o=M(f),c=U(),a=N("span"),_=M(u),b=U(),k&&k.c(),p=U(),x(s,"class","time svelte-173xjbh"),x(i,"class","title svelte-173xjbh"),x(a,"class","msg svelte-173xjbh"),x(n,"class","header svelte-173xjbh"),x(e,"class","error svelte-173xjbh"),J(e,"cors_problem",t[2].corsProblem)},m(y,T){E(y,e,T),w(e,n),w(n,i),w(i,r),w(i,s),w(s,o),w(n,c),w(n,a),w(a,_),w(e,b),k&&k.m(e,null),w(e,p)},p(y,T){T&2&&f!==(f=y[2].time+"")&&he(o,f),T&2&&u!==(u=y[2].msg+"")&&he(_,u),y[2].stacktrace?k?k.p(y,T):(k=Lr(y),k.c(),k.m(e,p)):k&&(k.d(1),k=null),T&2&&J(e,"cors_problem",y[2].corsProblem)},d(y){y&&S(e),k&&k.d()}}}function uo(t){var i;let e,n=((i=t[1])==null?void 0:i.errors.length)&&Mr(t);return{c(){n&&n.c(),e=ft()},m(r,s){n&&n.m(r,s),E(r,e,s)},p(r,[s]){var f;(f=r[1])!=null&&f.errors.length?n?n.p(r,s):(n=Mr(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:V,o:V,d(r){n&&n.d(r),r&&S(e)}}}function _o(t,e,n){let i,r=V,s=()=>(r(),r=bt(f,o=>n(1,i=o)),f);t.$$.on_destroy.push(()=>r());let{errorStore:f}=e;return s(),t.$$set=o=>{"errorStore"in o&&s(n(0,f=o.errorStore))},[f,i]}class ho extends We{constructor(e){super(),He(this,e,_o,uo,Fe,{errorStore:0})}}function bo({store:t,action:e,payload:n}){console.log(`Action: ${e}`),t.signal("action",{action:e,namespace:"player",payload:n})}function mo(t){let e,n;return e=new ao({props:{dmtApp:"Mobile",$$slots:{default:[vo]},$$scope:{ctx:t}}}),{c(){Ee(e.$$.fragment)},m(i,r){ke(e,i,r),n=!0},p(i,r){const s={};r&131072&&(s.$$scope={dirty:r,ctx:i}),e.$set(s)},i(i){n||(Y(e.$$.fragment,i),n=!0)},o(i){Z(e.$$.fragment,i),n=!1},d(i){Ae(e,i)}}}function po(t){let e,n,i,r,s,f,o,c,a=(t[2].deviceKey=="ed4f0a8f470b3024f25c60a54cf832584c2c16081f364fabebc77186ae11d626"||t[2].deviceName=="turbine")&&jr(t),u=t[2].network=="zaboric"&&$r(t),_=t[2].deviceName!="tv-ap2"&&Kr(t);r=new gf({props:{connected:t[9],device:t[3],nearbyDevices:t[6],deviceName:t[8],activeDeviceKey:t[5],player:t[7]}});let b=t[2].deviceName!="tv-ap2"&&Br(t);return o=new gl({props:{connected:t[9],player:t[7],deviceName:t[8],store:t[0],fnAction:t[12]}}),{c(){a&&a.c(),e=U(),u&&u.c(),n=U(),_&&_.c(),i=U(),Ee(r.$$.fragment),s=U(),b&&b.c(),f=U(),Ee(o.$$.fragment)},m(p,k){a&&a.m(p,k),E(p,e,k),u&&u.m(p,k),E(p,n,k),_&&_.m(p,k),E(p,i,k),ke(r,p,k),E(p,s,k),b&&b.m(p,k),E(p,f,k),ke(o,p,k),c=!0},p(p,k){p[2].deviceKey=="ed4f0a8f470b3024f25c60a54cf832584c2c16081f364fabebc77186ae11d626"||p[2].deviceName=="turbine"?a?(a.p(p,k),k&4&&Y(a,1)):(a=jr(p),a.c(),Y(a,1),a.m(e.parentNode,e)):a&&(_t(),Z(a,1,1,()=>{a=null}),ht()),p[2].network=="zaboric"?u?(u.p(p,k),k&4&&Y(u,1)):(u=$r(p),u.c(),Y(u,1),u.m(n.parentNode,n)):u&&(_t(),Z(u,1,1,()=>{u=null}),ht()),p[2].deviceName!="tv-ap2"?_?(_.p(p,k),k&4&&Y(_,1)):(_=Kr(p),_.c(),Y(_,1),_.m(i.parentNode,i)):_&&(_t(),Z(_,1,1,()=>{_=null}),ht());const y={};k&8&&(y.device=p[3]),k&64&&(y.nearbyDevices=p[6]),k&256&&(y.deviceName=p[8]),k&32&&(y.activeDeviceKey=p[5]),k&128&&(y.player=p[7]),r.$set(y),p[2].deviceName!="tv-ap2"?b?(b.p(p,k),k&4&&Y(b,1)):(b=Br(p),b.c(),Y(b,1),b.m(f.parentNode,f)):b&&(_t(),Z(b,1,1,()=>{b=null}),ht());const T={};k&128&&(T.player=p[7]),k&256&&(T.deviceName=p[8]),k&1&&(T.store=p[0]),o.$set(T)},i(p){c||(Y(a),Y(u),Y(_),Y(r.$$.fragment,p),Y(b),Y(o.$$.fragment,p),c=!0)},o(p){Z(a),Z(u),Z(_),Z(r.$$.fragment,p),Z(b),Z(o.$$.fragment,p),c=!1},d(p){a&&a.d(p),p&&S(e),u&&u.d(p),p&&S(n),_&&_.d(p),p&&S(i),Ae(r,p),p&&S(s),b&&b.d(p),p&&S(f),Ae(o,p)}}}function vo(t){let e,n;return e=new ps({props:{showLogInitially:!0,limit:20}}),{c(){Ee(e.$$.fragment)},m(i,r){ke(e,i,r),n=!0},p:V,i(i){n||(Y(e.$$.fragment,i),n=!0)},o(i){Z(e.$$.fragment,i),n=!1},d(i){Ae(e,i)}}}function jr(t){let e,n;return e=new jl({props:{connector:t[10],store:t[0],localDevice:t[2],nearbyDevices:t[6]}}),{c(){Ee(e.$$.fragment)},m(i,r){ke(e,i,r),n=!0},p(i,r){const s={};r&1&&(s.store=i[0]),r&4&&(s.localDevice=i[2]),r&64&&(s.nearbyDevices=i[6]),e.$set(s)},i(i){n||(Y(e.$$.fragment,i),n=!0)},o(i){Z(e.$$.fragment,i),n=!1},d(i){Ae(e,i)}}}function $r(t){let e,n;return e=new Hl({props:{connector:t[10]}}),{c(){Ee(e.$$.fragment)},m(i,r){ke(e,i,r),n=!0},p:V,i(i){n||(Y(e.$$.fragment,i),n=!0)},o(i){Z(e.$$.fragment,i),n=!1},d(i){Ae(e,i)}}}function Kr(t){let e,n;return e=new Zl({props:{store:t[0]}}),{c(){Ee(e.$$.fragment)},m(i,r){ke(e,i,r),n=!0},p(i,r){const s={};r&1&&(s.store=i[0]),e.$set(s)},i(i){n||(Y(e.$$.fragment,i),n=!0)},o(i){Z(e.$$.fragment,i),n=!1},d(i){Ae(e,i)}}}function Br(t){let e,n;return e=new Al({props:{nearbyDevices:t[6],activeDeviceKey:t[5],store:t[0],log:t[1]}}),{c(){Ee(e.$$.fragment)},m(i,r){ke(e,i,r),n=!0},p(i,r){const s={};r&64&&(s.nearbyDevices=i[6]),r&32&&(s.activeDeviceKey=i[5]),r&1&&(s.store=i[0]),r&2&&(s.log=i[1]),e.$set(s)},i(i){n||(Y(e.$$.fragment,i),n=!0)},o(i){Z(e.$$.fragment,i),n=!1},d(i){Ae(e,i)}}}function zr(t){let e,n;return e=new ps({props:{title:"Connectivity log",limit:200,showLogInitially:!1,$$slots:{default:[yo]},$$scope:{ctx:t}}}),{c(){Ee(e.$$.fragment)},m(i,r){ke(e,i,r),n=!0},p(i,r){const s={};r&131088&&(s.$$scope={dirty:r,ctx:i}),e.$set(s)},i(i){n||(Y(e.$$.fragment,i),n=!0)},o(i){Z(e.$$.fragment,i),n=!1},d(i){Ae(e,i)}}}function yo(t){let e,n,i,r,s,f,o;return{c(){e=N("p"),n=M("Gui active: "),i=N("span"),r=M(t[4]),s=M("s"),f=U(),o=N("span"),o.textContent="[ also indicates that this app is processing events ]",x(i,"class","svelte-gx051d"),x(o,"class","small svelte-gx051d"),x(e,"class","logview_counter svelte-gx051d")},m(c,a){E(c,e,a),w(e,n),w(e,i),w(i,r),w(i,s),w(e,f),w(e,o)},p(c,a){a&16&&he(r,c[4])},d(c){c&&S(e)}}}function go(t){let e,n,i,r,s,f,o;n=new ho({props:{errorStore:us}});const c=[po,mo],a=[];function u(b,p){return b[2]?0:1}r=u(t),s=a[r]=c[r](t);let _=t[2]&&zr(t);return{c(){e=N("main"),Ee(n.$$.fragment),i=U(),s.c(),f=U(),_&&_.c(),x(e,"class","svelte-gx051d")},m(b,p){E(b,e,p),ke(n,e,null),w(e,i),a[r].m(e,null),w(e,f),_&&_.m(e,null),o=!0},p(b,[p]){let k=r;r=u(b),r===k?a[r].p(b,p):(_t(),Z(a[k],1,1,()=>{a[k]=null}),ht(),s=a[r],s?s.p(b,p):(s=a[r]=c[r](b),s.c()),Y(s,1),s.m(e,f)),b[2]?_?(_.p(b,p),p&4&&Y(_,1)):(_=zr(b),_.c(),Y(_,1),_.m(e,null)):_&&(_t(),Z(_,1,1,()=>{_=null}),ht())},i(b){o||(Y(n.$$.fragment,b),Y(s),Y(_),o=!0)},o(b){Z(n.$$.fragment,b),Z(s),Z(_),o=!1},d(b){b&&S(e),Ae(n),a[r].d(),_&&_.d()}}}function wo(t,e,n){let i,r,s,f,o,c,a,u=V,_=()=>(u(),u=bt(p,P=>n(13,a=P)),p),b;t.$$.on_destroy.push(()=>u());let{store:p}=e;_();let{log:k}=e;const{connected:y,localConnector:T}=p,{state:A}=T;lt(t,A,P=>n(14,b=P));function j(P,$){hs(),bo({store:p,action:P,payload:$})}A.subscribe(P=>{var ne;const $=(ne=P==null?void 0:P.device)==null?void 0:ne.network;ds.set(["zaboric","borovnjakova"].includes($))});let L=0;function D(){n(4,L+=1),setTimeout(D,1e3)}return D(),t.$$set=P=>{"store"in P&&_(n(0,p=P.store)),"log"in P&&n(1,k=P.log)},t.$$.update=()=>{t.$$.dirty&8192&&n(3,i=a.device),t.$$.dirty&8192&&n(8,r=a.optimisticDeviceName),t.$$.dirty&16384&&n(2,s=b.device),t.$$.dirty&4&&(s==null||s.devMachine),t.$$.dirty&8192&&n(7,f=a.player||{}),t.$$.dirty&8192&&n(6,o=a.nearbyDevices?a.nearbyDevices.filter(P=>P.hasGui).sort(hf("deviceName")):[]),t.$$.dirty&8192&&n(5,c=a.activeDeviceKey)},[p,k,s,i,L,c,o,f,r,y,T,A,j,a,b]}class ko extends We{constructor(e){super(),He(this,e,wo,go,Fe,{store:0,log:1})}}function Ao(){}class Zn{constructor(e,n,i){this.prev=e,this.next=n,this.fn=i||Ao}run(e){this.fn(e),this.next&&this.next.run(e)}}class So{constructor(e){this.head=new Zn,this.tail=new Zn(this.head),this.head.next=this.tail,this.linkConstructor=e,this.reg={}}insert(e){const n=new Zn(this.tail.prev,this.tail,e);return n.next.prev=n,n.prev.next=n,n}remove(e){e.prev.next=e.next,e.next.prev=e.prev}}let Eo=0;class Mn{constructor(){this.__events_list={}}on(e,n){const i=this.__events_list[e]||(this.__events_list[e]=new So),r=n._eev||(n._eev=++Eo);i.reg[r]||(i.reg[r]=i.insert(n))}off(e,n){if(n){const i=this.__events_list[e];if(!i)return;const r=i.reg[n._eev];i.reg[n._eev]=void 0,i&&r&&i.remove(r)}}removeListener(...e){this.off(...e)}emit(e,n){const i=this.__events_list[e];i&&i.head.run(n)}}class To extends Mn{constructor(e){super(),this.state=e,this.subscriptions=[]}get(){return this.state}subscribe(e){return this.subscriptions.push(e),e(this.state),()=>{this.subscriptions=this.subscriptions.filter(n=>n!==e)}}announceStateChange(){this.subscriptions.forEach(e=>e(this.state))}}class en extends To{set(e){this.state=e,this.announceStateChange()}}class Co extends en{constructor(e={}){super(e)}set(e,{ignore:n=[]}={}){const i={};for(const r of n)i[r]=this.state[r];super.set({...e,...i})}setMerge(e){super.set({...this.state,...e})}clearState({except:e=[]}={}){for(const n of Object.keys(this.state))e.includes(n)||delete this.state[n]}}var Do=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function vs(t,e,n){return n={path:e,exports:{},require:function(i,r){return ys(i,r==null?n.path:r)}},t(n,n.exports),n.exports}function Oo(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),e}function ys(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var No={},xo=Object.freeze({__proto__:null,default:No}),Ro=Oo(xo),At=vs(function(t){(function(e){var n=function(d){var m,h=new Float64Array(16);if(d)for(m=0;m<d.length;m++)h[m]=d[m];return h},i=function(){throw new Error("no PRNG")},r=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var f=n(),o=n([1]),c=n([56129,1]),a=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),u=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),b=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function k(d,m,h,l){d[m]=h>>24&255,d[m+1]=h>>16&255,d[m+2]=h>>8&255,d[m+3]=h&255,d[m+4]=l>>24&255,d[m+5]=l>>16&255,d[m+6]=l>>8&255,d[m+7]=l&255}function y(d,m,h,l,v){var C,O=0;for(C=0;C<v;C++)O|=d[m+C]^h[l+C];return(1&O-1>>>8)-1}function T(d,m,h,l){return y(d,m,h,l,16)}function A(d,m,h,l){return y(d,m,h,l,32)}function j(d,m,h,l){for(var v=l[0]&255|(l[1]&255)<<8|(l[2]&255)<<16|(l[3]&255)<<24,C=h[0]&255|(h[1]&255)<<8|(h[2]&255)<<16|(h[3]&255)<<24,O=h[4]&255|(h[5]&255)<<8|(h[6]&255)<<16|(h[7]&255)<<24,B=h[8]&255|(h[9]&255)<<8|(h[10]&255)<<16|(h[11]&255)<<24,W=h[12]&255|(h[13]&255)<<8|(h[14]&255)<<16|(h[15]&255)<<24,le=l[4]&255|(l[5]&255)<<8|(l[6]&255)<<16|(l[7]&255)<<24,ee=m[0]&255|(m[1]&255)<<8|(m[2]&255)<<16|(m[3]&255)<<24,Le=m[4]&255|(m[5]&255)<<8|(m[6]&255)<<16|(m[7]&255)<<24,ie=m[8]&255|(m[9]&255)<<8|(m[10]&255)<<16|(m[11]&255)<<24,be=m[12]&255|(m[13]&255)<<8|(m[14]&255)<<16|(m[15]&255)<<24,pe=l[8]&255|(l[9]&255)<<8|(l[10]&255)<<16|(l[11]&255)<<24,Te=h[16]&255|(h[17]&255)<<8|(h[18]&255)<<16|(h[19]&255)<<24,Se=h[20]&255|(h[21]&255)<<8|(h[22]&255)<<16|(h[23]&255)<<24,ve=h[24]&255|(h[25]&255)<<8|(h[26]&255)<<16|(h[27]&255)<<24,we=h[28]&255|(h[29]&255)<<8|(h[30]&255)<<16|(h[31]&255)<<24,ye=l[12]&255|(l[13]&255)<<8|(l[14]&255)<<16|(l[15]&255)<<24,re=v,ue=C,te=O,se=B,fe=W,X=le,R=ee,I=Le,F=ie,K=be,z=pe,H=Te,_e=Se,Ce=ve,Oe=we,De=ye,g,xe=0;xe<20;xe+=2)g=re+_e|0,fe^=g<<7|g>>>32-7,g=fe+re|0,F^=g<<9|g>>>32-9,g=F+fe|0,_e^=g<<13|g>>>32-13,g=_e+F|0,re^=g<<18|g>>>32-18,g=X+ue|0,K^=g<<7|g>>>32-7,g=K+X|0,Ce^=g<<9|g>>>32-9,g=Ce+K|0,ue^=g<<13|g>>>32-13,g=ue+Ce|0,X^=g<<18|g>>>32-18,g=z+R|0,Oe^=g<<7|g>>>32-7,g=Oe+z|0,te^=g<<9|g>>>32-9,g=te+Oe|0,R^=g<<13|g>>>32-13,g=R+te|0,z^=g<<18|g>>>32-18,g=De+H|0,se^=g<<7|g>>>32-7,g=se+De|0,I^=g<<9|g>>>32-9,g=I+se|0,H^=g<<13|g>>>32-13,g=H+I|0,De^=g<<18|g>>>32-18,g=re+se|0,ue^=g<<7|g>>>32-7,g=ue+re|0,te^=g<<9|g>>>32-9,g=te+ue|0,se^=g<<13|g>>>32-13,g=se+te|0,re^=g<<18|g>>>32-18,g=X+fe|0,R^=g<<7|g>>>32-7,g=R+X|0,I^=g<<9|g>>>32-9,g=I+R|0,fe^=g<<13|g>>>32-13,g=fe+I|0,X^=g<<18|g>>>32-18,g=z+K|0,H^=g<<7|g>>>32-7,g=H+z|0,F^=g<<9|g>>>32-9,g=F+H|0,K^=g<<13|g>>>32-13,g=K+F|0,z^=g<<18|g>>>32-18,g=De+Oe|0,_e^=g<<7|g>>>32-7,g=_e+De|0,Ce^=g<<9|g>>>32-9,g=Ce+_e|0,Oe^=g<<13|g>>>32-13,g=Oe+Ce|0,De^=g<<18|g>>>32-18;re=re+v|0,ue=ue+C|0,te=te+O|0,se=se+B|0,fe=fe+W|0,X=X+le|0,R=R+ee|0,I=I+Le|0,F=F+ie|0,K=K+be|0,z=z+pe|0,H=H+Te|0,_e=_e+Se|0,Ce=Ce+ve|0,Oe=Oe+we|0,De=De+ye|0,d[0]=re>>>0&255,d[1]=re>>>8&255,d[2]=re>>>16&255,d[3]=re>>>24&255,d[4]=ue>>>0&255,d[5]=ue>>>8&255,d[6]=ue>>>16&255,d[7]=ue>>>24&255,d[8]=te>>>0&255,d[9]=te>>>8&255,d[10]=te>>>16&255,d[11]=te>>>24&255,d[12]=se>>>0&255,d[13]=se>>>8&255,d[14]=se>>>16&255,d[15]=se>>>24&255,d[16]=fe>>>0&255,d[17]=fe>>>8&255,d[18]=fe>>>16&255,d[19]=fe>>>24&255,d[20]=X>>>0&255,d[21]=X>>>8&255,d[22]=X>>>16&255,d[23]=X>>>24&255,d[24]=R>>>0&255,d[25]=R>>>8&255,d[26]=R>>>16&255,d[27]=R>>>24&255,d[28]=I>>>0&255,d[29]=I>>>8&255,d[30]=I>>>16&255,d[31]=I>>>24&255,d[32]=F>>>0&255,d[33]=F>>>8&255,d[34]=F>>>16&255,d[35]=F>>>24&255,d[36]=K>>>0&255,d[37]=K>>>8&255,d[38]=K>>>16&255,d[39]=K>>>24&255,d[40]=z>>>0&255,d[41]=z>>>8&255,d[42]=z>>>16&255,d[43]=z>>>24&255,d[44]=H>>>0&255,d[45]=H>>>8&255,d[46]=H>>>16&255,d[47]=H>>>24&255,d[48]=_e>>>0&255,d[49]=_e>>>8&255,d[50]=_e>>>16&255,d[51]=_e>>>24&255,d[52]=Ce>>>0&255,d[53]=Ce>>>8&255,d[54]=Ce>>>16&255,d[55]=Ce>>>24&255,d[56]=Oe>>>0&255,d[57]=Oe>>>8&255,d[58]=Oe>>>16&255,d[59]=Oe>>>24&255,d[60]=De>>>0&255,d[61]=De>>>8&255,d[62]=De>>>16&255,d[63]=De>>>24&255}function L(d,m,h,l){for(var v=l[0]&255|(l[1]&255)<<8|(l[2]&255)<<16|(l[3]&255)<<24,C=h[0]&255|(h[1]&255)<<8|(h[2]&255)<<16|(h[3]&255)<<24,O=h[4]&255|(h[5]&255)<<8|(h[6]&255)<<16|(h[7]&255)<<24,B=h[8]&255|(h[9]&255)<<8|(h[10]&255)<<16|(h[11]&255)<<24,W=h[12]&255|(h[13]&255)<<8|(h[14]&255)<<16|(h[15]&255)<<24,le=l[4]&255|(l[5]&255)<<8|(l[6]&255)<<16|(l[7]&255)<<24,ee=m[0]&255|(m[1]&255)<<8|(m[2]&255)<<16|(m[3]&255)<<24,Le=m[4]&255|(m[5]&255)<<8|(m[6]&255)<<16|(m[7]&255)<<24,ie=m[8]&255|(m[9]&255)<<8|(m[10]&255)<<16|(m[11]&255)<<24,be=m[12]&255|(m[13]&255)<<8|(m[14]&255)<<16|(m[15]&255)<<24,pe=l[8]&255|(l[9]&255)<<8|(l[10]&255)<<16|(l[11]&255)<<24,Te=h[16]&255|(h[17]&255)<<8|(h[18]&255)<<16|(h[19]&255)<<24,Se=h[20]&255|(h[21]&255)<<8|(h[22]&255)<<16|(h[23]&255)<<24,ve=h[24]&255|(h[25]&255)<<8|(h[26]&255)<<16|(h[27]&255)<<24,we=h[28]&255|(h[29]&255)<<8|(h[30]&255)<<16|(h[31]&255)<<24,ye=l[12]&255|(l[13]&255)<<8|(l[14]&255)<<16|(l[15]&255)<<24,re=v,ue=C,te=O,se=B,fe=W,X=le,R=ee,I=Le,F=ie,K=be,z=pe,H=Te,_e=Se,Ce=ve,Oe=we,De=ye,g,xe=0;xe<20;xe+=2)g=re+_e|0,fe^=g<<7|g>>>32-7,g=fe+re|0,F^=g<<9|g>>>32-9,g=F+fe|0,_e^=g<<13|g>>>32-13,g=_e+F|0,re^=g<<18|g>>>32-18,g=X+ue|0,K^=g<<7|g>>>32-7,g=K+X|0,Ce^=g<<9|g>>>32-9,g=Ce+K|0,ue^=g<<13|g>>>32-13,g=ue+Ce|0,X^=g<<18|g>>>32-18,g=z+R|0,Oe^=g<<7|g>>>32-7,g=Oe+z|0,te^=g<<9|g>>>32-9,g=te+Oe|0,R^=g<<13|g>>>32-13,g=R+te|0,z^=g<<18|g>>>32-18,g=De+H|0,se^=g<<7|g>>>32-7,g=se+De|0,I^=g<<9|g>>>32-9,g=I+se|0,H^=g<<13|g>>>32-13,g=H+I|0,De^=g<<18|g>>>32-18,g=re+se|0,ue^=g<<7|g>>>32-7,g=ue+re|0,te^=g<<9|g>>>32-9,g=te+ue|0,se^=g<<13|g>>>32-13,g=se+te|0,re^=g<<18|g>>>32-18,g=X+fe|0,R^=g<<7|g>>>32-7,g=R+X|0,I^=g<<9|g>>>32-9,g=I+R|0,fe^=g<<13|g>>>32-13,g=fe+I|0,X^=g<<18|g>>>32-18,g=z+K|0,H^=g<<7|g>>>32-7,g=H+z|0,F^=g<<9|g>>>32-9,g=F+H|0,K^=g<<13|g>>>32-13,g=K+F|0,z^=g<<18|g>>>32-18,g=De+Oe|0,_e^=g<<7|g>>>32-7,g=_e+De|0,Ce^=g<<9|g>>>32-9,g=Ce+_e|0,Oe^=g<<13|g>>>32-13,g=Oe+Ce|0,De^=g<<18|g>>>32-18;d[0]=re>>>0&255,d[1]=re>>>8&255,d[2]=re>>>16&255,d[3]=re>>>24&255,d[4]=X>>>0&255,d[5]=X>>>8&255,d[6]=X>>>16&255,d[7]=X>>>24&255,d[8]=z>>>0&255,d[9]=z>>>8&255,d[10]=z>>>16&255,d[11]=z>>>24&255,d[12]=De>>>0&255,d[13]=De>>>8&255,d[14]=De>>>16&255,d[15]=De>>>24&255,d[16]=R>>>0&255,d[17]=R>>>8&255,d[18]=R>>>16&255,d[19]=R>>>24&255,d[20]=I>>>0&255,d[21]=I>>>8&255,d[22]=I>>>16&255,d[23]=I>>>24&255,d[24]=F>>>0&255,d[25]=F>>>8&255,d[26]=F>>>16&255,d[27]=F>>>24&255,d[28]=K>>>0&255,d[29]=K>>>8&255,d[30]=K>>>16&255,d[31]=K>>>24&255}function D(d,m,h,l){j(d,m,h,l)}function P(d,m,h,l){L(d,m,h,l)}var $=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function ne(d,m,h,l,v,C,O){var B=new Uint8Array(16),W=new Uint8Array(64),le,ee;for(ee=0;ee<16;ee++)B[ee]=0;for(ee=0;ee<8;ee++)B[ee]=C[ee];for(;v>=64;){for(D(W,B,O,$),ee=0;ee<64;ee++)d[m+ee]=h[l+ee]^W[ee];for(le=1,ee=8;ee<16;ee++)le=le+(B[ee]&255)|0,B[ee]=le&255,le>>>=8;v-=64,m+=64,l+=64}if(v>0)for(D(W,B,O,$),ee=0;ee<v;ee++)d[m+ee]=h[l+ee]^W[ee];return 0}function Q(d,m,h,l,v){var C=new Uint8Array(16),O=new Uint8Array(64),B,W;for(W=0;W<16;W++)C[W]=0;for(W=0;W<8;W++)C[W]=l[W];for(;h>=64;){for(D(O,C,v,$),W=0;W<64;W++)d[m+W]=O[W];for(B=1,W=8;W<16;W++)B=B+(C[W]&255)|0,C[W]=B&255,B>>>=8;h-=64,m+=64}if(h>0)for(D(O,C,v,$),W=0;W<h;W++)d[m+W]=O[W];return 0}function G(d,m,h,l,v){var C=new Uint8Array(32);P(C,l,v,$);for(var O=new Uint8Array(8),B=0;B<8;B++)O[B]=l[B+16];return Q(d,m,h,O,C)}function me(d,m,h,l,v,C,O){var B=new Uint8Array(32);P(B,C,O,$);for(var W=new Uint8Array(8),le=0;le<8;le++)W[le]=C[le+16];return ne(d,m,h,l,v,W,B)}var ze=function(d){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var m,h,l,v,C,O,B,W;m=d[0]&255|(d[1]&255)<<8,this.r[0]=m&8191,h=d[2]&255|(d[3]&255)<<8,this.r[1]=(m>>>13|h<<3)&8191,l=d[4]&255|(d[5]&255)<<8,this.r[2]=(h>>>10|l<<6)&7939,v=d[6]&255|(d[7]&255)<<8,this.r[3]=(l>>>7|v<<9)&8191,C=d[8]&255|(d[9]&255)<<8,this.r[4]=(v>>>4|C<<12)&255,this.r[5]=C>>>1&8190,O=d[10]&255|(d[11]&255)<<8,this.r[6]=(C>>>14|O<<2)&8191,B=d[12]&255|(d[13]&255)<<8,this.r[7]=(O>>>11|B<<5)&8065,W=d[14]&255|(d[15]&255)<<8,this.r[8]=(B>>>8|W<<8)&8191,this.r[9]=W>>>5&127,this.pad[0]=d[16]&255|(d[17]&255)<<8,this.pad[1]=d[18]&255|(d[19]&255)<<8,this.pad[2]=d[20]&255|(d[21]&255)<<8,this.pad[3]=d[22]&255|(d[23]&255)<<8,this.pad[4]=d[24]&255|(d[25]&255)<<8,this.pad[5]=d[26]&255|(d[27]&255)<<8,this.pad[6]=d[28]&255|(d[29]&255)<<8,this.pad[7]=d[30]&255|(d[31]&255)<<8};ze.prototype.blocks=function(d,m,h){for(var l=this.fin?0:2048,v,C,O,B,W,le,ee,Le,ie,be,pe,Te,Se,ve,we,ye,re,ue,te,se=this.h[0],fe=this.h[1],X=this.h[2],R=this.h[3],I=this.h[4],F=this.h[5],K=this.h[6],z=this.h[7],H=this.h[8],_e=this.h[9],Ce=this.r[0],Oe=this.r[1],De=this.r[2],g=this.r[3],xe=this.r[4],Ue=this.r[5],je=this.r[6],Ne=this.r[7],Pe=this.r[8],Me=this.r[9];h>=16;)v=d[m+0]&255|(d[m+1]&255)<<8,se+=v&8191,C=d[m+2]&255|(d[m+3]&255)<<8,fe+=(v>>>13|C<<3)&8191,O=d[m+4]&255|(d[m+5]&255)<<8,X+=(C>>>10|O<<6)&8191,B=d[m+6]&255|(d[m+7]&255)<<8,R+=(O>>>7|B<<9)&8191,W=d[m+8]&255|(d[m+9]&255)<<8,I+=(B>>>4|W<<12)&8191,F+=W>>>1&8191,le=d[m+10]&255|(d[m+11]&255)<<8,K+=(W>>>14|le<<2)&8191,ee=d[m+12]&255|(d[m+13]&255)<<8,z+=(le>>>11|ee<<5)&8191,Le=d[m+14]&255|(d[m+15]&255)<<8,H+=(ee>>>8|Le<<8)&8191,_e+=Le>>>5|l,ie=0,be=ie,be+=se*Ce,be+=fe*(5*Me),be+=X*(5*Pe),be+=R*(5*Ne),be+=I*(5*je),ie=be>>>13,be&=8191,be+=F*(5*Ue),be+=K*(5*xe),be+=z*(5*g),be+=H*(5*De),be+=_e*(5*Oe),ie+=be>>>13,be&=8191,pe=ie,pe+=se*Oe,pe+=fe*Ce,pe+=X*(5*Me),pe+=R*(5*Pe),pe+=I*(5*Ne),ie=pe>>>13,pe&=8191,pe+=F*(5*je),pe+=K*(5*Ue),pe+=z*(5*xe),pe+=H*(5*g),pe+=_e*(5*De),ie+=pe>>>13,pe&=8191,Te=ie,Te+=se*De,Te+=fe*Oe,Te+=X*Ce,Te+=R*(5*Me),Te+=I*(5*Pe),ie=Te>>>13,Te&=8191,Te+=F*(5*Ne),Te+=K*(5*je),Te+=z*(5*Ue),Te+=H*(5*xe),Te+=_e*(5*g),ie+=Te>>>13,Te&=8191,Se=ie,Se+=se*g,Se+=fe*De,Se+=X*Oe,Se+=R*Ce,Se+=I*(5*Me),ie=Se>>>13,Se&=8191,Se+=F*(5*Pe),Se+=K*(5*Ne),Se+=z*(5*je),Se+=H*(5*Ue),Se+=_e*(5*xe),ie+=Se>>>13,Se&=8191,ve=ie,ve+=se*xe,ve+=fe*g,ve+=X*De,ve+=R*Oe,ve+=I*Ce,ie=ve>>>13,ve&=8191,ve+=F*(5*Me),ve+=K*(5*Pe),ve+=z*(5*Ne),ve+=H*(5*je),ve+=_e*(5*Ue),ie+=ve>>>13,ve&=8191,we=ie,we+=se*Ue,we+=fe*xe,we+=X*g,we+=R*De,we+=I*Oe,ie=we>>>13,we&=8191,we+=F*Ce,we+=K*(5*Me),we+=z*(5*Pe),we+=H*(5*Ne),we+=_e*(5*je),ie+=we>>>13,we&=8191,ye=ie,ye+=se*je,ye+=fe*Ue,ye+=X*xe,ye+=R*g,ye+=I*De,ie=ye>>>13,ye&=8191,ye+=F*Oe,ye+=K*Ce,ye+=z*(5*Me),ye+=H*(5*Pe),ye+=_e*(5*Ne),ie+=ye>>>13,ye&=8191,re=ie,re+=se*Ne,re+=fe*je,re+=X*Ue,re+=R*xe,re+=I*g,ie=re>>>13,re&=8191,re+=F*De,re+=K*Oe,re+=z*Ce,re+=H*(5*Me),re+=_e*(5*Pe),ie+=re>>>13,re&=8191,ue=ie,ue+=se*Pe,ue+=fe*Ne,ue+=X*je,ue+=R*Ue,ue+=I*xe,ie=ue>>>13,ue&=8191,ue+=F*g,ue+=K*De,ue+=z*Oe,ue+=H*Ce,ue+=_e*(5*Me),ie+=ue>>>13,ue&=8191,te=ie,te+=se*Me,te+=fe*Pe,te+=X*Ne,te+=R*je,te+=I*Ue,ie=te>>>13,te&=8191,te+=F*xe,te+=K*g,te+=z*De,te+=H*Oe,te+=_e*Ce,ie+=te>>>13,te&=8191,ie=(ie<<2)+ie|0,ie=ie+be|0,be=ie&8191,ie=ie>>>13,pe+=ie,se=be,fe=pe,X=Te,R=Se,I=ve,F=we,K=ye,z=re,H=ue,_e=te,m+=16,h-=16;this.h[0]=se,this.h[1]=fe,this.h[2]=X,this.h[3]=R,this.h[4]=I,this.h[5]=F,this.h[6]=K,this.h[7]=z,this.h[8]=H,this.h[9]=_e},ze.prototype.finish=function(d,m){var h=new Uint16Array(10),l,v,C,O;if(this.leftover){for(O=this.leftover,this.buffer[O++]=1;O<16;O++)this.buffer[O]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(l=this.h[1]>>>13,this.h[1]&=8191,O=2;O<10;O++)this.h[O]+=l,l=this.h[O]>>>13,this.h[O]&=8191;for(this.h[0]+=l*5,l=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=l,l=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=l,h[0]=this.h[0]+5,l=h[0]>>>13,h[0]&=8191,O=1;O<10;O++)h[O]=this.h[O]+l,l=h[O]>>>13,h[O]&=8191;for(h[9]-=1<<13,v=(l^1)-1,O=0;O<10;O++)h[O]&=v;for(v=~v,O=0;O<10;O++)this.h[O]=this.h[O]&v|h[O];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,C=this.h[0]+this.pad[0],this.h[0]=C&65535,O=1;O<8;O++)C=(this.h[O]+this.pad[O]|0)+(C>>>16)|0,this.h[O]=C&65535;d[m+0]=this.h[0]>>>0&255,d[m+1]=this.h[0]>>>8&255,d[m+2]=this.h[1]>>>0&255,d[m+3]=this.h[1]>>>8&255,d[m+4]=this.h[2]>>>0&255,d[m+5]=this.h[2]>>>8&255,d[m+6]=this.h[3]>>>0&255,d[m+7]=this.h[3]>>>8&255,d[m+8]=this.h[4]>>>0&255,d[m+9]=this.h[4]>>>8&255,d[m+10]=this.h[5]>>>0&255,d[m+11]=this.h[5]>>>8&255,d[m+12]=this.h[6]>>>0&255,d[m+13]=this.h[6]>>>8&255,d[m+14]=this.h[7]>>>0&255,d[m+15]=this.h[7]>>>8&255},ze.prototype.update=function(d,m,h){var l,v;if(this.leftover){for(v=16-this.leftover,v>h&&(v=h),l=0;l<v;l++)this.buffer[this.leftover+l]=d[m+l];if(h-=v,m+=v,this.leftover+=v,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(h>=16&&(v=h-h%16,this.blocks(d,m,v),m+=v,h-=v),h){for(l=0;l<h;l++)this.buffer[this.leftover+l]=d[m+l];this.leftover+=h}};function qe(d,m,h,l,v,C){var O=new ze(C);return O.update(h,l,v),O.finish(d,m),0}function Ye(d,m,h,l,v,C){var O=new Uint8Array(16);return qe(O,0,h,l,v,C),T(d,m,O,0)}function oe(d,m,h,l,v){var C;if(h<32)return-1;for(me(d,0,m,0,h,l,v),qe(d,16,d,32,h-32,d),C=0;C<16;C++)d[C]=0;return 0}function Ie(d,m,h,l,v){var C,O=new Uint8Array(32);if(h<32||(G(O,0,32,l,v),Ye(m,16,m,32,h-32,O)!==0))return-1;for(me(d,0,m,0,h,l,v),C=0;C<32;C++)d[C]=0;return 0}function ae(d,m){var h;for(h=0;h<16;h++)d[h]=m[h]|0}function Re(d){var m,h,l=1;for(m=0;m<16;m++)h=d[m]+l+65535,l=Math.floor(h/65536),d[m]=h-l*65536;d[0]+=l-1+37*(l-1)}function mt(d,m,h){for(var l,v=~(h-1),C=0;C<16;C++)l=v&(d[C]^m[C]),d[C]^=l,m[C]^=l}function tt(d,m){var h,l,v,C=n(),O=n();for(h=0;h<16;h++)O[h]=m[h];for(Re(O),Re(O),Re(O),l=0;l<2;l++){for(C[0]=O[0]-65517,h=1;h<15;h++)C[h]=O[h]-65535-(C[h-1]>>16&1),C[h-1]&=65535;C[15]=O[15]-32767-(C[14]>>16&1),v=C[15]>>16&1,C[14]&=65535,mt(O,C,1-v)}for(h=0;h<16;h++)d[2*h]=O[h]&255,d[2*h+1]=O[h]>>8}function Tt(d,m){var h=new Uint8Array(32),l=new Uint8Array(32);return tt(h,d),tt(l,m),A(h,0,l,0)}function gt(d){var m=new Uint8Array(32);return tt(m,d),m[0]&1}function wt(d,m){var h;for(h=0;h<16;h++)d[h]=m[2*h]+(m[2*h+1]<<8);d[15]&=32767}function it(d,m,h){for(var l=0;l<16;l++)d[l]=m[l]+h[l]}function rt(d,m,h){for(var l=0;l<16;l++)d[l]=m[l]-h[l]}function ge(d,m,h){var l,v,C=0,O=0,B=0,W=0,le=0,ee=0,Le=0,ie=0,be=0,pe=0,Te=0,Se=0,ve=0,we=0,ye=0,re=0,ue=0,te=0,se=0,fe=0,X=0,R=0,I=0,F=0,K=0,z=0,H=0,_e=0,Ce=0,Oe=0,De=0,g=h[0],xe=h[1],Ue=h[2],je=h[3],Ne=h[4],Pe=h[5],Me=h[6],Xe=h[7],Ke=h[8],Ze=h[9],Ge=h[10],Ve=h[11],st=h[12],at=h[13],ut=h[14],dt=h[15];l=m[0],C+=l*g,O+=l*xe,B+=l*Ue,W+=l*je,le+=l*Ne,ee+=l*Pe,Le+=l*Me,ie+=l*Xe,be+=l*Ke,pe+=l*Ze,Te+=l*Ge,Se+=l*Ve,ve+=l*st,we+=l*at,ye+=l*ut,re+=l*dt,l=m[1],O+=l*g,B+=l*xe,W+=l*Ue,le+=l*je,ee+=l*Ne,Le+=l*Pe,ie+=l*Me,be+=l*Xe,pe+=l*Ke,Te+=l*Ze,Se+=l*Ge,ve+=l*Ve,we+=l*st,ye+=l*at,re+=l*ut,ue+=l*dt,l=m[2],B+=l*g,W+=l*xe,le+=l*Ue,ee+=l*je,Le+=l*Ne,ie+=l*Pe,be+=l*Me,pe+=l*Xe,Te+=l*Ke,Se+=l*Ze,ve+=l*Ge,we+=l*Ve,ye+=l*st,re+=l*at,ue+=l*ut,te+=l*dt,l=m[3],W+=l*g,le+=l*xe,ee+=l*Ue,Le+=l*je,ie+=l*Ne,be+=l*Pe,pe+=l*Me,Te+=l*Xe,Se+=l*Ke,ve+=l*Ze,we+=l*Ge,ye+=l*Ve,re+=l*st,ue+=l*at,te+=l*ut,se+=l*dt,l=m[4],le+=l*g,ee+=l*xe,Le+=l*Ue,ie+=l*je,be+=l*Ne,pe+=l*Pe,Te+=l*Me,Se+=l*Xe,ve+=l*Ke,we+=l*Ze,ye+=l*Ge,re+=l*Ve,ue+=l*st,te+=l*at,se+=l*ut,fe+=l*dt,l=m[5],ee+=l*g,Le+=l*xe,ie+=l*Ue,be+=l*je,pe+=l*Ne,Te+=l*Pe,Se+=l*Me,ve+=l*Xe,we+=l*Ke,ye+=l*Ze,re+=l*Ge,ue+=l*Ve,te+=l*st,se+=l*at,fe+=l*ut,X+=l*dt,l=m[6],Le+=l*g,ie+=l*xe,be+=l*Ue,pe+=l*je,Te+=l*Ne,Se+=l*Pe,ve+=l*Me,we+=l*Xe,ye+=l*Ke,re+=l*Ze,ue+=l*Ge,te+=l*Ve,se+=l*st,fe+=l*at,X+=l*ut,R+=l*dt,l=m[7],ie+=l*g,be+=l*xe,pe+=l*Ue,Te+=l*je,Se+=l*Ne,ve+=l*Pe,we+=l*Me,ye+=l*Xe,re+=l*Ke,ue+=l*Ze,te+=l*Ge,se+=l*Ve,fe+=l*st,X+=l*at,R+=l*ut,I+=l*dt,l=m[8],be+=l*g,pe+=l*xe,Te+=l*Ue,Se+=l*je,ve+=l*Ne,we+=l*Pe,ye+=l*Me,re+=l*Xe,ue+=l*Ke,te+=l*Ze,se+=l*Ge,fe+=l*Ve,X+=l*st,R+=l*at,I+=l*ut,F+=l*dt,l=m[9],pe+=l*g,Te+=l*xe,Se+=l*Ue,ve+=l*je,we+=l*Ne,ye+=l*Pe,re+=l*Me,ue+=l*Xe,te+=l*Ke,se+=l*Ze,fe+=l*Ge,X+=l*Ve,R+=l*st,I+=l*at,F+=l*ut,K+=l*dt,l=m[10],Te+=l*g,Se+=l*xe,ve+=l*Ue,we+=l*je,ye+=l*Ne,re+=l*Pe,ue+=l*Me,te+=l*Xe,se+=l*Ke,fe+=l*Ze,X+=l*Ge,R+=l*Ve,I+=l*st,F+=l*at,K+=l*ut,z+=l*dt,l=m[11],Se+=l*g,ve+=l*xe,we+=l*Ue,ye+=l*je,re+=l*Ne,ue+=l*Pe,te+=l*Me,se+=l*Xe,fe+=l*Ke,X+=l*Ze,R+=l*Ge,I+=l*Ve,F+=l*st,K+=l*at,z+=l*ut,H+=l*dt,l=m[12],ve+=l*g,we+=l*xe,ye+=l*Ue,re+=l*je,ue+=l*Ne,te+=l*Pe,se+=l*Me,fe+=l*Xe,X+=l*Ke,R+=l*Ze,I+=l*Ge,F+=l*Ve,K+=l*st,z+=l*at,H+=l*ut,_e+=l*dt,l=m[13],we+=l*g,ye+=l*xe,re+=l*Ue,ue+=l*je,te+=l*Ne,se+=l*Pe,fe+=l*Me,X+=l*Xe,R+=l*Ke,I+=l*Ze,F+=l*Ge,K+=l*Ve,z+=l*st,H+=l*at,_e+=l*ut,Ce+=l*dt,l=m[14],ye+=l*g,re+=l*xe,ue+=l*Ue,te+=l*je,se+=l*Ne,fe+=l*Pe,X+=l*Me,R+=l*Xe,I+=l*Ke,F+=l*Ze,K+=l*Ge,z+=l*Ve,H+=l*st,_e+=l*at,Ce+=l*ut,Oe+=l*dt,l=m[15],re+=l*g,ue+=l*xe,te+=l*Ue,se+=l*je,fe+=l*Ne,X+=l*Pe,R+=l*Me,I+=l*Xe,F+=l*Ke,K+=l*Ze,z+=l*Ge,H+=l*Ve,_e+=l*st,Ce+=l*at,Oe+=l*ut,De+=l*dt,C+=38*ue,O+=38*te,B+=38*se,W+=38*fe,le+=38*X,ee+=38*R,Le+=38*I,ie+=38*F,be+=38*K,pe+=38*z,Te+=38*H,Se+=38*_e,ve+=38*Ce,we+=38*Oe,ye+=38*De,v=1,l=C+v+65535,v=Math.floor(l/65536),C=l-v*65536,l=O+v+65535,v=Math.floor(l/65536),O=l-v*65536,l=B+v+65535,v=Math.floor(l/65536),B=l-v*65536,l=W+v+65535,v=Math.floor(l/65536),W=l-v*65536,l=le+v+65535,v=Math.floor(l/65536),le=l-v*65536,l=ee+v+65535,v=Math.floor(l/65536),ee=l-v*65536,l=Le+v+65535,v=Math.floor(l/65536),Le=l-v*65536,l=ie+v+65535,v=Math.floor(l/65536),ie=l-v*65536,l=be+v+65535,v=Math.floor(l/65536),be=l-v*65536,l=pe+v+65535,v=Math.floor(l/65536),pe=l-v*65536,l=Te+v+65535,v=Math.floor(l/65536),Te=l-v*65536,l=Se+v+65535,v=Math.floor(l/65536),Se=l-v*65536,l=ve+v+65535,v=Math.floor(l/65536),ve=l-v*65536,l=we+v+65535,v=Math.floor(l/65536),we=l-v*65536,l=ye+v+65535,v=Math.floor(l/65536),ye=l-v*65536,l=re+v+65535,v=Math.floor(l/65536),re=l-v*65536,C+=v-1+37*(v-1),v=1,l=C+v+65535,v=Math.floor(l/65536),C=l-v*65536,l=O+v+65535,v=Math.floor(l/65536),O=l-v*65536,l=B+v+65535,v=Math.floor(l/65536),B=l-v*65536,l=W+v+65535,v=Math.floor(l/65536),W=l-v*65536,l=le+v+65535,v=Math.floor(l/65536),le=l-v*65536,l=ee+v+65535,v=Math.floor(l/65536),ee=l-v*65536,l=Le+v+65535,v=Math.floor(l/65536),Le=l-v*65536,l=ie+v+65535,v=Math.floor(l/65536),ie=l-v*65536,l=be+v+65535,v=Math.floor(l/65536),be=l-v*65536,l=pe+v+65535,v=Math.floor(l/65536),pe=l-v*65536,l=Te+v+65535,v=Math.floor(l/65536),Te=l-v*65536,l=Se+v+65535,v=Math.floor(l/65536),Se=l-v*65536,l=ve+v+65535,v=Math.floor(l/65536),ve=l-v*65536,l=we+v+65535,v=Math.floor(l/65536),we=l-v*65536,l=ye+v+65535,v=Math.floor(l/65536),ye=l-v*65536,l=re+v+65535,v=Math.floor(l/65536),re=l-v*65536,C+=v-1+37*(v-1),d[0]=C,d[1]=O,d[2]=B,d[3]=W,d[4]=le,d[5]=ee,d[6]=Le,d[7]=ie,d[8]=be,d[9]=pe,d[10]=Te,d[11]=Se,d[12]=ve,d[13]=we,d[14]=ye,d[15]=re}function Be(d,m){ge(d,m,m)}function Ct(d,m){var h=n(),l;for(l=0;l<16;l++)h[l]=m[l];for(l=253;l>=0;l--)Be(h,h),l!==2&&l!==4&&ge(h,h,m);for(l=0;l<16;l++)d[l]=h[l]}function Dt(d,m){var h=n(),l;for(l=0;l<16;l++)h[l]=m[l];for(l=250;l>=0;l--)Be(h,h),l!==1&&ge(h,h,m);for(l=0;l<16;l++)d[l]=h[l]}function ct(d,m,h){var l=new Uint8Array(32),v=new Float64Array(80),C,O,B=n(),W=n(),le=n(),ee=n(),Le=n(),ie=n();for(O=0;O<31;O++)l[O]=m[O];for(l[31]=m[31]&127|64,l[0]&=248,wt(v,h),O=0;O<16;O++)W[O]=v[O],ee[O]=B[O]=le[O]=0;for(B[0]=ee[0]=1,O=254;O>=0;--O)C=l[O>>>3]>>>(O&7)&1,mt(B,W,C),mt(le,ee,C),it(Le,B,le),rt(B,B,le),it(le,W,ee),rt(W,W,ee),Be(ee,Le),Be(ie,B),ge(B,le,B),ge(le,W,Le),it(Le,B,le),rt(B,B,le),Be(W,B),rt(le,ee,ie),ge(B,le,c),it(B,B,ee),ge(le,le,B),ge(B,ee,ie),ge(ee,W,v),Be(W,Le),mt(B,W,C),mt(le,ee,C);for(O=0;O<16;O++)v[O+16]=B[O],v[O+32]=le[O],v[O+48]=W[O],v[O+64]=ee[O];var be=v.subarray(32),pe=v.subarray(16);return Ct(be,be),ge(pe,pe,be),tt(d,pe),0}function Qe(d,m){return ct(d,m,s)}function Je(d,m){return i(m,32),Qe(d,m)}function Ot(d,m,h){var l=new Uint8Array(32);return ct(l,h,m),P(d,r,l,$)}var q=oe,de=Ie;function $t(d,m,h,l,v,C){var O=new Uint8Array(32);return Ot(O,v,C),q(d,m,h,l,O)}function hn(d,m,h,l,v,C){var O=new Uint8Array(32);return Ot(O,v,C),de(d,m,h,l,O)}var mi=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function pi(d,m,h,l){for(var v=new Int32Array(16),C=new Int32Array(16),O,B,W,le,ee,Le,ie,be,pe,Te,Se,ve,we,ye,re,ue,te,se,fe,X,R,I,F,K,z,H,_e=d[0],Ce=d[1],Oe=d[2],De=d[3],g=d[4],xe=d[5],Ue=d[6],je=d[7],Ne=m[0],Pe=m[1],Me=m[2],Xe=m[3],Ke=m[4],Ze=m[5],Ge=m[6],Ve=m[7],st=0;l>=128;){for(fe=0;fe<16;fe++)X=8*fe+st,v[fe]=h[X+0]<<24|h[X+1]<<16|h[X+2]<<8|h[X+3],C[fe]=h[X+4]<<24|h[X+5]<<16|h[X+6]<<8|h[X+7];for(fe=0;fe<80;fe++)if(O=_e,B=Ce,W=Oe,le=De,ee=g,Le=xe,ie=Ue,be=je,pe=Ne,Te=Pe,Se=Me,ve=Xe,we=Ke,ye=Ze,re=Ge,ue=Ve,R=je,I=Ve,F=I&65535,K=I>>>16,z=R&65535,H=R>>>16,R=(g>>>14|Ke<<32-14)^(g>>>18|Ke<<32-18)^(Ke>>>41-32|g<<32-(41-32)),I=(Ke>>>14|g<<32-14)^(Ke>>>18|g<<32-18)^(g>>>41-32|Ke<<32-(41-32)),F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,R=g&xe^~g&Ue,I=Ke&Ze^~Ke&Ge,F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,R=mi[fe*2],I=mi[fe*2+1],F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,R=v[fe%16],I=C[fe%16],F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,K+=F>>>16,z+=K>>>16,H+=z>>>16,te=z&65535|H<<16,se=F&65535|K<<16,R=te,I=se,F=I&65535,K=I>>>16,z=R&65535,H=R>>>16,R=(_e>>>28|Ne<<32-28)^(Ne>>>34-32|_e<<32-(34-32))^(Ne>>>39-32|_e<<32-(39-32)),I=(Ne>>>28|_e<<32-28)^(_e>>>34-32|Ne<<32-(34-32))^(_e>>>39-32|Ne<<32-(39-32)),F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,R=_e&Ce^_e&Oe^Ce&Oe,I=Ne&Pe^Ne&Me^Pe&Me,F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,K+=F>>>16,z+=K>>>16,H+=z>>>16,be=z&65535|H<<16,ue=F&65535|K<<16,R=le,I=ve,F=I&65535,K=I>>>16,z=R&65535,H=R>>>16,R=te,I=se,F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,K+=F>>>16,z+=K>>>16,H+=z>>>16,le=z&65535|H<<16,ve=F&65535|K<<16,Ce=O,Oe=B,De=W,g=le,xe=ee,Ue=Le,je=ie,_e=be,Pe=pe,Me=Te,Xe=Se,Ke=ve,Ze=we,Ge=ye,Ve=re,Ne=ue,fe%16===15)for(X=0;X<16;X++)R=v[X],I=C[X],F=I&65535,K=I>>>16,z=R&65535,H=R>>>16,R=v[(X+9)%16],I=C[(X+9)%16],F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,te=v[(X+1)%16],se=C[(X+1)%16],R=(te>>>1|se<<32-1)^(te>>>8|se<<32-8)^te>>>7,I=(se>>>1|te<<32-1)^(se>>>8|te<<32-8)^(se>>>7|te<<32-7),F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,te=v[(X+14)%16],se=C[(X+14)%16],R=(te>>>19|se<<32-19)^(se>>>61-32|te<<32-(61-32))^te>>>6,I=(se>>>19|te<<32-19)^(te>>>61-32|se<<32-(61-32))^(se>>>6|te<<32-6),F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,K+=F>>>16,z+=K>>>16,H+=z>>>16,v[X]=z&65535|H<<16,C[X]=F&65535|K<<16;R=_e,I=Ne,F=I&65535,K=I>>>16,z=R&65535,H=R>>>16,R=d[0],I=m[0],F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,K+=F>>>16,z+=K>>>16,H+=z>>>16,d[0]=_e=z&65535|H<<16,m[0]=Ne=F&65535|K<<16,R=Ce,I=Pe,F=I&65535,K=I>>>16,z=R&65535,H=R>>>16,R=d[1],I=m[1],F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,K+=F>>>16,z+=K>>>16,H+=z>>>16,d[1]=Ce=z&65535|H<<16,m[1]=Pe=F&65535|K<<16,R=Oe,I=Me,F=I&65535,K=I>>>16,z=R&65535,H=R>>>16,R=d[2],I=m[2],F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,K+=F>>>16,z+=K>>>16,H+=z>>>16,d[2]=Oe=z&65535|H<<16,m[2]=Me=F&65535|K<<16,R=De,I=Xe,F=I&65535,K=I>>>16,z=R&65535,H=R>>>16,R=d[3],I=m[3],F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,K+=F>>>16,z+=K>>>16,H+=z>>>16,d[3]=De=z&65535|H<<16,m[3]=Xe=F&65535|K<<16,R=g,I=Ke,F=I&65535,K=I>>>16,z=R&65535,H=R>>>16,R=d[4],I=m[4],F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,K+=F>>>16,z+=K>>>16,H+=z>>>16,d[4]=g=z&65535|H<<16,m[4]=Ke=F&65535|K<<16,R=xe,I=Ze,F=I&65535,K=I>>>16,z=R&65535,H=R>>>16,R=d[5],I=m[5],F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,K+=F>>>16,z+=K>>>16,H+=z>>>16,d[5]=xe=z&65535|H<<16,m[5]=Ze=F&65535|K<<16,R=Ue,I=Ge,F=I&65535,K=I>>>16,z=R&65535,H=R>>>16,R=d[6],I=m[6],F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,K+=F>>>16,z+=K>>>16,H+=z>>>16,d[6]=Ue=z&65535|H<<16,m[6]=Ge=F&65535|K<<16,R=je,I=Ve,F=I&65535,K=I>>>16,z=R&65535,H=R>>>16,R=d[7],I=m[7],F+=I&65535,K+=I>>>16,z+=R&65535,H+=R>>>16,K+=F>>>16,z+=K>>>16,H+=z>>>16,d[7]=je=z&65535|H<<16,m[7]=Ve=F&65535|K<<16,st+=128,l-=128}return l}function Kt(d,m,h){var l=new Int32Array(8),v=new Int32Array(8),C=new Uint8Array(256),O,B=h;for(l[0]=1779033703,l[1]=3144134277,l[2]=1013904242,l[3]=2773480762,l[4]=1359893119,l[5]=2600822924,l[6]=528734635,l[7]=1541459225,v[0]=4089235720,v[1]=2227873595,v[2]=4271175723,v[3]=1595750129,v[4]=2917565137,v[5]=725511199,v[6]=4215389547,v[7]=327033209,pi(l,v,m,h),h%=128,O=0;O<h;O++)C[O]=m[B-h+O];for(C[h]=128,h=256-128*(h<112?1:0),C[h-9]=0,k(C,h-8,B/536870912|0,B<<3),pi(l,v,C,h),O=0;O<8;O++)k(d,8*O,l[O],v[O]);return 0}function bn(d,m){var h=n(),l=n(),v=n(),C=n(),O=n(),B=n(),W=n(),le=n(),ee=n();rt(h,d[1],d[0]),rt(ee,m[1],m[0]),ge(h,h,ee),it(l,d[0],d[1]),it(ee,m[0],m[1]),ge(l,l,ee),ge(v,d[3],m[3]),ge(v,v,u),ge(C,d[2],m[2]),it(C,C,C),rt(O,l,h),rt(B,C,v),it(W,C,v),it(le,l,h),ge(d[0],O,B),ge(d[1],le,W),ge(d[2],W,B),ge(d[3],O,le)}function vi(d,m,h){var l;for(l=0;l<4;l++)mt(d[l],m[l],h)}function Un(d,m){var h=n(),l=n(),v=n();Ct(v,m[2]),ge(h,m[0],v),ge(l,m[1],v),tt(d,l),d[31]^=gt(h)<<7}function jn(d,m,h){var l,v;for(ae(d[0],f),ae(d[1],o),ae(d[2],o),ae(d[3],f),v=255;v>=0;--v)l=h[v/8|0]>>(v&7)&1,vi(d,m,l),bn(m,d),bn(d,d),vi(d,m,l)}function mn(d,m){var h=[n(),n(),n(),n()];ae(h[0],_),ae(h[1],b),ae(h[2],o),ge(h[3],_,b),jn(d,h,m)}function $n(d,m,h){var l=new Uint8Array(64),v=[n(),n(),n(),n()],C;for(h||i(m,32),Kt(l,m,32),l[0]&=248,l[31]&=127,l[31]|=64,mn(v,l),Un(d,v),C=0;C<32;C++)m[C+32]=d[C];return 0}var pn=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Kn(d,m){var h,l,v,C;for(l=63;l>=32;--l){for(h=0,v=l-32,C=l-12;v<C;++v)m[v]+=h-16*m[l]*pn[v-(l-32)],h=Math.floor((m[v]+128)/256),m[v]-=h*256;m[v]+=h,m[l]=0}for(h=0,v=0;v<32;v++)m[v]+=h-(m[31]>>4)*pn[v],h=m[v]>>8,m[v]&=255;for(v=0;v<32;v++)m[v]-=h*pn[v];for(l=0;l<32;l++)m[l+1]+=m[l]>>8,d[l]=m[l]&255}function Bn(d){var m=new Float64Array(64),h;for(h=0;h<64;h++)m[h]=d[h];for(h=0;h<64;h++)d[h]=0;Kn(d,m)}function yi(d,m,h,l){var v=new Uint8Array(64),C=new Uint8Array(64),O=new Uint8Array(64),B,W,le=new Float64Array(64),ee=[n(),n(),n(),n()];Kt(v,l,32),v[0]&=248,v[31]&=127,v[31]|=64;var Le=h+64;for(B=0;B<h;B++)d[64+B]=m[B];for(B=0;B<32;B++)d[32+B]=v[32+B];for(Kt(O,d.subarray(32),h+32),Bn(O),mn(ee,O),Un(d,ee),B=32;B<64;B++)d[B]=l[B];for(Kt(C,d,h+64),Bn(C),B=0;B<64;B++)le[B]=0;for(B=0;B<32;B++)le[B]=O[B];for(B=0;B<32;B++)for(W=0;W<32;W++)le[B+W]+=C[B]*v[W];return Kn(d.subarray(32),le),Le}function Bs(d,m){var h=n(),l=n(),v=n(),C=n(),O=n(),B=n(),W=n();return ae(d[2],o),wt(d[1],m),Be(v,d[1]),ge(C,v,a),rt(v,v,d[2]),it(C,d[2],C),Be(O,C),Be(B,O),ge(W,B,O),ge(h,W,v),ge(h,h,C),Dt(h,h),ge(h,h,v),ge(h,h,C),ge(h,h,C),ge(d[0],h,C),Be(l,d[0]),ge(l,l,C),Tt(l,v)&&ge(d[0],d[0],p),Be(l,d[0]),ge(l,l,C),Tt(l,v)?-1:(gt(d[0])===m[31]>>7&&rt(d[0],f,d[0]),ge(d[3],d[0],d[1]),0)}function zn(d,m,h,l){var v,C=new Uint8Array(32),O=new Uint8Array(64),B=[n(),n(),n(),n()],W=[n(),n(),n(),n()];if(h<64||Bs(W,l))return-1;for(v=0;v<h;v++)d[v]=m[v];for(v=0;v<32;v++)d[v+32]=l[v];if(Kt(O,d,h),Bn(O),jn(B,W,O),mn(W,m.subarray(32)),bn(B,W),Un(C,B),h-=64,A(m,0,C,0)){for(v=0;v<h;v++)d[v]=0;return-1}for(v=0;v<h;v++)d[v]=m[v+64];return h}var qn=32,vn=24,nn=32,Wt=16,rn=32,yn=32,sn=32,fn=32,Fn=32,gi=vn,zs=nn,qs=Wt,Nt=64,Bt=32,Jt=64,Yn=32,Hn=64;e.lowlevel={crypto_core_hsalsa20:P,crypto_stream_xor:me,crypto_stream:G,crypto_stream_salsa20_xor:ne,crypto_stream_salsa20:Q,crypto_onetimeauth:qe,crypto_onetimeauth_verify:Ye,crypto_verify_16:T,crypto_verify_32:A,crypto_secretbox:oe,crypto_secretbox_open:Ie,crypto_scalarmult:ct,crypto_scalarmult_base:Qe,crypto_box_beforenm:Ot,crypto_box_afternm:q,crypto_box:$t,crypto_box_open:hn,crypto_box_keypair:Je,crypto_hash:Kt,crypto_sign:yi,crypto_sign_keypair:$n,crypto_sign_open:zn,crypto_secretbox_KEYBYTES:qn,crypto_secretbox_NONCEBYTES:vn,crypto_secretbox_ZEROBYTES:nn,crypto_secretbox_BOXZEROBYTES:Wt,crypto_scalarmult_BYTES:rn,crypto_scalarmult_SCALARBYTES:yn,crypto_box_PUBLICKEYBYTES:sn,crypto_box_SECRETKEYBYTES:fn,crypto_box_BEFORENMBYTES:Fn,crypto_box_NONCEBYTES:gi,crypto_box_ZEROBYTES:zs,crypto_box_BOXZEROBYTES:qs,crypto_sign_BYTES:Nt,crypto_sign_PUBLICKEYBYTES:Bt,crypto_sign_SECRETKEYBYTES:Jt,crypto_sign_SEEDBYTES:Yn,crypto_hash_BYTES:Hn,gf:n,D:a,L:pn,pack25519:tt,unpack25519:wt,M:ge,A:it,S:Be,Z:rt,pow2523:Dt,add:bn,set25519:ae,modL:Kn,scalarmult:jn,scalarbase:mn};function wi(d,m){if(d.length!==qn)throw new Error("bad key size");if(m.length!==vn)throw new Error("bad nonce size")}function Fs(d,m){if(d.length!==sn)throw new Error("bad public key size");if(m.length!==fn)throw new Error("bad secret key size")}function vt(){for(var d=0;d<arguments.length;d++)if(!(arguments[d]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ki(d){for(var m=0;m<d.length;m++)d[m]=0}e.randomBytes=function(d){var m=new Uint8Array(d);return i(m,d),m},e.secretbox=function(d,m,h){vt(d,m,h),wi(h,m);for(var l=new Uint8Array(nn+d.length),v=new Uint8Array(l.length),C=0;C<d.length;C++)l[C+nn]=d[C];return oe(v,l,l.length,m,h),v.subarray(Wt)},e.secretbox.open=function(d,m,h){vt(d,m,h),wi(h,m);for(var l=new Uint8Array(Wt+d.length),v=new Uint8Array(l.length),C=0;C<d.length;C++)l[C+Wt]=d[C];return l.length<32||Ie(v,l,l.length,m,h)!==0?null:v.subarray(nn)},e.secretbox.keyLength=qn,e.secretbox.nonceLength=vn,e.secretbox.overheadLength=Wt,e.scalarMult=function(d,m){if(vt(d,m),d.length!==yn)throw new Error("bad n size");if(m.length!==rn)throw new Error("bad p size");var h=new Uint8Array(rn);return ct(h,d,m),h},e.scalarMult.base=function(d){if(vt(d),d.length!==yn)throw new Error("bad n size");var m=new Uint8Array(rn);return Qe(m,d),m},e.scalarMult.scalarLength=yn,e.scalarMult.groupElementLength=rn,e.box=function(d,m,h,l){var v=e.box.before(h,l);return e.secretbox(d,m,v)},e.box.before=function(d,m){vt(d,m),Fs(d,m);var h=new Uint8Array(Fn);return Ot(h,d,m),h},e.box.after=e.secretbox,e.box.open=function(d,m,h,l){var v=e.box.before(h,l);return e.secretbox.open(d,m,v)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var d=new Uint8Array(sn),m=new Uint8Array(fn);return Je(d,m),{publicKey:d,secretKey:m}},e.box.keyPair.fromSecretKey=function(d){if(vt(d),d.length!==fn)throw new Error("bad secret key size");var m=new Uint8Array(sn);return Qe(m,d),{publicKey:m,secretKey:new Uint8Array(d)}},e.box.publicKeyLength=sn,e.box.secretKeyLength=fn,e.box.sharedKeyLength=Fn,e.box.nonceLength=gi,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(d,m){if(vt(d,m),m.length!==Jt)throw new Error("bad secret key size");var h=new Uint8Array(Nt+d.length);return yi(h,d,d.length,m),h},e.sign.open=function(d,m){if(vt(d,m),m.length!==Bt)throw new Error("bad public key size");var h=new Uint8Array(d.length),l=zn(h,d,d.length,m);if(l<0)return null;for(var v=new Uint8Array(l),C=0;C<v.length;C++)v[C]=h[C];return v},e.sign.detached=function(d,m){for(var h=e.sign(d,m),l=new Uint8Array(Nt),v=0;v<l.length;v++)l[v]=h[v];return l},e.sign.detached.verify=function(d,m,h){if(vt(d,m,h),m.length!==Nt)throw new Error("bad signature size");if(h.length!==Bt)throw new Error("bad public key size");var l=new Uint8Array(Nt+d.length),v=new Uint8Array(Nt+d.length),C;for(C=0;C<Nt;C++)l[C]=m[C];for(C=0;C<d.length;C++)l[C+Nt]=d[C];return zn(v,l,l.length,h)>=0},e.sign.keyPair=function(){var d=new Uint8Array(Bt),m=new Uint8Array(Jt);return $n(d,m),{publicKey:d,secretKey:m}},e.sign.keyPair.fromSecretKey=function(d){if(vt(d),d.length!==Jt)throw new Error("bad secret key size");for(var m=new Uint8Array(Bt),h=0;h<m.length;h++)m[h]=d[32+h];return{publicKey:m,secretKey:new Uint8Array(d)}},e.sign.keyPair.fromSeed=function(d){if(vt(d),d.length!==Yn)throw new Error("bad seed size");for(var m=new Uint8Array(Bt),h=new Uint8Array(Jt),l=0;l<32;l++)h[l]=d[l];return $n(m,h,!0),{publicKey:m,secretKey:h}},e.sign.publicKeyLength=Bt,e.sign.secretKeyLength=Jt,e.sign.seedLength=Yn,e.sign.signatureLength=Nt,e.hash=function(d){vt(d);var m=new Uint8Array(Hn);return Kt(m,d,d.length),m},e.hash.hashLength=Hn,e.verify=function(d,m){return vt(d,m),d.length===0||m.length===0||d.length!==m.length?!1:y(d,0,m,0,d.length)===0},e.setPRNG=function(d){i=d},function(){var d=typeof self<"u"?self.crypto||self.msCrypto:null;if(d&&d.getRandomValues){var m=65536;e.setPRNG(function(h,l){var v,C=new Uint8Array(l);for(v=0;v<l;v+=m)d.getRandomValues(C.subarray(v,v+Math.min(l-v,m)));for(v=0;v<l;v++)h[v]=C[v];ki(C)})}else typeof ys<"u"&&(d=Ro,d&&d.randomBytes&&e.setPRNG(function(h,l){var v,C=d.randomBytes(l);for(v=0;v<l;v++)h[v]=C[v];ki(C)}))}()})(t.exports?t.exports:self.nacl=self.nacl||{})}),tn=vs(function(t){(function(e,n){t.exports?t.exports=n():(e.nacl||(e.nacl={}),e.nacl.util=n())})(Do,function(){var e={};function n(i){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(i))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(i){if(typeof i!="string")throw new TypeError("expected string");var r,s=unescape(encodeURIComponent(i)),f=new Uint8Array(s.length);for(r=0;r<s.length;r++)f[r]=s.charCodeAt(r);return f},e.encodeUTF8=function(i){var r,s=[];for(r=0;r<i.length;r++)s.push(String.fromCharCode(i[r]));return decodeURIComponent(escape(s.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(i){return Buffer.from(i).toString("base64")},e.decodeBase64=function(i){return n(i),new Uint8Array(Array.prototype.slice.call(Buffer.from(i,"base64"),0))}):(e.encodeBase64=function(i){return new Buffer(i).toString("base64")},e.decodeBase64=function(i){return n(i),new Uint8Array(Array.prototype.slice.call(new Buffer(i,"base64"),0))}):(e.encodeBase64=function(i){var r,s=[],f=i.length;for(r=0;r<f;r++)s.push(String.fromCharCode(i[r]));return btoa(s.join(""))},e.decodeBase64=function(i){n(i);var r,s=atob(i),f=new Uint8Array(s.length);for(r=0;r<s.length;r++)f[r]=s.charCodeAt(r);return f}),e})});function Io(t){return typeof t>"u"||t==null?[]:Array.isArray(t)?t:[t]}function xn(t){return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}function ii(t){const e=t.match(/.{1,2}(?=(.{2})+(?!.))|.{1,2}$/g);return new Uint8Array(e.map(n=>parseInt(n,16)))}function gs(t,e=8){const n=new Array(e).fill(0);for(let i=0;i<n.length;i++){const r=t&255;n[i]=r,t=(t-r)/256}return n}At.util=tn;function ws(){const t=At.box.keyPair(),e=xn(t.publicKey),n=xn(t.secretKey);return{privateKey:t.secretKey,publicKey:t.publicKey,privateKeyHex:n,publicKeyHex:e}}At.util=tn;function ks(t){return t.publicKeyHex&&!t.publicKey&&(t.publicKey=ii(t.publicKeyHex)),t.privateKeyHex&&!t.privateKey&&(t.privateKey=ii(t.privateKeyHex)),t}function Po(t){return t!=null&&t.constructor==Object}function Mo(t,e){const n=new Uint8Array(t.length+1),i=new Uint8Array(1);return i[0]=e,n.set(i),n.set(t,i.length),n}var Lo=qt;/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 * @license MIT ( Joyent)
 */function qt(t,e){var n={seen:[],stylize:Uo};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),As(e)?n.showHidden=e:e&&Fo(n,e),Vt(n.showHidden)&&(n.showHidden=!1),Vt(n.depth)&&(n.depth=2),Vt(n.colors)&&(n.colors=!1),Vt(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=jo),Rn(n,t,n.depth)}qt.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};qt.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Uo(t,e){return t}function As(t){return typeof t=="boolean"}function Vt(t){return t===void 0}function jo(t,e){var n=qt.styles[e];return n?"\x1B["+qt.colors[n][0]+"m"+t+"\x1B["+qt.colors[n][1]+"m":t}function Gn(t){return typeof t=="function"}function Ss(t){return typeof t=="string"}function $o(t){return typeof t=="number"}function Es(t){return t===null}function Ts(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Vn(t){return Ln(t)&&di(t)==="[object RegExp]"}function Ln(t){return typeof t=="object"&&t!==null}function Qn(t){return Ln(t)&&(di(t)==="[object Error]"||t instanceof Error)}function qr(t){return Ln(t)&&di(t)==="[object Date]"}function di(t){return Object.prototype.toString.call(t)}function Ko(t){var e={};return t.forEach(function(n,i){e[n]=!0}),e}function Bo(t,e,n,i,r){for(var s=[],f=0,o=e.length;f<o;++f)Ts(e,String(f))?s.push(ri(t,e,n,i,String(f),!0)):s.push("");return r.forEach(function(c){c.match(/^\d+$/)||s.push(ri(t,e,n,i,c,!0))}),s}function Xn(t){return"["+Error.prototype.toString.call(t)+"]"}function Rn(t,e,n){if(t.customInspect&&e&&Gn(e.inspect)&&e.inspect!==qt&&!(e.constructor&&e.constructor.prototype===e)){var i=e.inspect(n,t);return Ss(i)||(i=Rn(t,i,n)),i}var r=zo(t,e);if(r)return r;var s=Object.keys(e),f=Ko(s);try{t.showHidden&&Object.getOwnPropertyNames&&(s=Object.getOwnPropertyNames(e))}catch{}if(Qn(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return Xn(e);if(s.length===0){if(Gn(e)){var o=e.name?": "+e.name:"";return t.stylize("[Function"+o+"]","special")}if(Vn(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(qr(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Qn(e))return Xn(e)}var c="",a=!1,u=["{","}"];if(Array.isArray(e)&&(a=!0,u=["[","]"]),Gn(e)){var _=e.name?": "+e.name:"";c=" [Function"+_+"]"}if(Vn(e)&&(c=" "+RegExp.prototype.toString.call(e)),qr(e)&&(c=" "+Date.prototype.toUTCString.call(e)),Qn(e)&&(c=" "+Xn(e)),s.length===0&&(!a||e.length==0))return u[0]+c+u[1];if(n<0)return Vn(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var b;return a?b=Bo(t,e,n,f,s):b=s.map(function(p){return ri(t,e,n,f,p,a)}),t.seen.pop(),qo(b,c,u)}function ri(t,e,n,i,r,s){var f,o,c;c={value:void 0};try{c.value=e[r]}catch{}try{Object.getOwnPropertyDescriptor&&(c=Object.getOwnPropertyDescriptor(e,r)||c)}catch{}if(c.get?c.set?o=t.stylize("[Getter/Setter]","special"):o=t.stylize("[Getter]","special"):c.set&&(o=t.stylize("[Setter]","special")),Ts(i,r)||(f="["+r+"]"),o||(t.seen.indexOf(c.value)<0?(Es(n)?o=Rn(t,c.value,null):o=Rn(t,c.value,n-1),o.indexOf(`
`)>-1&&(s?o=o.split(`
`).map(function(a){return"  "+a}).join(`
`).substr(2):o=`
`+o.split(`
`).map(function(a){return"   "+a}).join(`
`))):o=t.stylize("[Circular]","special")),Vt(f)){if(s&&r.match(/^\d+$/))return o;f=JSON.stringify(""+r),f.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(f=f.substr(1,f.length-2),f=t.stylize(f,"name")):(f=f.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),f=t.stylize(f,"string"))}return f+": "+o}function zo(t,e){if(Vt(e))return t.stylize("undefined","undefined");if(Ss(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if($o(e))return t.stylize(""+e,"number");if(As(e))return t.stylize(""+e,"boolean");if(Es(e))return t.stylize("null","null")}function qo(t,e,n){var i=t.reduce(function(r,s){return s.indexOf(`
`)>=0,r+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function Fo(t,e){if(!e||!Ln(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}function xt(t,e,...n){try{e==console.log?e(`${new Date().toLocaleString()} \u2192 ${Lo(...n).replace(/^'/,"").replace(/'$/,"")}`):typeof e=="function"?e(...n):e&&e.logOutput(t,{source:"connectome"},...n)}catch(i){console.log(i)}}class Yo{write(e,...n){xt(void 0,e,...n)}red(e,...n){xt("red",e,...n)}green(e,...n){xt("green",e,...n)}yellow(e,...n){xt("yellow",e,...n)}blue(e,...n){xt("blue",e,...n)}cyan(e,...n){xt("cyan",e,...n)}magenta(e,...n){xt("magenta",e,...n)}gray(e,...n){xt("gray",e,...n)}white(e,...n){xt("white",e,...n)}}var $e=new Yo;At.util=tn;function Ho({data:t,connector:e}){const{log:n}=e;Po(t)&&(t=JSON.stringify(t));const i=new Uint8Array(gs(2*e.sentCount,24));if(e.closed())$e.red(n,`\u26A0\uFE0F Warning: "${t}" was not sent because connector is not ready`);else if(e.sentCount>1){let r=0;typeof t=="string"&&(r=1);const s=r==1?At.util.decodeUTF8(t):t,f=Mo(s,r),o=At.secretbox(f,i,e.sharedSecret);e.verbose&&($e.green(n,`Connector ${e.endpoint} \u2192 Sending encrypted message #${e.sentCount} \u21B4`),$e.gray(n,t)),e.connection.websocket.send(o)}else e.verbose&&($e.green(n,`Connector ${e.endpoint} \u2192 Sending message #${e.sentCount} \u21B4`),$e.gray(n,t)),e.connection.websocket.send(t)}At.util=tn;function Wo(t){return Object.keys(t).includes("result")||Object.keys(t).includes("error")}function Cs({jsonData:t,encryptedData:e,rawMessage:n,wasEncrypted:i,connector:r}){const{log:s}=r;r.lastMessageAt=Date.now();const f=new Uint8Array(gs(2*r.receivedCount+1,24));if(r.verbose&&!i&&$e.magenta(s,`Connector ${r.endpoint} \u2192 Received message #${r.receivedCount} \u21B4`),t)t.jsonrpc?Wo(t)?(r.verbose&&!i&&($e.magenta(s,`Connector ${r.endpoint} received plain-text rpc result \u21B4`),$e.gray(s,t)),r.rpcClient.jsonrpcMsgReceive(n)):r.emit("json_rpc",n):r.emit("receive",{jsonData:t,rawMessage:n});else if(e){r.verbose=="extra"&&($e.magenta(s,`Connector ${r.endpoint} received bytes \u21B4`),$e.gray(s,e),$e.magenta(s,`Connector ${r.endpoint} decrypting with shared secret ${r.sharedSecret}...`));const o=At.secretbox.open(e,f,r.sharedSecret),c=o[0],a=o.subarray(1);if(c==1){const u=At.util.encodeUTF8(a);r.verbose&&$e.write(s,`Received message: ${u}`);try{const _=JSON.parse(u);_.jsonrpc?Cs({jsonData:_,rawMessage:u,wasEncrypted:!0,connector:r}):_.state?r.emit("receive_state",_.state):_.diff?r.emit("receive_diff",_.diff):_.signal?r.emit(_.signal,_.data):_.stateField?r.emit("receive_state_field",_.stateField):r.emit("receive",{jsonData:_,rawMessage:u})}catch(_){throw $e.red(s,"Couldn't parse json message although the flag was for string ..."),$e.red(s,u),_}}else r.emit("receive_binary",a)}}At.util=tn;function Jo({connector:t,afterFirstStep:e=()=>{}}){const{clientPrivateKey:n,clientPublicKey:i,clientPublicKeyHex:r,protocol:s,tag:f,endpoint:o,verbose:c}=t;return new Promise((a,u)=>{t.remoteObject("Auth").call("exchangePubkeys",{pubkey:r}).then(_=>{const b=At.box.before(ii(_),n);e({sharedSecret:b,remotePubkeyHex:_}),c&&$e.write(t.log,`Connector ${o} established shared secret through diffie-hellman exchange.`),t.remoteObject("Auth").call("finalizeHandshake",{protocol:s}).then(p=>{if(p&&p.error)console.log(p.error);else{a();const k=f?` (${f})`:"";$e.cyan(t.log,`${o}${k} \u2713 Connection [ ${s||'"no-name"'} ] ready`)}}).catch(u)}).catch(u)})}class Zo extends Mn{constructor(e){super(),this.connector=e}send(...e){this.connector.send(...e)}}var St={PARSE_ERROR:-32700,INVALID_REQUEST:-32600,METHOD_NOT_FOUND:-32601,INVALID_PARAMS:-32602,REMOTE_INTERNAL_ERROR:-32603,TIMEOUT:-32701};class Ds{constructor({transports:e}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transportsToRegister=e,this.methods={}}setMethodPrefix(e){this.methodPrefix=e}expose(e){this.methods=e}registerTransport(e){e.onData(this._processRequest.bind(this,e))}async _processRequest(e,n){const i=JSON.parse(n);let r;return Array.isArray(i)?r=await Promise.all(i.map(s=>this._callMethod(s,e))):r=await this._callMethod(i,e),JSON.stringify(r)}async _callMethod(e,n){if(!e.hasOwnProperty("method"))return;const{method:r,params:s=[],id:f}=e;let o=r;if(o.includes("::")){const[u,_]=o.split("::");if(o=_,this.methodPrefix&&u!=this.methodPrefix)return}const c=!this.methods[o]||typeof this.methods[o]!="function"||o==="constructor"||o.startsWith("_")||this.methods[o]===Object.prototype[o];let a={};if(c)a={jsonrpc:"2.0",id:f,error:{code:St.METHOD_NOT_FOUND,message:`Method [${o}] not found on remote target object`}};else{this.currentTransport=n;try{const u=await this.methods[o].apply(this.methods,s);if(!f)return;a={jsonrpc:"2.0",result:typeof u>"u"?null:u,id:f}}catch(u){console.log(`Exposed RPC method ${r} internal error:`),console.log(u),console.log("Sending this error as a result to calling client ..."),a={jsonrpc:"2.0",error:{code:St.REMOTE_INTERNAL_ERROR,message:`Method [${r}] internal error: ${u.stack}`},id:f}}}return a}run(){for(const e of this.transportsToRegister)this.registerTransport(e);this.transportsToRegister=[]}}class Ht extends Error{constructor(e={}){if(super(),!e.code)throw new Error("Code required");if(!e.message)throw new Error("Message required");this.code=e.code,this.message=e.message}}class Go extends Ht{constructor(e){super({code:St.METHOD_NOT_FOUND,message:e||"Method not found"})}}class Vo extends Ht{constructor(){super({code:St.INVALID_PARAMS,message:"Invalid params"})}}class Qo extends Ht{constructor(e){super({code:St.REMOTE_INTERNAL_ERROR,message:`Error originating at remote endpoint: ${e}`||"Remote Internal error"})}}class Xo extends Ht{constructor(){super({code:St.PARSE_ERROR,message:"Parse error"})}}class ec extends Ht{constructor(){super({code:St.INVALID_REQUEST,message:"Invalid request"})}}class Os extends Ht{}class tc extends Os{constructor(e,n){super({code:St.TIMEOUT,message:`Request exceeded maximum execution time (${n}ms): ${e}`})}}var ei={Base:Ht,MethodNotFound:Go,InvalidRequest:ec,InvalidParams:Vo,RemoteInternalError:Qo,ServerError:Os,ParseError:Xo,RequestTimeout:tc};class Ns{constructor({transport:e,requestTimeout:n=2e4}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transport=e,this.requestTimeout=n,this.pendingRequest={},this.initialized=!1}setMethodPrefix(e){this.methodPrefix=e}async callMethod(e,n){this._init();const i=this.methodPrefix?`${this.methodPrefix}::${e}`:e,r=this._makeRequestObject({method:i,params:n});return this._sendRequest({object:r,id:r.id})}notify(e,n){this._init();const i=this._makeRequestObject({method:e,params:n,mode:"notify"});return this.transport.sendData(JSON.stringify(i)),!0}async runBatch(e){const n=this._generateId();let i=!0;const r=[];for(const[s,f,o]of e){const c=this._makeRequestObject({method:s,params:f,mode:o,batchId:n});c.id&&(i=!1),r.push(c)}return i?this.transport.sendData(JSON.stringify(r)):this._sendRequest({object:r,id:n})}_init(){this.initialized||(this.transport.onData(this._processResponse.bind(this)),this.initialized=!0)}_sendRequest({object:e,id:n}){const i=JSON.stringify(e);return new Promise((r,s)=>{this.pendingRequest[n]={resolve:r,reject:s,sentObject:e},setTimeout(()=>{this.pendingRequest[n]&&(delete this.pendingRequest[n],s(new ei.RequestTimeout(i,this.requestTimeout)))},this.requestTimeout);try{this.transport.sendData(i)}catch(f){delete this.pendingRequest[n],s(f)}})}_processResponse(e){const n=JSON.parse(e);Array.isArray(n)?this._processBatchResponse(n):this._processSingleCallResponse(n)}_processSingleCallResponse(e){const n=e.hasOwnProperty("result")||!1,i=e.hasOwnProperty("error");if(!n&&!i)return;const r=this.pendingRequest[e.id];if(delete this.pendingRequest[e.id],!!r){if(n)r.resolve(e.result);else if(i){const s=this._makeErrorObject(e.error);r.reject(s)}}}_processBatchResponse(e){let n;const i={},r=[];for(const a of e)a.id?(n||(n=a.id.split("|")[0]),i[a.id]=a):a.error&&r.push(a.error);if(!this.pendingRequest[n])return;const{sentObject:s,resolve:f}=this.pendingRequest[n];delete this.pendingRequest[n];const o=[];let c=0;for(const a of s){if(!a.id){o.push(null);continue}const u=i[a.id];u?u.hasOwnProperty("result")||!1?o.push({success:!0,result:u.result}):o.push({success:!1,result:this._makeErrorObject(u.error)}):(o.push({success:!1,error:this._makeErrorObject(r[c])}),c++)}f(o)}_makeRequestObject({method:e,params:n,mode:i,batchId:r}){const s={jsonrpc:"2.0",method:e};return n&&n.length&&(s.params=n),i!=="notify"&&(s.id=r?`${r}|${this._generateId()}`:this._generateId()),s}_makeErrorObject(e){const n={[St.METHOD_NOT_FOUND]:()=>new ei.MethodNotFound(e.message),[St.REMOTE_INTERNAL_ERROR]:()=>new ei.RemoteInternalError(e.message)}[e.code];return n()}_generateId(){const e="bjectSymhasOwnProp-0123456789ABCDEFGHIJKLMNQRTUVWXYZ_dfgiklquvxz";let n=10,i="";for(;0<n--;)i+=e[Math.random()*64|0];return i}}function nc(t){const e=Fr(t.callMethod.bind(t)),n=Fr(t.notify.bind(t));return new Proxy(t,{get(i,r){if(r==="notify")return n;if(r==="callMethod")return e;if(r!=="then")return r==="setMethodPrefix"?(...s)=>t.setMethodPrefix(s):(...s)=>i.callMethod.call(i,r,s)}})}function Fr(t){return new Proxy(t,{get(e,n){return(...i)=>e.call(null,n,i)},apply(e,n,i){return e.apply(null,i)}})}class ic extends Ns{constructor(...e){return super(...e),nc(this)}}class rc{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",e)}sendData(e){this.channel.send(e)}}class xs{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",async n=>{const i=await e(n);!i||this.channel.send(i)})}}var sc=Object.freeze({__proto__:null,MoleServer:Ds,MoleClient:Ns,MoleClientProxified:ic,ClientTransport:rc,ServerTransport:xs});class fc extends Error{constructor(e,n){super(e),this.name=this.constructor.name,this.errorCode=n}errorCode(){return this.errorCode}}const{MoleClient:lc,ClientTransport:oc}=sc;class cc{constructor(e,n,i){this.moleChannel=new Zo(e),this.methodPrefix=n,this.connectorOrServersideChannel=e,this.client=new lc({requestTimeout:i,transport:new oc(this.moleChannel)})}jsonrpcMsgReceive(e){this.moleChannel.emit("json_rpc",e)}call(e,n){return this.connectorOrServersideChannel.closed()?new Promise((i,r)=>{r(new fc(`Method call [${this.methodPrefix}::${e}] on closed channel or connector ignored. Please add a check for closed channel in your code.`,"CLOSED_CHANNEL"))}):this.client.callMethod(`${this.methodPrefix}::${e}`,n)}}const ac=1e4;class uc{constructor(e,n){this.connectorOrServersideChannel=e,this.remoteObjects={},this.requestTimeout=n||ac}remoteObject(e){return this.remoteObjects[e]||(this.remoteObjects[e]=new cc(this.connectorOrServersideChannel,e,this.requestTimeout)),this.remoteObjects[e]}jsonrpcMsgReceive(e){for(const n of Object.values(this.remoteObjects))n.jsonrpcMsgReceive(e)}}class dc{constructor({serversideChannel:e,serverMethods:n,methodPrefix:i}){const r=[new xs(e)];this.server=new Ds({transports:r}),this.server.expose(n),this.server.setMethodPrefix(i),this.server.run()}}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var _c=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},t(e,n)};return function(e,n){t(e,n);function i(){this.constructor=e}e.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),hc=Object.prototype.hasOwnProperty;function si(t,e){return hc.call(t,e)}function fi(t){if(Array.isArray(t)){for(var n=new Array(t.length),e=0;e<n.length;e++)n[e]=""+e;return n}if(Object.keys)return Object.keys(t);var n=[];for(var i in t)si(t,i)&&n.push(i);return n}function yt(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function li(t){for(var e=0,n=t.length,i;e<n;){if(i=t.charCodeAt(e),i>=48&&i<=57){e++;continue}return!1}return!0}function zt(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function Rs(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function oi(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(oi(t[e]))return!0}else if(typeof t=="object"){for(var i=fi(t),r=i.length,e=0;e<r;e++)if(oi(t[i[e]]))return!0}}return!1}function Yr(t,e){var n=[t];for(var i in e){var r=typeof e[i]=="object"?JSON.stringify(e[i],null,2):e[i];typeof r<"u"&&n.push(i+": "+r)}return n.join(`
`)}var Is=function(t){_c(e,t);function e(n,i,r,s,f){var o=this.constructor,c=t.call(this,Yr(n,{name:i,index:r,operation:s,tree:f}))||this;return c.name=i,c.index=r,c.operation=s,c.tree=f,Object.setPrototypeOf(c,o.prototype),c.message=Yr(n,{name:i,index:r,operation:s,tree:f}),c}return e}(Error),et=Is,bc=yt,Qt={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var i=t[e];return delete t[e],{newDocument:n,removed:i}},replace:function(t,e,n){var i=t[e];return t[e]=this.value,{newDocument:n,removed:i}},move:function(t,e,n){var i=In(n,this.path);i&&(i=yt(i));var r=Ft(n,{op:"remove",path:this.from}).removed;return Ft(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(t,e,n){var i=In(n,this.from);return Ft(n,{op:"add",path:this.path,value:yt(i)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:dn(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},mc={add:function(t,e,n){return li(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var i=t.splice(e,1);return{newDocument:n,removed:i[0]}},replace:function(t,e,n){var i=t[e];return t[e]=this.value,{newDocument:n,removed:i}},move:Qt.move,copy:Qt.copy,test:Qt.test,_get:Qt._get};function In(t,e){if(e=="")return t;var n={op:"_get",path:e};return Ft(t,n),n.value}function Ft(t,e,n,i,r,s){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(e,0,t,e.path):Pn(e,0)),e.path===""){var f={newDocument:t};if(e.op==="add")return f.newDocument=e.value,f;if(e.op==="replace")return f.newDocument=e.value,f.removed=t,f;if(e.op==="move"||e.op==="copy")return f.newDocument=In(t,e.from),e.op==="move"&&(f.removed=t),f;if(e.op==="test"){if(f.test=dn(t,e.value),f.test===!1)throw new et("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return f.newDocument=t,f}else{if(e.op==="remove")return f.removed=t,f.newDocument=null,f;if(e.op==="_get")return e.value=t,f;if(n)throw new et("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,t);return f}}else{i||(t=yt(t));var o=e.path||"",c=o.split("/"),a=t,u=1,_=c.length,b=void 0,p=void 0,k=void 0;for(typeof n=="function"?k=n:k=Pn;;){if(p=c[u],r&&p=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&b===void 0&&(a[p]===void 0?b=c.slice(0,u).join("/"):u==_-1&&(b=e.path),b!==void 0&&k(e,0,t,b)),u++,Array.isArray(a)){if(p==="-")p=a.length;else{if(n&&!li(p))throw new et("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,t);li(p)&&(p=~~p)}if(u>=_){if(n&&e.op==="add"&&p>a.length)throw new et("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,t);var f=mc[e.op].call(e,a,p,t);if(f.test===!1)throw new et("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return f}}else if(p&&p.indexOf("~")!=-1&&(p=Rs(p)),u>=_){var f=Qt[e.op].call(e,a,p,t);if(f.test===!1)throw new et("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return f}a=a[p]}}}function _i(t,e,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(e))throw new et("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(t=yt(t));for(var s=new Array(e.length),f=0,o=e.length;f<o;f++)s[f]=Ft(t,e[f],n,!0,r,f),t=s[f].newDocument;return s.newDocument=t,s}function pc(t,e,n){var i=Ft(t,e);if(i.test===!1)throw new et("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return i.newDocument}function Pn(t,e,n,i){if(typeof t!="object"||t===null||Array.isArray(t))throw new et("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(Qt[t.op]){if(typeof t.path!="string")throw new et("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new et('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new et("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new et("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&oi(t.value))throw new et("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var r=t.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new et("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==i)throw new et("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var f={op:"_get",path:t.from,value:void 0},o=Ps([f],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new et("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new et("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function Ps(t,e,n){try{if(!Array.isArray(t))throw new et("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)_i(yt(e),yt(t),n||!0);else{n=n||Pn;for(var i=0;i<t.length;i++)n(t[i],i,e,void 0)}}catch(r){if(r instanceof et)return r;throw r}}function dn(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),i=Array.isArray(e),r,s,f;if(n&&i){if(s=t.length,s!=e.length)return!1;for(r=s;r--!==0;)if(!dn(t[r],e[r]))return!1;return!0}if(n!=i)return!1;var o=Object.keys(t);if(s=o.length,s!==Object.keys(e).length)return!1;for(r=s;r--!==0;)if(!e.hasOwnProperty(o[r]))return!1;for(r=s;r--!==0;)if(f=o[r],!dn(t[f],e[f]))return!1;return!0}return t!==t&&e!==e}var vc=Object.freeze({__proto__:null,JsonPatchError:et,deepClone:bc,getValueByPointer:In,applyOperation:Ft,applyPatch:_i,applyReducer:pc,validator:Pn,validate:Ps,_areEquals:dn});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var hi=new WeakMap,yc=function(){function t(e){this.observers=new Map,this.obj=e}return t}(),gc=function(){function t(e,n){this.callback=e,this.observer=n}return t}();function wc(t){return hi.get(t)}function kc(t,e){return t.observers.get(e)}function Ac(t,e){t.observers.delete(e.callback)}function Sc(t,e){e.unobserve()}function Ec(t,e){var n=[],i,r=wc(t);if(!r)r=new yc(t),hi.set(t,r);else{var s=kc(r,e);i=s&&s.observer}if(i)return i;if(i={},r.value=yt(t),e){i.callback=e,i.next=null;var f=function(){ci(i)},o=function(){clearTimeout(i.next),i.next=setTimeout(f)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return i.patches=n,i.object=t,i.unobserve=function(){ci(i),clearTimeout(i.next),Ac(r,i),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(e,new gc(e,i)),i}function ci(t,e){e===void 0&&(e=!1);var n=hi.get(t.object);bi(n.value,t.object,t.patches,"",e),t.patches.length&&_i(n.value,t.patches);var i=t.patches;return i.length>0&&(t.patches=[],t.callback&&t.callback(i)),i}function bi(t,e,n,i,r){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=fi(e),f=fi(t),o=!1,c=f.length-1;c>=0;c--){var a=f[c],u=t[a];if(si(e,a)&&!(e[a]===void 0&&u!==void 0&&Array.isArray(e)===!1)){var _=e[a];typeof u=="object"&&u!=null&&typeof _=="object"&&_!=null?bi(u,_,n,i+"/"+zt(a),r):u!==_&&(r&&n.push({op:"test",path:i+"/"+zt(a),value:yt(u)}),n.push({op:"replace",path:i+"/"+zt(a),value:yt(_)}))}else Array.isArray(t)===Array.isArray(e)?(r&&n.push({op:"test",path:i+"/"+zt(a),value:yt(u)}),n.push({op:"remove",path:i+"/"+zt(a)}),o=!0):(r&&n.push({op:"test",path:i,value:t}),n.push({op:"replace",path:i,value:e}))}if(!(!o&&s.length==f.length))for(var c=0;c<s.length;c++){var a=s[c];!si(t,a)&&e[a]!==void 0&&n.push({op:"add",path:i+"/"+zt(a),value:yt(e[a])})}}}function Tc(t,e,n){n===void 0&&(n=!1);var i=[];return bi(t,e,i,"",n),i}var Cc=Object.freeze({__proto__:null,unobserve:Sc,observe:Ec,generate:ci,compare:Tc}),Dc=Object.assign({},vc,Cc,{JsonPatchError:Is,deepClone:yt,escapePathComponent:zt,unescapePathComponent:Rs});const{applyPatch:Oc}=Dc;class Nc extends en{constructor(e){super({}),this.connector=e,this.connector.on("receive_state",n=>{this.wireStateReceived=!0,this.set(n)}),this.connector.on("receive_diff",n=>{this.wireStateReceived&&(Oc(this.state,n),this.announceStateChange())})}field(e){return this.connector.connectionState.get(e)}}class xc extends en{constructor(e){super({}),this.fields={},this.connector=e,this.connector.on("receive_state_field",({name:n,state:i})=>{this.get(n).set(i)})}get(e){return this.fields[e]||(this.fields[e]=new en),this.fields[e]}}At.util=tn;const Rc=700,Ic=6e4,Pc=1;class Mc extends Mn{constructor({endpoint:e,protocol:n,keypair:i=ws(),rpcRequestTimeout:r,verbose:s=!1,tag:f,log:o=console.log,autoDecommission:c=!1,dummy:a}={}){super(),this.protocol=n,this.log=o;const{privateKey:u,publicKey:_}=ks(i);this.clientPrivateKey=u,this.clientPublicKey=_,this.clientPublicKeyHex=xn(_),this.rpcClient=new uc(this,r),this.endpoint=e,this.verbose=s,this.tag=f,this.autoDecommission=c,this.sentCount=0,this.receivedCount=0,this.successfulConnectsCount=0,a||(this.state=new Nc(this),this.connectionState=new xc(this)),this.connected=new en,this.delayedAdjustConnectionStatus(),s&&$e.green(this.log,`Connector ${this.endpoint} created`),this.decommissionCheckCounter=0,this.lastPongReceivedAt=Date.now(),this.on("pong",()=>{this.lastPongReceivedAt=Date.now()})}delayedAdjustConnectionStatus(){setTimeout(()=>{this.connected.get()==null&&this.connected.set(!1)},Rc)}send(e){Ho({data:e,connector:this}),this.sentCount+=1}signal(e,n){this.connected.get()?this.send({signal:e,data:n}):$e.write(this.log,"Warning: trying to send signal over disconnected connector, this should be prevented by GUI")}on(e,n){e=="ready"&&this.isReady()&&n(),super.on(e,n)}getSharedSecret(){return this.sharedSecret?xn(this.sharedSecret):void 0}wireReceive({jsonData:e,encryptedData:n,rawMessage:i}){Cs({jsonData:e,encryptedData:n,rawMessage:i,connector:this}),this.receivedCount+=1}field(e){return this.connectionState.get(e)}isReady(){return this.ready}closed(){return!this.transportConnected}connectStatus(e){if(e){this.sentCount=0,this.receivedCount=0,this.transportConnected=!0,this.successfulConnectsCount+=1,this.verbose&&$e.green(this.log,`\u2713 Connector ${this.endpoint} connected #${this.successfulConnectsCount}`);const n=this.connection.websocket.__id;Jo({connector:this,afterFirstStep:({sharedSecret:r,remotePubkeyHex:s})=>{this.sharedSecret=r,this._remotePubkeyHex=s}}).then(()=>{this.connectedAt=Date.now(),this.connected.set(!0),this.ready=!0,this.emit("ready")}).catch(r=>{this.connection.websocket.__id==n&&this.connection.websocket.readyState==Pc&&r.code==St.TIMEOUT&&($e.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] handshake error: "${r.message}"`),$e.write(this.log,`${this.endpoint} Connector dropping stale websocket after handshake error`),this.connection.terminate()),r.code!=St.TIMEOUT&&$e.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] on:ready error: "${r.stack}" \u2014 (will not try to reconnect, fix the error and reload this gui)`)})}else{let n;this.transportConnected&&(n=!0),this.transportConnected==null&&$e.write(this.log,`${this.endpoint} Connector was not able to connect at first try`),this.transportConnected=!1,this.ready=!1,this.sharedSecret=void 0,delete this.connectedAt,n&&(this.emit("disconnect"),e==null&&this.delayedAdjustConnectionStatus(),this.connected.set(e))}}checkForDecommission(){!this.autoDecommission||(this.decommissionCheckRequestedAt&&Date.now()-this.decommissionCheckRequestedAt>3e3&&(this.decommissionCheckCounter=0),this.decommissionCheckRequestedAt=Date.now(),this.decommissionCheckCounter+=1,this.decommissionCheckCounter>12&&Date.now()-this.lastPongReceivedAt>Ic&&($e.write(this.log,`Decommissioning connector ${this.endpoint} (long inactive)`),this.decommission(),this.emit("decommission")))}decommission(){this.decommissioned=!0}remoteObject(e){return{call:(n,i=[])=>this.rpcClient.remoteObject(e).call(n,Io(i))}}attachObject(e,n){new dc({serversideChannel:this,serverMethods:n,methodPrefix:e})}clientPubkey(){return this.clientPublicKeyHex}remotePubkeyHex(){return this._remotePubkeyHex}remoteAddress(){return this.endpoint}}const Hr=typeof window<"u";function Lc({endpoint:t,host:e,port:n}){if(Hr&&t&&t.startsWith("/")&&(t=`${window.location.protocol.includes("s")?"wss":"ws"}://${window.location.host}${t}`),!t)if(Hr){e=e||window.location.hostname;const i=window.location.protocol.includes("s")?"wss":"ws";t=`${i}://${e}`,i=="wss"?t=`${i}://${e}/ws`:n?t=`${t}:${n}`:window.location.port&&(t=`${t}:${window.location.port}`)}else{if(!n)throw new Error(`Connectome determineEndpoint: No websocket port provided for ${e}`);t=`ws://${e||"localhost"}:${n}`}return t}const Rt=typeof window<"u",Uc=0,jc=1,$c=1e3,Kc=3,Bc=5;function zc({endpoint:t,host:e,port:n,protocol:i,keypair:r,remotePubkey:s,rpcRequestTimeout:f,autoDecommission:o,log:c,verbose:a,tag:u,dummy:_},{WebSocket:b}){t=Lc({endpoint:t,host:e,port:n});const p=new Mc({endpoint:t,protocol:i,rpcRequestTimeout:f,keypair:r,verbose:a,tag:u,log:c,autoDecommission:o,dummy:_}),k=()=>{Fc({connector:p,endpoint:t},{WebSocket:b,reconnect:k,log:c,verbose:a})};p.connection={terminate(){this.websocket._removeAllCallbacks(),this.websocket.close(),p.connectStatus(!1),k()},endpoint:t,checkTicker:0};const y=()=>{p.decommissioned||(qc({connector:p,reconnect:k,log:c}),setTimeout(y,$c))};return setTimeout(y,10),p}function qc({connector:t,reconnect:e,log:n}){const i=t.connection;if(Hc(i)||t.decommissioned){t.decommissioned?($e.yellow(n,`${t.endpoint} Connection decommisioned, closing websocket ${i.websocket.__id}, will not retry again `),Ms(t)):(t.emit("inactive_connection"),$e.yellow(n,`${t.endpoint} \u2716 Terminated inactive connection`)),i.terminate();return}Ls(i)?i.websocket.send("ping"):(t.connected==null&&($e.write(n,`${t.endpoint} Setting connector status to FALSE because connector.connected is undefined`),t.connectStatus(!1)),e()),i.checkTicker+=1}function Fc({connector:t,endpoint:e},{WebSocket:n,reconnect:i,log:r,verbose:s}){const f=t.connection;if(t.checkForDecommission(),t.decommissioned){Ms(t);return}if(f.currentlyTryingWS&&f.currentlyTryingWS.readyState==Uc){if(f.currentlyTryingWS._waitForConnectCounter<Bc){f.currentlyTryingWS._waitForConnectCounter+=1;return}(s||Rt)&&$e.write(r,`${e} Reconnect timeout, creating new ws`),f.currentlyTryingWS._removeAllCallbacks(),f.currentlyTryingWS.close()}else(s||Rt)&&$e.write(r,`${e} Created new websocket`);const o=new n(e);o.__id=Math.random(),f.currentlyTryingWS=o,f.currentlyTryingWS._waitForConnectCounter=0,Rt&&(o.binaryType="arraybuffer"),Rt||o.on("error",()=>{});const c=()=>{t.decommissioned||((s||Rt)&&$e.write(r,`${e} Websocket open`),f.currentlyTryingWS=null,f.checkTicker=0,Yc({ws:o,connector:t,openCallback:c,reconnect:i},{log:r,verbose:s}),f.websocket=o,t.connectStatus(!0))};o._removeAllCallbacks=()=>{o.removeEventListener("open",c)},Rt?o.addEventListener("open",c):o.on("open",c)}function Yc({ws:t,connector:e,openCallback:n,reconnect:i},{log:r,verbose:s}){const f=e.connection,o=u=>{const _=`${e.endpoint} Websocket error`;console.log(_),console.log(u)},c=()=>{if($e.write(r,`${e.endpoint} \u2716 Connection closed`),e.decommissioned){e.connectStatus(!1);return}e.connectStatus(void 0),i()},a=u=>{if(e.decommissioned)return;f.checkTicker=0;const _=Rt?u.data:u;if(_=="pong"){e.emit("pong");return}let b;try{b=JSON.parse(_)}catch{}if(b)e.wireReceive({jsonData:b,rawMessage:_});else{const p=Rt?new Uint8Array(_):_;e.wireReceive({encryptedData:p})}};t._removeAllCallbacks=()=>{t.removeEventListener("error",o),t.removeEventListener("close",c),t.removeEventListener("message",a),t.removeEventListener("open",n)},Rt?(t.addEventListener("error",o),t.addEventListener("close",c),t.addEventListener("message",a)):(t.on("error",o),t.on("close",c),t.on("message",a))}function Ms(t){const e=t.connection;e.currentlyTryingWS&&(e.currentlyTryingWS._removeAllCallbacks(),e.currentlyTryingWS.close(),e.currentlyTryingWS=null),e.ws&&(e.ws._removeAllCallbacks(),e.ws.close(),e.ws=null),t.connectStatus(!1)}function Ls(t){return t.websocket&&t.websocket.readyState==jc}function Hc(t){return Ls(t)&&t.checkTicker>Kc}function Wc(t){return t.log=t.log||console.log,zc(t,{WebSocket})}class Jc{constructor({mcs:e,foreground:n,connectToDeviceKey:i}){this.mcs=e,this.foreground=n,this.connectToDeviceKey=i}createConnector({host:e,autoDecommission:n=!1}){const{port:i,protocol:r,rpcRequestTimeout:s,log:f,verbose:o,keypair:c}=this.mcs;return Wc({host:e,port:i,protocol:r,keypair:c,rpcRequestTimeout:s,autoDecommission:n,log:f,verbose:o})}getDeviceKey(e){var n;return(n=e==null?void 0:e.device)==null?void 0:n.deviceKey}connectThisDevice({host:e}){const n=this.createConnector({host:e});let i=!1;return n.state.subscribe(r=>{var f;r.nearbyDevices||(r.nearbyDevices=[]),r.notifications||(r.notifications=[]);const s=this.getDeviceKey(r);if(s){i||(n.on("pong",()=>{this.mcs.emit("pong",{deviceKey:s})}),i=!0),this.thisDeviceAlreadySetup||(this.mcs.set({activeDeviceKey:s}),this.initNewConnector({deviceKey:s,connector:n}));const o=this.connectToDeviceKey&&this.connectToDeviceKey!=s;if(!o&&this.mcs.activeDeviceKey()==s){const c=(f=r.device)==null?void 0:f.deviceName;this.foreground.set(r,{optimisticDeviceName:c})}this.foreground.setSpecial(r),this.thisDeviceAlreadySetup||(o&&(this.mcs.switch({deviceKey:this.connectToDeviceKey}),delete this.connectToDeviceKey),this.thisDeviceAlreadySetup=!0)}}),n}connectOtherDevice({host:e,deviceKey:n}){if(!this.mcs.connectors[n]){const i=this.createConnector({host:e,autoDecommission:!0});i.on("decommission",()=>{delete this.mcs.connectors[n],i.__removeListeners&&i.__removeListeners()});const r=()=>{this.mcs.emit("pong",{deviceKey:n})};i.on("pong",r),this.initNewConnector({deviceKey:n,connector:i});const s=i.state.subscribe(f=>{if(this.mcs.activeDeviceKey()==n){const o=f.device?f.device.deviceName:null;this.foreground.set(f,{optimisticDeviceName:o})}});i.__removeListeners=()=>{i.off("pong",r),s()}}return this.mcs.connectors[n]}initNewConnector({deviceKey:e,connector:n}){this.mcs.connectors[e]=n,this.setConnectedStore({deviceKey:e,connector:n})}setConnectedStore({deviceKey:e,connector:n}){n.connected.subscribe(i=>{this.mcs.activeDeviceKey()==e&&this.mcs.connected.set(i)})}}function Us(t,e=0,n={}){const i=["day","h","min","s"],r=[24,60,60,1e3];if(e==i.length)return n.ms=t,n;e==0&&(n.totalSeconds=t/1e3);const s=r.slice(e).reduce((f,o)=>f*o,1);return n[i[e]]=Math.floor(t/s),Us(t%s,e+1,n)}function Zc(t){const e=["day","h","min","s"];let n="";for(const i of e)t[i]>0&&(i!="s"||i=="s"&&t.totalSeconds<60)&&(n=`${n} ${t[i]} ${i}`);return n.trim()}function js(t){if(t){const e=Date.now(),n=3e3;return t.filter(i=>e<i.expireAt).map(i=>({...i,relativeTimeAdded:e-i.addedAt<n?"now":`${Zc(Us(e-i.addedAt))} ago`}))}return[]}class Gc{constructor({mcs:e,thisDeviceStateKeys:n}){this.mcs=e,this.thisDeviceStateKeys=n}specialStoreKeys(){return this.thisDeviceStateKeys.concat(["activeDeviceKey","optimisticDeviceName"])}clear(){this.mcs.clearState({except:this.specialStoreKeys()})}set(e,{optimisticDeviceName:n=void 0}={}){this.clear();const i={};for(const r of Object.keys(e))this.specialStoreKeys().includes(r)||(i[r]=e[r]);n&&(i.optimisticDeviceName=n),this.mcs.setMerge(i)}setSpecial(e){const n={};for(const i of this.thisDeviceStateKeys)i=="notifications"?n[i]=js(e[i]):n[i]=e[i];this.mcs.setMerge(n)}}class Vc extends Mn{constructor({mcs:e,connectDevice:n,foreground:i}){super(),this.mcs=e,this.connectDevice=n,this.foreground=i}switchState({deviceKey:e,deviceName:n}){this.mcs.setMerge({activeDeviceKey:e});const{state:i,connected:r}=this.mcs.connectors[e];this.foreground.set(i.get(),{optimisticDeviceName:n}),this.mcs.connected.set(r.get())}switch({host:e,deviceKey:n,deviceName:i}){if(this.mcs.connectors[n])this.switchState({deviceKey:n,deviceName:i});else if(e)this.foreground.clear(),this.mcs.setMerge({activeDeviceKey:n,optimisticDeviceName:i}),this.connectDevice.connectOtherDevice({host:e,deviceKey:n});else{const r=this.mcs.localConnector.state.get(),{nearbyDevices:s}=r,f=s.find(o=>o.deviceKey==n&&!o.thisDevice);if(f){const{deviceKey:o,deviceName:c,ip:a}=f;this.switch({host:a,deviceKey:o,deviceName:c})}else this.emit("connect_to_device_key_failed"),this.switchState(r.device)}}}const Qc=500;class Xc extends Co{constructor({host:e,port:n,protocol:i,keypair:r=ws(),connectToDeviceKey:s,rpcRequestTimeout:f=3e3,log:o,verbose:c}){super();const a=["time","environment","nearbyDevices","nearbySensors","notifications"],{publicKey:u,privateKey:_}=ks(r);this.publicKey=u,this.privateKey=_,this.keypair=r,this.port=n,this.protocol=i,this.log=o,this.rpcRequestTimeout=f,this.verbose=c,this.connectors={},this.connected=new en;const b=new Gc({mcs:this,thisDeviceStateKeys:a}),p=new Jc({mcs:this,foreground:b,connectToDeviceKey:s});this.connectDevice=p,this.switchDevice=new Vc({mcs:this,connectDevice:p,foreground:b}),this.switchDevice.on("connect_to_device_key_failed",()=>{this.emit("connect_to_device_key_failed")}),this.localConnector=p.connectThisDevice({host:e}),this._notificationsExpireAndCalculateRelativeTime()}_notificationsExpireAndCalculateRelativeTime(){const{notifications:e}=this.get();this.setMerge({notifications:js(e)}),setTimeout(()=>{this._notificationsExpireAndCalculateRelativeTime()},Qc)}signal(e,n){this.activeConnector()?this.activeConnector().signal(e,n):console.log(`MCS: Error emitting remote signal ${e} / ${n}. Debug info: activeDeviceKey=${this.activeDeviceKey()}`)}signalLocalDevice(e,n){this.localConnector.signal(e,n)}remoteObject(e){if(this.activeConnector())return this.activeConnector().remoteObject(e);console.log(`Error obtaining remote object ${e}. Debug info: activeDeviceKey=${this.activeDeviceKey()}`)}preconnect({host:e,deviceKey:n,thisDevice:i}){return i?this.localConnector:this.connectDevice.connectOtherDevice({host:e,deviceKey:n})}switch({host:e,deviceKey:n,deviceName:i}){this.switchDevice.switch({host:e,deviceKey:n,deviceName:i})}activeConnector(){if(this.activeDeviceKey())return this.connectors[this.activeDeviceKey()]}activeDeviceKey(){return this.get().activeDeviceKey}}const ea=7780,ta="dmt/gui",$s=localStorage.getItem("current_device_key");console.log(`connectToDeviceKey: ${$s}`);const Ks=new Xc({port:ea,protocol:ta,connectToDeviceKey:$s,log:kt.log});Ks.on("connect_to_device_key_failed",()=>{console.log("connect_to_device_key_failed FAILED"),localStorage.removeItem("current_device_key")});window.onerror=_f(us);new ko({target:document.body,props:{store:Ks,log:kt.log}});
